webpackJsonp([13,18],{"5PLg":function(t,e){},"7vBh":function(t,e){},K6bz:function(t,e){},L19k:function(t,e){},PuhB:function(t,e){},SSN6:function(t,e){t.exports={render:function(){var a=this,t=a.$createElement,i=a._self._c||t;return i("div",{staticClass:"wrap"},[a.spinShow?i("Spin",{attrs:{size:"large",fix:""}}):a._e(),a._v(" "),a.cutView&&"apps"===a.caseId?i("div",a._l(a.menu,function(t,e){return i("section",{key:e,staticClass:"bg-white-lighter"},[i("row",{staticClass:"menu-group"},[i("row",[i("h3",{staticClass:"menu-group-title"},[a._v(a._s(t.text))])]),a._v(" "),i("row",{attrs:{gutter:16}},a._l(t.children,function(t,e){return t.leaf?i("Col",{key:e,attrs:{span:"4"}},[i("menu-item",{attrs:{appinfo:t,allTaskCount:a.allTaskCount}})],1):i("menu-list",{attrs:{menuItem:t,index:e,allTaskCount:a.allTaskCount}})}),1)],1)],1)}),0):a._e()],1)},staticRenderFns:[]}},ZsAX:function(t,e){t.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"card "},["subject"!==e.type?a("Poptip",{staticClass:"badge-custom",attrs:{width:"720",placement:"right-end"},on:{"on-popper-show":e.popperShow}},[a("Badge",{attrs:{count:e.taskCount}}),e._v(" "),a("div",{attrs:{slot:"title"},slot:"title"},[a("label",[e._v(e._s(e.appinfo.text+" - 待办任务"))]),e._v(" "),a("Button",{staticStyle:{height:"28px"},attrs:{type:"primary",disabled:0===e.onPageSelection.length},on:{click:e.handleBatchApproval}},[e._v("\n          批量审批\n      ")])],1),e._v(" "),a("div",{staticClass:"api",attrs:{slot:"content"},slot:"content"},[a("Table",{ref:"selection",attrs:{loading:e.loading,columns:e.columns,data:e.columnData,size:"small"},on:{"on-select-all":e.onSelectAll,"on-selection-change":e.handerSelectionChange,"on-select-cancel":e.onSelectCancel}}),e._v(" "),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:e.pageTotal,current:e.currentPage,size:"small","page-size":e.pageSize,"show-total":""},on:{"on-change":e.changeCurrentPage}})],1)])],1)],1):e._e(),e._v(" "),a("div",{staticClass:"badge-custom",on:{click:function(t){e.redirectTo(e.appinfo)}}},["subject"===e.type?a("Badge",{attrs:{count:e.taskCount,type:"primary"}}):e._e()],1),e._v(" "),a("img",{class:"img-radius-"+this.appinfo.type,attrs:{src:e.appinfo.icon,onerror:'this.src="resources/images/icon/img-loading-error.png"'}}),e._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"content-title"},[a("Tooltip",{attrs:{content:e.appinfo.text,placement:"top-start"}},[a("h5",{on:{click:function(t){e.redirectTo(e.appinfo)}}},[e._v(e._s(e.appinfo.text))])]),e._v(" "),"system"!==this.appinfo.type?a("a",{staticClass:"content-title-detail",on:{click:function(t){t.stopPropagation(),e.goAppSetting(e.appinfo)}}},[e._v("详情")]):e._e()],1),e._v(" "),a("div",{staticClass:"content-instance"},[a("span",{staticClass:"content-instance-name"},[e._v(e._s((e.appinfo.administrator,e.appinfo.transName)))]),e._v(" "),a("my-pop-tip",{attrs:{userInfo:e.userInfo,trigger:"click"}},[a("div",{staticClass:"content-instance-admin",attrs:{slot:"userCard"},on:{click:e.showUserInfo},slot:"userCard"},[e._v(e._s(e.appinfo.administrator))])]),e._v(" "),a("Tooltip",{staticStyle:{"margin-left":"7px",float:"right"},attrs:{content:"创建实例",transfer:!0}},["obj"!==this.appinfo.type&&"business"!==this.appinfo.type||!this.appinfo.action.add?e._e():a("i",{staticClass:"iconfont content-instance-add",on:{click:e.handlerAddInstance}},[e._v("\n          \n        ")])])],1)])],1)},staticRenderFns:[]}},"g+9v":function(t,e){t.exports={render:function(){var a=this,t=a.$createElement,i=a._self._c||t;return i("row",{staticClass:"menu-field-set",attrs:{gutter:16}},[i("label",[a._v(a._s(a.menuItem.text))]),a._v(" "),a._l(a.menuItem.children,function(t,e){return i("Col",{key:e,attrs:{span:"4"}},[i("menu-item",{attrs:{appinfo:t,allTaskCount:a.allTaskCount}})],1)})],2)},staticRenderFns:[]}},gAfU:function(t,e){t.exports={render:function(){var t=this;t.$createElement;t._self._c;return t._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"graph-box"},[e("div",{staticClass:"graph",attrs:{id:"circularGraph"}})])}]}},"lSc+":function(t,e){t.exports={render:function(){var i=this,t=i.$createElement,n=i._self._c||t;return n("div",{staticClass:"flow_container right_container"},[i.spinShow?n("Spin",{attrs:{size:"large",fix:""}}):i._e(),i._v(" "),n("div",{attrs:{id:"flow-box"}},[n("RadioGroup",{staticClass:"taskbtn",attrs:{size:"large"},on:{"on-change":i.radioGroupChange},model:{value:i.radioGroupLabel,callback:function(t){i.radioGroupLabel=t},expression:"radioGroupLabel"}},[n("Radio",{attrs:{label:"mytask"}},[n("span",[i._v("我的任务")])]),i._v(" "),n("Radio",{attrs:{label:"teamtask"}},[n("span",[i._v("团队任务")])]),i._v(" "),n("i",{staticClass:"vertical-divide"})],1),i._v(" "),n("RadioGroup",{staticClass:"taskbtn_1",attrs:{size:"large"},on:{"on-change":i.radioGroupChangeDoneOrTodo},model:{value:i.rodioGroupDoOrNot,callback:function(t){i.rodioGroupDoOrNot=t},expression:"rodioGroupDoOrNot"}},[n("Radio",{attrs:{label:"todo"}},[n("span",[i._v("未完成")])]),i._v(" "),n("Radio",{attrs:{label:"done"}},[n("span",[i._v("已完成")])]),i._v(" "),n("i",{staticClass:"vertical-divide"}),i._v(" "),n("Icon",{staticStyle:{cursor:"pointer"},attrs:{type:"md-refresh",size:"20"},on:{click:function(t){i.refreshData()}}})],1),i._v(" "),n("div",{staticClass:"app-dropdown-select"},[n("Poptip",{attrs:{title:"项目立项",width:"660",content:"content"},model:{value:i.projectPopTipVisible,callback:function(t){i.projectPopTipVisible=t},expression:"projectPopTipVisible"}},[n("span",{staticClass:"app-dropdown-select-item",on:{click:i.getProjectList}},[n("Tag",{attrs:{closable:"",color:"primary"},on:{"on-close":i.onHandleClearProjectTag}},[i._v(i._s(i.projectName?i.projectName:"项目立项"))]),i._v(" "),n("Icon",{attrs:{type:"ios-arrow-down"}})],1),i._v(" "),n("div",{staticClass:"api",attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"app-search"},[n("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入项目名称",icon:"ios-close-circle"},on:{"on-enter":i.onHandleFilterByProjectName,"on-click":i.getProjectList},model:{value:i.projectSearchValue,callback:function(t){i.projectSearchValue=t},expression:"projectSearchValue"}}),i._v(" "),n("Button",{attrs:{type:"primary",size:"small"},on:{click:i.onHandleFilterByProjectName}},[i._v("查询")])],1),i._v(" "),n("Table",{attrs:{columns:i.projectColumns,data:i.projectColumnData,loading:i.projectLoading,size:"small"},on:{"on-row-dblclick":i.handleDbSelectProject}}),i._v(" "),n("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[n("div",{staticStyle:{float:"right"}},[n("Page",{attrs:{total:i.projectPageTotal,current:i.projectCurrentPage,size:"small","page-size":i.projectPageSize,"show-total":"","show-elevator":""},on:{"on-change":i.projectPageChange}})],1)])],1)]),i._v(" "),n("Poptip",{attrs:{title:"销售订单",content:"content",width:"560"},model:{value:i.visible,callback:function(t){i.visible=t},expression:"visible"}},[n("span",{staticClass:"app-dropdown-select-item",staticStyle:{"margin-left":"10px"},on:{click:i.getSaleOrderList}},[n("Tag",{attrs:{closable:"",color:"primary"},on:{"on-close":i.onHandleClearOrderTag}},[i._v(i._s(i.orderCode?i.orderCode:"销售订单"))]),i._v(" "),n("Icon",{attrs:{type:"ios-arrow-down"}})],1),i._v(" "),n("div",{staticClass:"api",attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"app-search"},[n("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入交易号",icon:"ios-close-circle"},on:{"on-enter":i.onHandleFilterByCode,"on-click":i.getSaleOrderList},model:{value:i.searchValue,callback:function(t){i.searchValue=t},expression:"searchValue"}}),i._v(" "),n("Button",{attrs:{type:"primary",size:"small"},on:{click:i.onHandleFilterByCode}},[i._v("查询")])],1),i._v(" "),n("Table",{attrs:{columns:i.columns,data:i.columnData,loading:i.ordersLoading,size:"small"},on:{"on-row-dblclick":i.handleDblclick}}),i._v(" "),n("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[n("div",{staticStyle:{float:"right"}},[n("Page",{attrs:{total:i.pageTotal,current:i.currentPage,size:"small","page-size":i.ordersPageSize,"show-total":"","show-elevator":""},on:{"on-change":i.orderPageChange}})],1)])],1)])],1),i._v(" "),n("div",{staticClass:"divide"}),i._v(" "),n("div",{staticClass:"business_item",staticStyle:{width:"50px"}},i._l(i.dataItem,function(t,e){return n("div",{key:e,staticClass:"left-name"},[n("span")])}),0),i._v(" "),n("div",{staticClass:"svg_box",on:{click:i.outBlur}},[n("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",version:"1.1"}},[n("defs",[n("filter",{attrs:{id:"f1",x:"0",y:"0",width:"200%",height:"200%"}},[n("feOffset",{attrs:{result:"offOut",in:"SourceGraphic",dx:"0",dy:"0"}}),i._v(" "),n("feColorMatrix",{attrs:{result:"matrixOut",in:"offOut",type:"matrix",values:"0.2 0 0 0 0 0 0.2 0 0 0 0 0 0.2 0 0 0 0 0 1 0"}}),i._v(" "),n("feGaussianBlur",{attrs:{result:"blurOut",in:"matrixOut",stdDeviation:"5"}}),i._v(" "),n("feBlend",{attrs:{in:"SourceGraphic",in2:"blurOut",mode:"normal"}})],1)]),i._v(" "),n("defs",[n("marker",{attrs:{id:"arrow",markerUnits:"userSpaceOnUse",markerWidth:"15",markerHeight:"15",viewBox:"0 0 15 15",refX:"6",refY:"6",orient:"auto"}},[n("path",{staticStyle:{fill:"gray"},attrs:{d:"M2,0 L10,6 L2,12 L6,6 L2,0"}})])]),i._v(" "),n("defs",[n("marker",{attrs:{id:"arrow1",markerUnits:"userSpaceOnUse",markerWidth:"15",markerHeight:"15",viewBox:"0 0 15 15",refX:"6",refY:"6",orient:"auto"}},[n("path",{staticStyle:{fill:"#fff",opacity:"0"},attrs:{d:"M2,0 L10,6 L2,12 L6,6 L2,0"}})])]),i._v(" "),n("defs",[n("marker",{attrs:{id:"arrow_hight_color",markerUnits:"userSpaceOnUse",markerWidth:"15",markerHeight:"15",viewBox:"0 0 15 15",refX:"6",refY:"6",orient:"auto"}},[n("path",{staticStyle:{fill:"red"},attrs:{d:"M2,0 L10,6 L2,12 L6,6 L2,0"}})])]),i._v(" "),n("defs",[n("linearGradient",{attrs:{id:"orange_red",x1:"0%",y1:"0%",x2:"0%",y2:"100%"}},[n("stop",{staticStyle:{"stop-color":"#ffdfd9","stop-opacity":"1"},attrs:{offset:"0%"}}),i._v(" "),n("stop",{staticStyle:{"stop-color":"#ff8069 stop-opacity:1"},attrs:{offset:"100%"}})],1)],1),i._v(" "),i._l(i.dataItem,function(t,a){return n("g",{key:a},i._l(t.child,function(e,t){return n("g",{key:t},[n("image",{staticClass:"svg-image-style",attrs:{x:40+(i.baseLength+i.graphSpace)*e.sort,y:50+170*a,width:i.baseLength,height:i.baseLength,"xlink:href":e.icon,rx:"10"},on:{mouseenter:function(t){i.doAction(e)}}}),i._v(" "),n("a",{staticClass:"svg-title-style",on:{click:function(t){i.redirectTo(e)}}},[n("text",{attrs:{x:40+i.baseLength/2+(i.baseLength+i.graphSpace)*e.sort,y:65+i.baseLength+170*a}},[i._v("\n                "+i._s(e.value)+"\n              ")])]),i._v(" "),(e.listId?e.listId:e.id)in i.defaultDisplayTask?n("circle",{attrs:{cx:40+(i.baseLength+i.graphSpace)*e.sort,cy:50+170*a,r:"12","stroke-width":"1",fill:"list"===e.type?"red":"#2d8cf0"}}):i._e(),i._v(" "),n("text",{staticClass:"svg-text-common-style",staticStyle:{"font-size":"12px"},attrs:{x:40+(i.baseLength+i.graphSpace)*e.sort,y:45+170*a,fill:"#fff",listId:"subject"===e.type?e.id:e.listId,taskValue:e.value},on:{click:function(t){i.opentask(e)}}},[i._v("\n              "+i._s("subject"===e.type?i.defaultDisplayTask[e.id]:i.defaultDisplayTask[e.listId])+"\n            ")])])}),0)}),i._v(" "),i._l(i.pointList,function(t){return n("g",{key:t.id},[n("polyline",{class:void 0!==i.waterFlow[t.id]?"path":"",staticStyle:{fill:"none",stroke:"transparent","stroke-width":"1"},attrs:{points:t.value,"marker-end":void 0!==i.waterFlow[t.id]?"url(#arrow_hight_color)":"url(#arrow1)"}})])}),i._v(" "),i._l(i.transTypePointList,function(t){return n("g",{key:t.id},[n("polyline",{staticClass:"transTypeRel_style",attrs:{points:t.value,"marker-end":"url(#arrow)"}})])})],2)])],1),i._v(" "),n("Modal",{attrs:{scrollable:"",width:"80%","class-name":"subReportModel-modal",styles:{top:"20px",pandding:"0px"},title:i.subReportModelTitle},on:{"on-ok":i.refreshData},model:{value:i.subReportModel,callback:function(t){i.subReportModel=t},expression:"subReportModel"}},[n("iframe",{staticStyle:{height:"450px",border:"none"},attrs:{width:"100%",src:i.subReportUrl}})]),i._v(" "),n("task-modal",{attrs:{modal:i.modal,listId:i.pageListId,taskValue:i.taskValue,type:i.type,orderCode:i.orderCode,projectName:i.projectName},on:{emitModal:i.emitModal}})],1)},staticRenderFns:[]}},ll1Z:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("mvHQ"),o=a.n(i),n=a("woOf"),s=a.n(n),r=a("ifoU"),l=a.n(r),c=a("5LsM"),d=a("K4CD"),u=a("oAV5"),p={name:"TaskModal",data:function(){return{columns:[{title:"交易号",key:"transCode",sortable:"custom",width:160,render:function(t,e){return t("a",{attrs:{href:"/Form/index.html?data="+e.row.transCode,target:"_blank"}},e.row.transCode)}},{title:"当前节点",key:"nodeName"},{title:"当前用户",key:"assigneeName",width:90},{title:"创建者",key:"creatorName",width:90},{title:"创建时间",key:"crtTime",sortable:"custom",width:160,render:function(t,e){return t("span",function(t){var e=new Date(t),a=e.getFullYear(),i=e.getMonth()+1;i=i<10?"0"+i:i;var n=e.getDate();n=n<10?"0"+n:n;var o=e.getHours();o=o<10?"0"+o:o;var s=e.getMinutes(),r=e.getSeconds();return a+"-"+i+"-"+n+" "+o+":"+(s=s<10?"0"+s:s)+":"+(r=r<10?"0"+r:r)}(e.row.crtTime))}}],columnData:[],loading:!0,pageTotal:0,pageSize:6,currentPage:1,modelState:!1,filterData:{transCode:"",creatorName:"",crtTime:[],assigneeName:"",nodeName:""},sort:"",expand:!1,expandValue:"展开",expandIcon:"&#xe617;"}},props:{listId:{type:String},modal:{type:Boolean},taskValue:{type:String},type:{type:String},orderCode:{type:String},projectName:{type:String}},watch:{listId:{handler:function(t,e){this.getTaskList()}},modal:function(t,e){this.modelState=t}},methods:{changeCurrentPage:function(t){this.currentPage=t,this.getAppTaskCount(this.sort,t)},handleSort:function(t,e,a){var i={};i[t.key]=t.order,this.sort=i,this.getAppTaskCount(i,this.currentPage)},modalVisibleChange:function(t){t||(this.$emit("emitModal",{modal:!1,listId:""}),this.filterData.transCode="",this.filterData.creatorName="",this.filterData.crtTime="",this.filterData.assigneeName="",this.filterData.nodeName="",this.expand=!1,this.sort="",this.currentPage=1,this.expandValue="展开")},clearInputValue:function(){this.filterData.transCode="",this.filterData.creatorName="",this.filterData.crtTime="",this.filterData.assigneeName="",this.filterData.nodeName="",this.filterTaskBtn()},getTaskList:function(){var e=this,t={type:this.type,page:this.currentPage,listId:this.listId,limit:this.pageSize,filter:{}};this.orderCode&&(t.filter.orderCode=this.orderCode),this.projectName&&(t.filter.projectName=this.projectName),t.filter=o()(t.filter),this.loading=!0,Object(d.d)(t).then(function(t){e.pageTotal=t.total,e.columnData=t.tableContent,e.loading=!1})},filterTaskBtn:function(t){this.currentPage=1,this.getAppTaskCount("",1)},getAppTaskCount:function(t,e){var a=this,i="";0<this.filterData.crtTime.length&&this.filterData.crtTime[0]&&(i=Object(u.b)(this.filterData.crtTime[0],"yyyy-MM-dd")+"/"+Object(u.b)(this.filterData.crtTime[1],"yyyy-MM-dd")),this.orderCode&&(this.filterData.orderCode=this.orderCode),this.projectName&&(this.filterData.projectName=this.projectName),this.filterData.crtTime=i;var n={type:this.type,page:e,listId:this.listId,limit:this.pageSize,filter:o()(this.filterData)};t&&(n.sort=o()(t)),this.loading=!0,Object(d.d)(n).then(function(t){a.pageTotal=t.total,a.columnData=t.tableContent,a.loading=!1})},expandCrtTime:function(){this.expand?(this.expand=!1,this.expandValue="展开",this.expandIcon="&#xe617;"):(this.expand=!0,this.expandValue="收起",this.expandIcon="&#xe618;")}}},h=a("ypaA"),m=a.n(h);var f=function(t){a("5PLg")},g=a("VU/8")(p,m.a,!1,f,"data-v-93c16d82",null).exports,v=a("Gu7T"),y=a.n(v),b=a("XLwt"),k={props:["caseId"],data:function(){return{nodes:[],links:[],groupLength:0,dataItem:[],title:""}},methods:{drawECharts:function(){var t=b.init(document.getElementById("circularGraph"));for(var e in t.on("click",this.redirectTo),this.nodes)delete this.nodes[e].symbol;var a=this.dataItem.map(function(t,e){return{name:t.name}});this.nodes.forEach(function(t){t.category=t.index,t.draggable=!0,t.symbol="image:///resources/images/icon/"+t.icon+".png"});var i={tooltip:{},clickable:!0,legend:[{data:a.map(function(t){return t.name})}],animationDuration:3e3,animationDurationUpdate:3e3,animationEasingUpdate:"quinticInOut",series:[{name:this.title,type:"graph",width:"400px",height:"400px",top:"80px",layout:"circular",circular:{rotateLabel:!0},data:this.nodes,links:this.links,categories:a,draggable:!0,edgeSymbol:["none","arrow"],label:{normal:{position:["50%","50%"],formatter:"{b}"}},lineStyle:{normal:{color:"source",curveness:.1}},force:{repulsion:12}}]};t.setOption(i)},redirectTo:function(t){if(void 0!==t.seriesIndex&&"click"==t.type){if("list"!==t.data.type)return;if(t.data.url){var e="appReport/"+t.data.url;window.top.postMessage({type:"redirect",url:e},"*")}}}},created:function(){var a=this,e=this;Object(d.r)(this.caseId).then(function(t){var i=[];a.groupLength=t.dataItem.length,a.dataItem=t.dataItem,a.title=t.title,t&&t.dataItem.map(function(t,e){for(var a=0;a<t.child.length;a++)t.child[a].index=e,t.child[a].icon=e+"_"+a;i=[].concat(y()(i),y()(t.child))}),console.log(i),i.map(function(e){a.nodes.push({name:e.value,id:e.id,index:e.index,icon:e.icon,value:10,url:e.url,type:e.type,symbol:"rect",label:{show:!0},itemStyle:{borderColor:"#ddd",shadowBlur:10,shadowOffsetX:2,shadowOffsetY:2}}),e.endNode.map(function(t){a.links.push({source:e.id,target:t.id})})}),e.drawECharts()})},mounted:function(){}},C=a("gAfU"),T=a.n(C);var _=function(t){a("K6bz")},w=a("VU/8")(k,T.a,!1,_,"data-v-351d1a7e",null).exports,D=a("bTqw"),x={data:function(){return{subReportUrl:"",subReportId:"",subReportModelTitle:"",subReportModel:!1,spinShow:!0,baseLength:45,graphSpace:65,circleFillColor:"#646b86",circleBorderColor:"#e0a527",squareFillColor:"#00ae9d",squareBorderColor:"#77b745",isActive:!1,arr:[],title:"",dataItem:[],pointList:[],transTypePointList:[],waterFlow:{},flowType:!0,businessItemWidth:"50px",ds:c("wss://192.168.3.160:6021/deepstream"),books$$:null,radioGroupLabel:"mytask",rodioGroupDoOrNot:"todo",doneortodo:"todo",taskType:"mytask",defaultDisplayTask:{},teamDone:{},teamTodo:{},myDone:{},myToDo:{},subjectTodo:{},modal:!1,taskValue:"",pageListId:"",type:"myToDo",subjectList:D.b,visible:!1,ordersLoading:!1,searchValue:"",orderCode:"",columnData:[],columns:[{title:"交易号",key:"transCode",align:"center"},{title:"创建者",key:"creatorName",align:"center",width:80},{title:"创建时间",key:"crtTime",align:"center"},{title:"生效时间",key:"effectiveTime",align:"center"}],pageTotal:0,currentPage:1,ordersPageSize:6,projectPopTipVisible:!1,projectLoading:!1,projectSearchValue:"",projectName:"",projectColumnData:[],projectColumns:[{title:"项目名称",key:"projectName",align:"center"},{title:"创建者",key:"creatorName",align:"center",width:80},{title:"创建时间",key:"crtTime",align:"center"},{title:"生效时间",key:"effectiveTime",align:"center"}],projectPageTotal:0,projectCurrentPage:1,projectPageSize:6}},components:{TaskModal:g,CircularGraph:w},props:["caseId"],methods:{draw:function(){for(var s=this.baseLength,r=this.graphSpace,t=this.dataItem,l={},c=void 0,d=void 0,u=void 0,e=0;e<t.length;e++){var a=170+170*e;if(t[e].point="0,"+a+" 2100,"+a,0<t[e].child.length)for(var i=0;i<t[e].child.length;i++){this.dataItem[e].child[i].pointX=40+(s+r)*t[e].child[i].sort,this.dataItem[e].child[i].pointY=50+s/2+170*e,l[this.dataItem[e].child[i].id]=this.dataItem[e].child[i].pointX+","+this.dataItem[e].child[i].pointY;var n=t[e].child[i];0<n.teamDone&&(this.teamDone[n.listId]=99<n.teamDone?"99+":n.teamDone),0<n.teamTodo&&(this.teamTodo[n.listId]=99<n.teamTodo?"99+":n.teamTodo),0<n.myDone&&(this.myDone[n.listId]=99<n.myDone?"99+":n.myDone),0<n.myToDo&&(this.myToDo[n.listId]=99<n.myToDo?"99+":n.myToDo),0<n.subjectTodo&&(this.subjectTodo[n.id]=99<n.subjectTodo?"99+":n.subjectTodo)}}var p=this;t.forEach(function(o,t){o.child.forEach(function(n,t){n.relevantNode&&0<n.relevantNode.length&&n.relevantNode.forEach(function(t,e){t.id in l&&(c=l[t.id].split(","),d=Number(c[0]),u=Number(c[1]),t.groupIndex<o.index?p.transTypePointList.push({id:n.id+"_"+t.id,value:n.pointX+s/2+","+(n.pointY-s/2)+" "+(d+s/2)+","+(u+s/2+20)}):t.groupIndex>o.index?p.transTypePointList.push({id:n.id+"_"+t.id,value:n.pointX+s/2+","+(n.pointY+s/2+20)+" "+(d+s/2)+","+(u-s/2-4.3)}):n.pointX<d-40-s-r?p.transTypePointList.push({id:n.id+"_"+t.id,value:n.pointX+s/2+","+(n.pointY-s/2)+" "+(n.pointX+s/2)+","+(n.pointY-s/2-20)+" "+(d+s/2)+","+(u-s/2-20)+" "+(d+s/2)+","+(u-s/2-4.3)}):p.transTypePointList.push({id:n.id+"_"+t.id,value:n.pointX+s+","+n.pointY+" "+(d-4.3)+","+u}))}),n.endNode&&0<n.endNode.length&&n.endNode.forEach(function(t,e){if(t.id in l)if(c=l[t.id].split(","),d=Number(c[0]),u=Number(c[1]),t.groupIndex<o.index){var a=(d-n.pointX)/(s+r)*8.5;p.pointList.push({id:n.id+"_"+t.id,value:n.pointX+s/2+","+(n.pointY-s/2)+" "+(d+s/2-a)+","+(u+s/2+20)})}else if(t.groupIndex>o.index){var i=(d-n.pointX)/(s+r)*8.5;p.pointList.push({id:n.id+"_"+t.id,value:n.pointX+s/2+","+(n.pointY+s/2+20)+" "+(d+s/2-i)+","+(u-s/2-4.3)})}})})})},calcSvgWidth:function(t){var e=0;if(0<t.length){e=t[0].child.length;for(var a=1;a<t.length;a++)e<t[a].child.length&&(e=t[a].child.length)}var i=e*(30+this.baseLength+this.graphSpace)+50;return document.body.clientWidth>i?document.body.clientWidth:i},calcSvgHeight:function(t){var e=0<t.length?171*t.length+79:215;return document.body.clientHeight>e?document.body.clientHeight:e},doAction:function(t,e){if(this.waterFlow={},t.endNode&&0<t.endNode.length)for(var a=0;a<t.endNode.length;a++)this.waterFlow[t.id+"_"+t.endNode[a].id]=t.endNode[a];if(t.lastNode&&0<t.lastNode.length)for(var i=0;i<t.lastNode.length;i++)this.waterFlow[t.lastNode[i].id+"_"+t.id]=t.lastNode[i]},outBlur:function(t){this.waterFlow={}},redirectTo:function(t,e){var a=t.url,i=window.top.document.getElementById("frame1").getAttribute("nr");"_blank"===t.target?window.open(t.url,"_blank"):(i||(a=~a.indexOf("outlink")?t.url:~a.indexOf("app")?"appReport/"+a:"report/"+a),window.top.postMessage({type:"redirect",url:a},"*"))},subscribeMessage:function(){var t=Object(u.c)();this.ds.event.subscribe("taskChange/"+t,function(t){})},radioGroupChange:function(t){var e=this;this.taskType=t;var a=new l.a([["teamtask_done",function(){return"teamDone"}],["teamtask_todo",function(){return"teamTodo"}],["mytask_done",function(){return"myDone"}],["mytask_todo",function(){return"myToDo"}]]);if(this.type=a.get(this.taskType+"_"+this.doneortodo)(),this.orderCode||this.projectName){var i=this.type;Object(d.l)(i,this.projectName,this.orderCode).then(function(t){e.defaultDisplayTask={},e.defaultDisplayTask=t})}else{switch(this.type){case"teamDone":this.defaultDisplayTask=this.teamDone;break;case"teamTodo":this.defaultDisplayTask=this.teamTodo;break;case"myDone":this.defaultDisplayTask=this.myDone;break;case"myToDo":this.defaultDisplayTask=this.myToDo}this.defaultDisplayTask=s()(this.defaultDisplayTask,this.subjectTodo)}},radioGroupChangeDoneOrTodo:function(t){var e=this;this.doneortodo=t;var a=new l.a([["teamtask_done",function(){return"teamDone"}],["teamtask_todo",function(){return"teamTodo"}],["mytask_done",function(){return"myDone"}],["mytask_todo",function(){return"myToDo"}]]);if(this.type=a.get(this.taskType+"_"+this.doneortodo)(),this.orderCode||this.projectName){var i=this.type;Object(d.l)(i,this.projectName,this.orderCode).then(function(t){e.defaultDisplayTask={},e.defaultDisplayTask=t})}else{switch(this.type){case"teamDone":this.defaultDisplayTask=this.teamDone;break;case"teamTodo":this.defaultDisplayTask=this.teamTodo;break;case"myDone":this.defaultDisplayTask=this.myDone;break;case"myToDo":this.defaultDisplayTask=this.myToDo}this.defaultDisplayTask=s()(this.defaultDisplayTask,this.subjectTodo)}},opentask:function(t){"subject"===t.type?(this.subReportId=t.url.split("/")[1],this.subReportUrl="/Site/index.html?window=dialog#subject/"+this.subReportId,this.subReportModelTitle=t.value,this.subReportModel=!0):(this.modal=!0,this.pageListId=event.target.getAttribute("listId"),this.taskValue=event.target.getAttribute("taskValue"))},emitModal:function(t,e){this.pageListId=t.listId,this.modal=!1},changeCurrentPage:function(t){var e=this,a={type:this.type,page:t,listId:this.pageListId,limit:this.pageSize};this.loading=!0,Object(d.d)(a).then(function(t){0<t.tableContent.length&&(e.columnData=t.tableContent,e.loading=!1)})},onHandleClearOrderTag:function(){var e=this;this.orderCode="",this.projectName?Object(d.l)(this.type,this.projectName).then(function(t){e.defaultDisplayTask={},e.defaultDisplayTask=t}):this.defaultDisplayTask=s()(this[this.type],this.subjectTodo)},onHandleFilterByCode:function(){var e=this,t=[];this.searchValue&&(t=o()([{operator:"like",value:this.searchValue,property:"transCode"}])),this.currentPage=1,this.ordersLoading=!0,Object(d.m)(this.currentPage,t).then(function(t){e.pageTotal=t.dataCount,e.columnData=t.tableContent,e.ordersLoading=!1})},getSaleOrderList:function(){var e=this;this.searchValue="",this.currentPage=1,this.ordersLoading=!0,Object(d.m)(this.currentPage).then(function(t){e.pageTotal=t.dataCount,e.columnData=t.tableContent,e.ordersLoading=!1})},orderPageChange:function(t){var e=this,a=[];this.searchValue&&(a=o()([{operator:"like",value:this.searchValue,property:"transCode"}])),this.currentPage=t,this.ordersLoading=!0,Object(d.m)(this.currentPage,a).then(function(t){e.pageTotal=t.dataCount,e.columnData=t.tableContent,e.ordersLoading=!1})},handleDblclick:function(t,e){var a=this,i=this.type;this.orderCode=t.transCode,Object(d.l)(i,this.projectName,this.orderCode).then(function(t){a.defaultDisplayTask={},a.visible=!1,a.defaultDisplayTask=t})},onHandleClearProjectTag:function(){var e=this;this.projectName="",this.orderCode?Object(d.l)(this.type,"",this.orderCode).then(function(t){e.defaultDisplayTask={},e.defaultDisplayTask=t}):this.defaultDisplayTask=s()(this[this.type],this.subjectTodo)},onHandleFilterByProjectName:function(){var e=this,t=[];this.projectSearchValue&&(t=o()([{operator:"like",value:this.projectSearchValue,property:"projectName"}])),this.projectCurrentPage=1,this.projectLoading=!0,Object(d.p)(this.currentPage,t).then(function(t){e.projectPageTotal=t.dataCount,e.projectColumnData=t.tableContent,e.projectLoading=!1})},getProjectList:function(){var e=this;this.projectSearchValue="",this.projectCurrentPage=1,this.projectLoading=!0,Object(d.p)(this.projectCurrentPage).then(function(t){e.projectPageTotal=t.dataCount,e.projectColumnData=t.tableContent,e.projectLoading=!1})},projectPageChange:function(t){var e=this,a=[];this.projectSearchValue&&(a=o()([{operator:"like",value:this.projectSearchValue,property:"projectName"}])),this.projectCurrentPage=t,this.projectLoading=!0,Object(d.p)(this.projectCurrentPage,a).then(function(t){e.projectPageTotal=t.dataCount,e.projectColumnData=t.tableContent,e.projectLoading=!1})},handleDbSelectProject:function(t,e){var a=this,i=this.type;this.projectName=t.projectName,Object(d.l)(i,this.projectName,this.orderCode).then(function(t){a.defaultDisplayTask={},a.projectPopTipVisible=!1,a.defaultDisplayTask=t})},refreshData:function(){var i=this,n=this;Object(d.r)(this.caseId).then(function(t){t.dataItem.map(function(t){t.child&&t.child.map(function(t){var e,a;"subject"===t.type&&t.value&&(t.icon="resources/images/icon/"+(e=t.value,a="",i.subjectList.map(function(t){t.name===e&&(a=t.icon)}),a))})}),n.title=t.title,n.dataItem=t.dataItem;var e=1400<n.calcSvgWidth(t.dataItem)?n.calcSvgWidth(t.dataItem):1400,a=n.calcSvgHeight(t.dataItem);window.document.getElementById("flow-box")&&(window.document.getElementById("flow-box").style.width=e+"px",window.document.getElementById("flow-box").style.height=a+"px",n.draw(),i.defaultDisplayTask=s()(i.myToDo,i.subjectTodo),n.spinShow=!1)}).catch(function(t){var e="<p>"+t+"</p>";i.$Modal.error({title:"提示",content:e,closable:!0})})}},created:function(){var t=this.$currentUser,e=[t.nickname,t.userId].join("|"),a=Object(u.c)();this.ds.login({token:a,username:e},function(t){console.log("connect success!")}),this.subscribeMessage()},mounted:function(){this.refreshData()}},S=a("lSc+"),j=a.n(S);var I=function(t){a("PuhB")},P=a("VU/8")(x,j.a,!1,I,null,null);e.default=P.exports},tNBv:function(t,e){},vFuF:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("Gu7T"),o=a.n(i),s=a("K4CD"),n=a("GIAq"),r={name:"MenuItem",props:["appinfo","allTaskCount"],components:{MyPopTip:a("3ovf").a},data:function(){return{taskCount:0,type:this.appinfo.url.split("/")[0],onPageSelection:[],batchComment:"",columns:[{type:"selection",width:60,align:"center",key:"unableEdit"},{title:"交易号",key:"transCode",sortable:!0,width:160,align:"center",render:function(t,e){return t("a",{attrs:{href:"/Form/index.html?data="+e.row.transCode,target:"_blank"}},e.row.transCode)}},{title:"当前节点",key:"nodeName"},{title:"当前用户",key:"assigneeName",width:90},{title:"创建者",key:"creatorName",sortable:!0},{title:"任务创建时间",key:"crtTime",width:160,align:"center",sortable:!0,render:function(t,e){return t("span",function(t){var e=new Date(t),a=e.getFullYear(),i=e.getMonth()+1;i=i<10?"0"+i:i;var n=e.getDate();n=n<10?"0"+n:n;var o=e.getHours();o=o<10?"0"+o:o;var s=e.getMinutes(),r=e.getSeconds();return a+"-"+i+"-"+n+" "+o+":"+(s=s<10?"0"+s:s)+":"+(r=r<10?"0"+r:r)}(e.row.crtTime))}}],columnData:[],loading:!1,pageTotal:0,pageSize:10,currentPage:1,pageListId:"",userInfo:{}}},created:function(){~this.appinfo.icon.indexOf("/dist/")&&(this.appinfo.icon="/dist/"+this.appinfo.icon);var e=this.appinfo.url.split("/")[1],t=this.allTaskCount.filter(function(t){return t.listId===e});0<t.length&&(this.taskCount=t[0].total)},watch:{allTaskCount:{handler:function(t,e){var a=this.appinfo.url.split("/")[1],i=t.filter(function(t){return t.listId===a});0<i.length&&(this.taskCount=i[0].total)},deep:!0}},methods:{redirectTo:function(t){var e=t.url,a=window.top.document.getElementById("frame1").getAttribute("nr");"_blank"===t.target?window.open(e,"_blank"):(a||(e=~e.indexOf("outlink")?e:~t.url.indexOf("app")?"appReport/"+e:"report/"+e),window.top.postMessage({type:"redirect",url:e},"*"))},showUserInfo:function(){var e=this,t=this.appinfo.adminId;Object(n.R)(t).then(function(t){t.dataCount&&(e.userInfo=t.tableContent[0])})},popperShow:function(t){var e=this;this.pageListId=this.appinfo.url.split("/")[1];var a={type:"myToDo",page:this.currentPage,listId:this.pageListId,limit:this.pageSize};this.onPageSelection=[],this.loading=!0,Object(s.d)(a).then(function(t){e.pageTotal=t.total,0<t.tableContent.length&&(e.columnData=t.tableContent,e.columnData.forEach(function(t){t.unableEdit||(t._disabled=!0)}),e.loading=!1)})},changeCurrentPage:function(t){var a=this,e={type:"myToDo",page:t,listId:this.pageListId,limit:this.pageSize};this.loading=!0,Object(s.d)(e).then(function(t){0<t.tableContent.length&&(a.columnData=t.tableContent,a.columnData.forEach(function(e){0<a.onPageSelection.length&&a.onPageSelection.forEach(function(t){t.taskId===e.taskId&&(e._checked=!0)}),e.unableEdit||(e._disabled=!0)}),a.loading=!1)})},goAppSetting:function(t){var e="appSetting/"+t.listId;window.top.postMessage({type:"redirect",url:e},"*")},handlerAddInstance:function(){var e=this,a="";Object(s.h)(this.appinfo.listId).then(function(t){0<t.length?(a=t.filter(function(t){return"submit"===t.viewType})[0].uniqueId,window.open("/Form/index.html?model=new&view="+a+"&list="+e.appinfo.listId)):e.$Message.info("表单模板为空")})},handleBatchApproval:function(){var a=this;this.batchComment="",this.$Modal.confirm({title:"审批",content:"<p>审批意见</p>",closable:!0,okText:"同意",cancelText:"不同意",transfer:!0,render:function(t){return t("div",[t("label","审批意见: "),t("Input",{props:{value:a.batchComment,autofocus:!0},style:{width:"75%",marginLeft:"10px"},on:{input:function(t){a.batchComment=t}}})])},onOk:function(){var t=a.onPageSelection,e=[];t.forEach(function(t){e.push({taskId:t.taskId,transCode:t.transCode,result:1,comment:a.batchComment})}),Object(s.a)(e).then(function(t){a.onPageSelection=[],t.success?a.$Notice.success({title:"提示",desc:t.message}):a.$Notice.error({title:"提示",desc:t.message})})},onCancel:function(){var t=a.onPageSelection,e=[];t.forEach(function(t){e.push({taskId:t.taskId,transCode:t.transCode,result:0,comment:a.batchComment})}),Object(s.a)(e).then(function(t){a.onPageSelection=[],t.success?a.$Notice.success({title:"提示",desc:t.message}):a.$Notice.error({title:"提示",desc:t.message})})}})},onSelectAll:function(t){var e,a={};(e=this.onPageSelection).push.apply(e,o()(t)),this.onPageSelection=this.onPageSelection.reduce(function(t,e){return!a[e.taskId]&&(a[e.taskId]=t.push(e)),t},[])},handerSelectionChange:function(t){if(0===t.length){var e=this.$refs.selection.data,a=this.onPageSelection;e.map(function(e){a=a.filter(function(t){return t.taskId!==e.taskId})}),this.onPageSelection=a}else{var i,n={};(i=this.onPageSelection).push.apply(i,o()(t)),this.onPageSelection=this.onPageSelection.reduce(function(t,e){return!n[e.taskId]&&(n[e.taskId]=t.push(e)),t},[])}},onSelectCancel:function(t,e){this.onPageSelection=this.onPageSelection.filter(function(t){return t.taskId!==e.taskId})}}},l=a("ZsAX"),c=a.n(l);var d=function(t){a("tNBv")},u=a("VU/8")(r,c.a,!1,d,"data-v-703bb3f2",null).exports,p={name:"MenuList",props:["menuItem","allTaskCount"],components:{MenuItem:u},created:function(){}},h=a("g+9v"),m=a.n(h);var f=function(t){a("L19k")},g=a("VU/8")(p,m.a,!1,f,"data-v-317b0914",null).exports,v=a("oAV5"),y={components:{MenuList:g,MenuItem:u,PulseGraph:a("ll1Z").default},data:function(){return{spinShow:!0,cutView:!0,menuList:[],menu:[],favoriteMenu:{leaf:!1,text:"常用应用",children:[]},caseId:"apps",allTaskCount:[],books$$:null,isAdmin:this.$currentUser.isAdmin,model:"apps"}},created:function(){var e=this,t=window.sessionStorage.getItem("roletask.com.r2.cache");t?(t=t?JSON.parse(t):{},this.menuList=t["/ds/getMenu"],this.menu=this.menuList.slice(0,6),this.spinShow=!1):Object(s.k)().then(function(t){e.urlMd5(t),0<e.favoriteMenu.children.length?e.menuList=[e.favoriteMenu].concat(o()(t)):e.menuList=t,6<e.menuList.length?e.menu=e.menuList.slice(0,6):e.menu=menuList,e.spinShow=!1})},mounted:function(){var n=this;this.subscribeMessage(),Object(s.f)().then(function(t){n.allTaskCount=t.tableContent}),window.onscroll=function(){if(n.menu.length<n.menuList.length){var t=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight),e=0;e=document.body.clientHeight&&document.documentElement.clientHeight?Math.min(document.body.clientHeight,document.documentElement.clientHeight):Math.max(document.body.clientHeight,document.documentElement.clientHeight);var a=0;if(document.documentElement&&document.documentElement.scrollTop?a=document.documentElement.scrollTop:document.body&&(a=document.body.scrollTop),t-150<a+e){var i=n.menuList.slice(n.menu.length,n.menu.length+1)[0];n.menu.push(i)}}}},methods:{changeView:function(t){t&&(this.caseId="apps"===t?(this.cutView=!0,t):(this.cutView=!1,Number(t)))},goAppManage:function(){window.top.location.hash="#page/AppSetting"},subscribeMessage:function(){var e=this,t=this.$deepstream;Object(v.c)();this.spinShow=!1,t.event&&t.event.subscribe("taskChange/"+this.$currentUser.userId,function(t){e.allTaskCount=t.tableContent})},urlMd5:function(t){!function t(e){for(var a=e.length,i=void 0;a--;){if((i=e[a]).url&&"_iframe"==i.target){var n=i.url,o="outlink/"+window.top.MD5(n);i.url=o}i.children&&t(i.children)}}(t)}}},b=a("SSN6"),k=a.n(b);var C=function(t){a("7vBh")},T=a("VU/8")(y,k.a,!1,C,"data-v-e057b69a",null);e.default=T.exports},ypaA:function(t,e){t.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{attrs:{title:"任务列表 - "+e.taskValue,width:"660",closable:""},on:{"on-visible-change":e.modalVisibleChange},model:{value:e.modelState,callback:function(t){e.modelState=t},expression:"modelState"}},[a("div",{staticStyle:{position:"relative"}},[a("div",{staticClass:"input-filter-box"},[a("label",{staticClass:"input-filter-lebal"},[e._v("交易号:")]),e._v(" "),a("Input",{staticStyle:{width:"127px","margin-left":"12px"},attrs:{placeholder:"请输入交易号"},model:{value:e.filterData.transCode,callback:function(t){e.$set(e.filterData,"transCode",t)},expression:"filterData.transCode"}})],1),e._v(" "),a("div",{staticClass:"input-filter-box"},[a("label",{staticClass:"input-filter-lebal"},[e._v("创建者:")]),e._v(" "),a("Input",{staticStyle:{width:"127px","margin-left":"12px"},attrs:{placeholder:"请输入创建者"},model:{value:e.filterData.creatorName,callback:function(t){e.$set(e.filterData,"creatorName",t)},expression:"filterData.creatorName"}})],1),e._v(" "),a("div",{staticClass:"input-filter-box"},[a("label",{staticClass:"input-filter-lebal"},[e._v("当前用户:")]),e._v(" "),a("Input",{staticStyle:{width:"127px","margin-left":"12px"},attrs:{placeholder:"请输入审批者"},model:{value:e.filterData.assigneeName,callback:function(t){e.$set(e.filterData,"assigneeName",t)},expression:"filterData.assigneeName"}})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.expand,expression:"expand"}],staticClass:"input-crttime"},[a("div",{staticClass:"input-filter-box"},[a("label",{staticClass:"input-filter-lebal"},[e._v("当前节点:")]),e._v(" "),a("Input",{staticStyle:{width:"127px","margin-left":"12px"},attrs:{placeholder:"请输入当前节点"},model:{value:e.filterData.nodeName,callback:function(t){e.$set(e.filterData,"nodeName",t)},expression:"filterData.nodeName"}})],1),e._v(" "),a("div",{staticClass:"input-filter-box"},[a("label",{staticClass:"input-filter-lebal"},[e._v("创建时间:")]),e._v(" "),a("DatePicker",{staticStyle:{width:"170px"},attrs:{format:"yyyy/MM/dd",type:"daterange",placement:"bottom-end",placeholder:"请输入创建时间"},model:{value:e.filterData.crtTime,callback:function(t){e.$set(e.filterData,"crtTime",t)},expression:"filterData.crtTime"}})],1)]),e._v(" "),a("div",{staticClass:"action-btn"},[a("Button",{attrs:{type:"primary",size:"small"},on:{click:e.filterTaskBtn}},[e._v("查询")]),e._v(" "),a("Button",{attrs:{size:"small"},on:{click:e.clearInputValue}},[e._v("重置")]),e._v(" "),a("span",{staticClass:"expand",on:{click:e.expandCrtTime}},[e._v("\n        "+e._s(e.expandValue)+"\n        "),a("i",{staticClass:"iconfont",domProps:{innerHTML:e._s(e.expandIcon)}})])],1)]),e._v(" "),a("Table",{attrs:{loading:e.loading,data:e.columnData,columns:e.columns,size:"small",stripe:""},on:{"on-sort-change":e.handleSort}}),e._v(" "),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:e.pageTotal,current:e.currentPage,"page-size":e.pageSize,size:"small","show-total":"","show-elevator":""},on:{"on-change":e.changeCurrentPage}})],1)]),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"})],1)},staticRenderFns:[]}}});
webpackJsonp([8],{"0RZk":function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app",staticStyle:{"margin-top":"15px"}},[s("Row",{staticClass:"app-action"},[s("Row",{staticClass:"app-action-title"},[s("h3",[t._v("管理子科目")]),t._v(" "),s("span",{staticClass:"warning-color marlr"},[t._v("（科目）管理子科目")])]),t._v(" "),s("div",{staticClass:"app-action-source"},[s("Row",[s("Table",{attrs:{columns:t.columns,data:t.subjectData,size:"small"}})],1)],1)],1)],1)},staticRenderFns:[]}},"3P2k":function(t,e){},"3fB+":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var c=s("GIAq"),a=s("bTqw"),o={name:"permissionSource",components:{},props:{enabledForbidden:Number,isAdmin:Boolean},data:function(){return{listId:this.$route.params.listId,isEdit:"",actionData:[]}},watch:{enabledForbidden:function(){this.getData()}},methods:{isForbidden:function(t,e){var s=this,a=void 0;a=0===t.permType?-2:0,Object(c.a)(t.id,a).then(function(t){t.success&&(s.$Message.success(t.message),s.getData())})},getData:function(){var e=this,t=this.listId;Object(c.w)(t).then(function(t){e.actionData=t.tableContent,e.actionData.map(function(t){t.desc=a.a[t.resourceName]})})}},created:function(){},mounted:function(){this.getData()}},i=s("RAte"),n=s.n(i);var r=function(t){s("hgVa")},l=s("VU/8")(o,n.a,!1,r,"data-v-e1385328",null).exports,d=s("Gu7T"),u=s.n(d),h=(s("lZCD"),s("CaXr")),p=s("mvHQ"),m=s.n(p),f={name:"GroupSelector",components:{},props:{showGroupSelector:{type:Boolean}},data:function(){return{searchOrgValue:"",orgTotal:0,orgCurrentPage:1,pageSize:10,orgLoading:!0,showOrgModal:!1,orgColumns:[{type:"selection",width:60,align:"center"},{title:"名称",key:"name"}],orgData:[],orgSelectData:[],orgSelection:[]}},watch:{showGroupSelector:function(t){t&&(this.showOrgModal=t,this.selectOrgModal(),this.orgSelection=[],this.orgSelectData=[],this.searchOrgValue="")}},methods:{orgFilter:function(){var t=m()([{operator:"like",value:this.searchOrgValue,property:"name"}]);this.selectOrgModal(t,1)},selectOrgModal:function(t,e){var s=this;this.orgLoading=!0,Object(c.v)(e||this.orgCurrentPage,this.pageSize,t).then(function(t){s.orgData=t.tableContent,s.orgTotal=t.dataCount,s.orgLoading=!1,0<s.orgSelection.length&&s.orgData.map(function(e){s.orgSelection.map(function(t){e.id==t.id&&(e._checked=!0)})})})},selectOrgClick:function(t,e){if(0===t.length){var s=this.$refs.orgTable.data,a=this.orgSelection;s.map(function(e){a=a.filter(function(t){return t.id!==e.id})}),this.orgSelection=a}else{var o,i={};(o=this.orgSelection).push.apply(o,u()(t)),this.orgSelection=this.orgSelection.reduce(function(t,e){return!i[e.id]&&(i[e.id]=t.push(e)),t},[])}},onOrgSelectAll:function(t){var e,s={};(e=this.orgSelection).push.apply(e,u()(t)),this.orgSelection=this.orgSelection.reduce(function(t,e){return!s[e.id]&&(s[e.id]=t.push(e)),t},[])},selectOrgCancel:function(t,s){var a=this;this.orgSelection.forEach(function(t,e){t.id===s.id&&a.orgSelection.splice(e,1)})},deleteSelectOrg:function(s,t){var a=this;this.orgSelection.splice(t,1),this.$refs.orgTable.data.forEach(function(t,e){s.id===t.id&&a.$refs.orgTable.toggleSelect(e)})},cancelSelectOrg:function(){this.orgSelection=this.orgSelectData},confirmOrg:function(){var s={};this.orgSelectData=this.orgSelection.reduce(function(t,e){return!s[e.id]&&(s[e.id]=t.push(e)),t},[]),this.$emit("groupModalData",this.orgSelectData)},modalVisibleChange:function(t){t||this.$emit("emitGroupModal",{modal:!1})},onOrgPageChange:function(t){var e=m()([{operator:"like",value:this.searchOrgValue,property:"name"}]);this.orgCurrentPage=t,this.selectOrgModal(e)}},mounted:function(){}},g=s("Xqh5"),v=s.n(g);var w=function(t){s("3P2k")},D=s("VU/8")(f,v.a,!1,w,null,null).exports,S={name:"RoleSelector",components:{},props:{showRoleSelector:{type:Boolean}},data:function(){return{searchDepValue:"",depTotal:0,depCurrentPage:1,pageSize:10,depLoading:!0,showDepartmentModal:!1,departmentColumns:[{type:"selection",width:60,align:"center"},{title:"名称",key:"name"}],departmentData:[],departmentSelectData:[],departmentSelection:[]}},watch:{showRoleSelector:function(t){t&&(this.showDepartmentModal=t,this.selectPositionModal(),this.departmentSelection=[],this.departmentSelectData=[],this.searchDepValue="")}},methods:{depFilter:function(){var t=m()([{operator:"like",value:this.searchDepValue,property:"name"}]);this.selectPositionModal(t,1)},selectPositionModal:function(t,e){var s=this;this.depLoading=!0,Object(c.u)(e||this.depCurrentPage,this.pageSize,t).then(function(t){s.departmentData=t.tableContent,s.depTotal=t.dataCount,s.depLoading=!1,0<s.departmentSelection.length&&s.departmentData.map(function(e){s.departmentSelection.map(function(t){e.id==t.id&&(e._checked=!0)})})})},selectDepartmentClick:function(t,e){if(0===t.length){var s=this.$refs.roleTable.data,a=this.departmentSelection;s.map(function(e){a=a.filter(function(t){return t.id!==e.id})}),this.departmentSelection=a}else{var o,i={};(o=this.departmentSelection).push.apply(o,u()(t)),this.departmentSelection=this.departmentSelection.reduce(function(t,e){return!i[e.id]&&(i[e.id]=t.push(e)),t},[])}},onRoleSelectAll:function(t){var e,s={};(e=this.departmentSelection).push.apply(e,u()(t)),this.departmentSelection=this.departmentSelection.reduce(function(t,e){return!s[e.id]&&(s[e.id]=t.push(e)),t},[])},selectDepCancel:function(t,s){var a=this;this.departmentSelection.forEach(function(t,e){t.id===s.id&&a.departmentSelection.splice(e,1)})},deleteSelectRole:function(s,t){var a=this;this.departmentSelection.splice(t,1),this.$refs.roleTable.data.forEach(function(t,e){s.id===t.id&&a.$refs.roleTable.toggleSelect(e)})},cancelSelectDep:function(){this.departmentSelection=this.departmentSelectData},confirmDepartment:function(){var s={};this.departmentSelectData=this.departmentSelection.reduce(function(t,e){return!s[e.id]&&(s[e.id]=t.push(e)),t},[]),this.$emit("roleModalData",this.departmentSelectData)},modalVisibleChange:function(t){t||this.$emit("emitRoleModal",{modal:!1})},onDepPageChange:function(t){var e=m()([{operator:"like",value:this.searchDepValue,property:"name"}]);this.depCurrentPage=t,this.selectPositionModal(e)}},mounted:function(){}},b=s("Ogty"),M=s.n(b);var _=function(t){s("zYdX")},C=s("VU/8")(S,M.a,!1,_,null,null).exports,k={name:"ReportModal",components:{UserSelector:h.a,GroupSelector:D,RoleSelector:C},props:{modalStatis:{type:Boolean},permissionId:{type:[String,Number]},permissionData:{type:Array}},data:function(){return{appListId:this.$route.params.listId,emitChange:0,showPermissionModal:!1,isModalDisabled:!0,userSelectData:[],orgSelectData:[],departmentSelectData:[],showSelector:{showUserSelector:!1,showGroupSelector:!1,showRoleSelector:!1}}},watch:{modalStatis:function(t,e){var s=this;this.showPermissionModal=t,this.userSelectData=[],this.orgSelectData=[],this.departmentSelectData=[],t&&(this.orgSelectData=this.permissionData.filter(function(t){return"group"===t.type}),this.departmentSelectData=this.permissionData.filter(function(t){return"role"===t.type}),this.permissionData.forEach(function(t){"user"===t.type&&s.userSelectData.push({nickname:t.name,userId:t.id,type:t.type})}))},userSelectData:function(t){0<t.length?this.isModalDisabled=!1:0<this.orgSelectData.length||0<this.departmentSelectData.length?this.isModalDisabled=!1:this.isModalDisabled=!0},orgSelectData:function(t){0<t.length?this.isModalDisabled=!1:0<this.departmentSelectData.length||0<this.userSelectData.length?this.isModalDisabled=!1:this.isModalDisabled=!0},departmentSelectData:function(t){0<t.length?this.isModalDisabled=!1:0<this.orgSelectData.length||0<this.userSelectData.length?this.isModalDisabled=!1:this.isModalDisabled=!0}},methods:{emitUserModal:function(){this.showSelector.showUserSelector=!1},emitGroupModal:function(){this.showSelector.showGroupSelector=!1},emitRoleModal:function(){this.showSelector.showRoleSelector=!1},getUserModalData:function(t){if(0<this.userSelectData.length){var e,s={};(e=this.userSelectData).push.apply(e,u()(t)),this.userSelectData=this.userSelectData.reduce(function(t,e){return!s[e.userId]&&(s[e.userId]=t.push(e)),t},[])}else this.userSelectData=t},getGroupModalData:function(t){if(0<this.orgSelectData.length){var e,s={};(e=this.orgSelectData).push.apply(e,u()(t)),this.orgSelectData=this.orgSelectData.reduce(function(t,e){return!s[e.id]&&(s[e.id]=t.push(e)),t},[])}else this.orgSelectData=t},getRoleModalData:function(t){if(0<this.departmentSelectData.length){var e,s={};(e=this.departmentSelectData).push.apply(e,u()(t)),this.departmentSelectData=this.departmentSelectData.reduce(function(t,e){return!s[e.id]&&(s[e.id]=t.push(e)),t},[])}else this.departmentSelectData=t},cancelAddPermission:function(){this.showPermissionModal=!1},selectUserModal:function(){this.showSelector.showUserSelector=!0},selectGroupModal:function(){this.showSelector.showGroupSelector=!0},selectRoleModal:function(){this.showSelector.showRoleSelector=!0},deleteUser:function(t){var e=t.target.parentElement.getAttribute("userid");this.userSelectData=this.userSelectData.filter(function(t){return t.userId!=e}),this.userSelection=this.userSelection.filter(function(t){return t.userId!=e})},deleteOrg:function(t){var e=t.target.parentElement.getAttribute("orgid");this.orgSelectData=this.orgSelectData.filter(function(t){return t.id!=e}),this.orgSelection=this.orgSelection.filter(function(t){return t.id!=e})},deleteDepartment:function(t){var e=t.target.parentElement.getAttribute("depid");this.departmentSelectData=this.departmentSelectData.filter(function(t){return t.id!=e}),this.departmentSelection=this.departmentSelection.filter(function(t){return t.id!=e})},submitPermission:function(){var s=this,t=this.userSelectData.map(function(t){return t.userId}).join(","),e=this.orgSelectData.map(function(t){return t.id}).join(","),a=this.departmentSelectData.map(function(t){return t.id}).join(",");Object(c._14)(this.permissionId,t,e,a).then(function(t){if(t.success){s.showPermissionModal=!1,s.$Message.success(t.message);var e=s.emitChange++;s.$emit("reGetData",e)}else s.$Message.error(t.message)})},modalVisibleChange:function(t){t||this.$emit("emitPermissionModal",{modal:!1})}}},y=s("B23i"),I=s.n(y);var R=function(t){s("yKKk")},A={name:"reportSource",components:{ReportModal:s("VU/8")(k,I.a,!1,R,null,null).exports},props:{appType:String,isAdmin:Boolean},data:function(){return{listId:this.$route.params.listId,showReportModal:!1,permissionId:"",columns:[],reportSources:[],permissionData:[]}},watch:{isAdmin:function(t){this.setColumns()},deep:!0},methods:{emitPermissionModal:function(){this.showReportModal=!1},goCreateView:function(){window.top.location.href="/Site/index.html#appSetting/"+this.listId+"/"+this.appType+"/viewTypes"},reGetData:function(){this.getViewsData()},getViewsData:function(){var e=this;Object(c.T)(this.listId).then(function(t){t.forEach(function(t){t.users||(t.users=[]),t.roles||(t.roles=[]),t.groups||(t.groups=[]),t.permissionList=[].concat(u()(t.groups),u()(t.roles),u()(t.users))}),e.reportSources=t})},deleteViews:function(t,s){var a=this;if(1===this.reportSources.length)this.$Message.warning("不可删除唯一视图！");else if(1===t.row.isDefault){var e={viewId:t.row.viewId,listId:this.listId};this.$Modal.confirm({title:"确认",content:"确认删除此视图？",onOk:function(){Object(c.k)(e).then(function(t){if(t.success){a.reportSources.splice(s,1);var e={viewId:a.reportSources[0].viewId,listId:a.listId};Object(c._11)(e).then(function(t){t.success&&a.reloadViewData()})}})}})}else{var o={viewId:t.row.viewId,listId:this.listId};this.$Modal.confirm({title:"确认",content:"确认删除此视图？",onOk:function(){Object(c.k)(o).then(function(t){t.success&&(a.reportSources.splice(s,1),a.$Message.success(t.message))})}})}},reloadViewData:function(){var e=this;Object(c.T)(this.listId).then(function(t){t.forEach(function(t){t.permissionList=[].concat(u()(t.groups),u()(t.roles),u()(t.users))}),e.reportSources=t})},onClickDefaultView:function(t){var e=this;this.$Modal.confirm({title:"确认",content:"确认设置此视图为默认视图？",onOk:function(){e.setDefaultViews(t)},onCancel:function(){e.reloadViewData()}})},setDefaultViews:function(t){var e=this,s={viewId:t.row.viewId,listId:this.listId};Object(c._11)(s).then(function(t){t.success&&(e.$Message.success(t.message),e.reloadViewData())})},setColumns:function(){var a=this,t=[{title:"报表名称",key:"title",width:200},{title:"已授权用户、组织或职位",key:"permissionList",render:function(a,t){var e=t.row.permissionList,o=[];if(0<e.length)return e.forEach(function(t,e){var s=a("span",{style:{margin:"0px 5px"}},t.name);o.push(s)}),a("div",o)}}],e=[{title:"默认视图",key:"isDefault",align:"center",render:function(t,e){var s=!1;return 1===e.row.isDefault&&(s=!0),t("Radio",{props:{value:s,disabled:!a.isAdmin},on:{"on-change":function(t){a.onClickDefaultView(e)}}})}}],s=[{title:"操作",key:"list",align:"center",render:function(t,e){return t("div",[t("a",{on:{click:function(){a.deleteViews(e,e.index)}},style:{display:"subject"!==a.appType?"inline-block":"none"}},"删除"),t("span",{style:{height:"20px",borderLeft:"1px solid #39f",margin:"0px 5px",display:"subject"!==a.appType?"inline":"none"}}),t("a",{on:{click:function(){var t="/Site/index.html#appSetting/viewConfig/"+a.listId+"/"+e.row.viewId;window.top.location.href=t}},style:{display:"subject"!==a.appType?"inline-block":"none"}},"修改"),t("span",{style:{height:"20px",borderLeft:"1px solid #39f",margin:"0px 5px",display:"subject"!==a.appType?"inline":"none"}}),t("a",{on:{click:function(){a.permissionId=e.row.permissionId,a.showReportModal=!0,a.permissionData=e.row.permissionList}}},"授权")])}}];this.isAdmin&&"subject"!==this.appType?this.columns=t.concat(e).concat(s):this.isAdmin?this.columns=t.concat(s):this.columns=t}},mounted:function(){this.setColumns(),this.getViewsData()}},P=s("JfmC"),j=s.n(P);var x=function(t){s("blmo")},O=s("VU/8")(A,j.a,!1,x,"data-v-1081e30a",null).exports,F={name:"formSource",components:{},props:{isAdmin:Boolean},data:function(){return{listId:this.$route.params.listId}},methods:{setForm:function(){window.open("/Form/index.html?viewDesign=true&list="+this.listId)}},created:function(){},mounted:function(){}},$=s("eBIU"),W=s.n($);var T=function(t){s("FxqG")},G=s("VU/8")(F,W.a,!1,T,"data-v-682736de",null).exports,U=s("bOdI"),E=s.n(U),V={name:"WorkflowModal",props:{modalWorkflowStatus:Boolean,deleteRelationWorkflow:Number},data:function(){var s=this;return{listId:this.$route.params.listId,searchValue:"",showWorkFlow:!1,relativeWorkFlowTotal:0,allWorkFlowTotal:0,allCurrentPage:1,relativeCurrentPage:1,pageSize:10,loadingAll:!0,loadingRelative:!0,allWorkFlowColumns:[{title:"名称",key:"processName"},{title:"查看流程图",key:"action",align:"center",render:function(t,e){return t("a",{props:{type:"default",size:"small"},on:{click:function(){window.open("/myflow/viewProc.html?processId="+e.row.id)}}},"查看")}}],relativeWorkFlowColumns:[{title:"名称",key:"processName"},{title:"配置节点",key:"config",align:"center",render:function(t,e){return t("a",{on:{click:function(){window.open("/myflow/viewFlow.html?processId="+e.row.procId+"&listId="+s.listId+"&processCode="+e.row.processCode)}}},"配置")}},{title:"操作",key:"action",align:"center",render:function(t,e){return t("a",{on:{click:function(){s.deleteWorkflow(e.row,e.index)}}},"删除")}}],allWorkFlowData:[],relativeWorkFlowData:[]}},watch:{modalWorkflowStatus:function(t,e){this.showWorkFlow=t},deleteRelationWorkflow:function(){this.getRelativeWorkflowData()}},methods:{workflowFilter:function(){var t=m()([{operator:"like",value:this.searchValue,property:"processName"}]);this.allCurrentPage=1,this.getAllWorkflowData(t)},selectWorkFlow:function(){},getAllWorkflowData:function(t){var e=this;this.loadingAll=!0,Object(c.x)(this.allCurrentPage,this.pageSize,t).then(function(t){e.allWorkFlowData=t.tableContent,e.allWorkFlowTotal=t.dataCount,e.loadingAll=!1})},getRelativeWorkflowData:function(){var e=this;this.loadingRelative=!0,Object(c.V)(this.listId,this.relativeCurrentPage,this.pageSize).then(function(t){e.relativeWorkFlowData=t,e.relativeWorkFlowTotal=t.length,e.loadingRelative=!1})},onPageChange:function(t){var e=m()([{operator:"like",value:this.searchValue,property:"processName"}]);this.allCurrentPage=t,this.getAllWorkflowData(e)},onRelativePageChange:function(t){this.relativeCurrentPage=t,this.getRelativeWorkflowData()},modalVisibleChange:function(t){t||this.$emit("emitWorkFlowModal",{modal:!1})},addWorkflowData:function(t,e){0===this.relativeWorkFlowData.length?this.saveWorkFlow(t):this.$Message.warning("请先删除已关联工作流再添加！")},saveWorkFlow:function(t){var e=this,s={listId:this.listId,procCode:t.processCode,creator:"",list:"list_process_rel",status:1};Object(c._15)(s).then(function(t){t.success&&(e.$Message.success(t.message),e.getRelativeWorkflowData(),e.$emit("addWorkflow"))})},deleteWorkflow:function(t,e){var s=this,a={ID:t.id,list:"list_process_rel",status:0};Object(c._15)(a).then(function(t){t.success&&(s.$Message.success(t.message),s.relativeWorkFlowData.splice(e,1),s.$emit("addWorkflow"))})}},mounted:function(){this.getAllWorkflowData(),this.getRelativeWorkflowData()}},B=s("LSpa"),N=s.n(B);var L,z=function(t){s("dpLH")},K={name:"workflowSource",components:{WorkflowModal:s("VU/8")(V,N.a,!1,z,"data-v-4d1d1dac",null).exports},props:{isAdmin:Boolean},data:function(){return{listId:this.$route.params.listId,isOperationShow:!0,isCreateShow:!0,isUpdateShow:!0,showModal:!1,deleteRelationWorkflow:-1,columns:[],workflows:[]}},watch:{isAdmin:function(t){this.setColumns()}},methods:(L={addWorkflow:function(){this.getRelativeWorkflowData()},emitWorkFlowModal:function(){this.showModal=!1},showWorkflowModal:function(){this.showModal=!0},getRelativeWorkflowData:function(){var s=this;Object(c.V)(this.listId).then(function(t){var e=[];s.workflows=t,0<s.workflows.length&&(s.workflows.forEach(function(t){e.push(t.triggerType)}),/create/.test(e)&&/update/.test(e)?(s.isOperationShow=!0,s.isCreateShow=!0,s.isUpdateShow=!0):/create/.test(e)?(s.isOperationShow=!0,s.isCreateShow=!0,s.isUpdateShow=!1):/update/.test(e)?(s.isOperationShow=!0,s.isCreateShow=!1,s.isUpdateShow=!0):s.isOperationShow=!1)})},deleteWorkflow:function(t,e){var s=this;this.$Modal.confirm({title:"确认",content:"确认删除此工作流？",onOk:function(){Object(c.r)(null,null,t.id).then(function(t){t.success&&(s.$Message.success(t.message),s.getRelativeWorkflowData(),s.deleteRelationWorkflow++)})}})}},E()(L,"addWorkflow",function(){this.getRelativeWorkflowData()}),E()(L,"goCreateWorkflow",function(){window.open("/myflow/createWorkFlow.html?listId="+this.listId+"&triggerType=create")}),E()(L,"updateWorkFlowStaus",function(t){var e=this,s=t.row,a="";a=1===s.status?"确认禁用该工作流？":"确认启用该工作流？",this.$Modal.confirm({title:"系统提示",content:a,onOk:function(){1===s.status?Object(c.r)(null,s.id).then(function(t){t.success&&(e.$Message.success(t.message),e.getRelativeWorkflowData())}):Object(c.r)(s.id).then(function(t){t.success&&(e.$Message.success(t.message),e.getRelativeWorkflowData())})},onCancel:function(){e.getRelativeWorkflowData()}})}),E()(L,"createWorkflow",function(t){window.open("/myflow/createWorkFlow.html?listId="+this.listId+"&triggerType="+t)}),E()(L,"setColumns",function(){var s=this,t=[{title:"工作流名称",key:"processName",align:"left"},{title:"触发动作",key:"triggerType",align:"left",render:function(t,e){return"create"===e.row.triggerType?t("span",{},"创建实例"):t("span",{},"修改实例")}},{title:"启用",key:"status",align:"left",render:function(t,e){return t("Checkbox",{props:{value:1===e.row.status,disabled:!s.isAdmin},on:{"on-change":function(t){s.updateWorkFlowStaus(e)}}})}}],e=[{title:"操作",key:"list",align:"center",render:function(t,e){return t("div",[t("a",{on:{click:function(){s.deleteWorkflow(e.row,e.index)}}},"删除"),t("span",{style:{height:"20px",borderLeft:"1px solid #39f",margin:"0px 5px"}}),t("a",{on:{click:function(){window.open("/myflow/viewFlow.html?processId="+e.row.processId+"&listId="+s.listId+"&processCode="+e.row.processCode)}}},"修改")])}}];this.isAdmin?this.columns=t.concat(e):this.columns=t}),L),created:function(){this.setColumns(),this.getRelativeWorkflowData()}},q=s("UFJm"),J=s.n(q);var Z=function(t){s("CWWK")},H=s("VU/8")(K,J.a,!1,Z,"data-v-55fff912",null).exports,Q={name:"permissionModal",components:{UserSelector:h.a,GroupSelector:D,RoleSelector:C},props:{modalStatis:Boolean,modalName:String},data:function(){return{appListId:this.$route.params.listId,emitChange:0,showPermissionModal:!1,isModalDisabled:!0,allPermissionData:[],permissionSelectDatas:[],allPermissionColumns:[],userSelectData:[],orgSelectData:[],departmentSelectData:[],companySelectData:[],showSelector:{showUserSelector:!1,showGroupSelector:!1,showRoleSelector:!1}}},watch:{modalStatis:function(t,e){this.showPermissionModal=t,this.permissionSelectDatas=[],this.showPermissionModal&&this.getData(),this.userSelectData=[],this.orgSelectData=[],this.departmentSelectData=[]},permissionSelectDatas:function(t){0<t.length&&(0<this.userSelectData.length||0<this.orgSelectData.length||0<this.departmentSelectData.length||0<this.companySelectData.length)?this.isModalDisabled=!1:this.isModalDisabled=!0},userSelectData:function(t){0<t.length?0<this.permissionSelectDatas.length?this.isModalDisabled=!1:this.isModalDisabled=!0:(0<this.orgSelectData.length||0<this.departmentSelectData.length)&&0<this.permissionSelectDatas.length?this.isModalDisabled=!1:this.isModalDisabled=!0},orgSelectData:function(t){0<t.length?0<this.permissionSelectDatas.length?this.isModalDisabled=!1:this.isModalDisabled=!0:(0<this.userSelectData.length||0<this.departmentSelectData.length)&&0<this.permissionSelectDatas.length?this.isModalDisabled=!1:this.isModalDisabled=!0},departmentSelectData:function(t){0<t.length?0<this.permissionSelectDatas.length?this.isModalDisabled=!1:this.isModalDisabled=!0:(0<this.orgSelectData.length||0<this.userSelectData.length)&&0<this.permissionSelectDatas.length?this.isModalDisabled=!1:this.isModalDisabled=!0}},methods:{emitUserModal:function(){this.showSelector.showUserSelector=!1},emitGroupModal:function(){this.showSelector.showGroupSelector=!1},emitRoleModal:function(){this.showSelector.showRoleSelector=!1},getUserModalData:function(t){if(0<this.userSelectData.length){var e,s={};(e=this.userSelectData).push.apply(e,u()(t)),this.userSelectData=this.userSelectData.reduce(function(t,e){return!s[e.userId]&&(s[e.userId]=t.push(e)),t},[])}else this.userSelectData=t},getGroupModalData:function(t){if(0<this.orgSelectData.length){var e,s={};(e=this.orgSelectData).push.apply(e,u()(t)),this.orgSelectData=this.orgSelectData.reduce(function(t,e){return!s[e.id]&&(s[e.id]=t.push(e)),t},[])}else this.orgSelectData=t},getRoleModalData:function(t){if(0<this.departmentSelectData.length){var e,s={};(e=this.departmentSelectData).push.apply(e,u()(t)),this.departmentSelectData=this.departmentSelectData.reduce(function(t,e){return!s[e.id]&&(s[e.id]=t.push(e)),t},[])}else this.departmentSelectData=t},cancelAddPermission:function(){this.showPermissionModal=!1},selectUserModal:function(){this.showSelector.showUserSelector=!0},selectGroupModal:function(){this.showSelector.showGroupSelector=!0},selectRoleModal:function(){this.showSelector.showRoleSelector=!0},deleteUser:function(t){var e=this,s=t.target.parentElement.getAttribute("userid"),a=[];this.permissionSelectDatas.forEach(function(t){a.push(t.id)}),Object(c.g)("sys_user_permission",s,a.join(",")).then(function(t){t.success&&(e.userSelectData=e.userSelectData.filter(function(t){return t.userId!=s}),e.userSelection=e.userSelection.filter(function(t){return t.userId!=s}))})},deleteOrg:function(t){var e=this,s=t.target.parentElement.getAttribute("orgid"),a=[];this.permissionSelectDatas.forEach(function(t){a.push(t.id)}),Object(c.g)("sys_group_permission",s,a.join(",")).then(function(t){t.success&&(e.orgSelectData=e.orgSelectData.filter(function(t){return t.id!=s}),e.orgSelection=e.orgSelection.filter(function(t){return t.id!=s}))})},deleteDepartment:function(t,e){var s=this,a=event.target.parentElement.getAttribute("depid"),o=[];this.permissionSelectDatas.forEach(function(t){o.push(t.id)}),Object(c.g)("sys_role_permission",a,o.join(",")).then(function(t){t.success&&(s.departmentSelectData=s.departmentSelectData.filter(function(t){return t.id!=a}),s.departmentSelection=s.departmentSelection.filter(function(t){return t.id!=a}))})},deleteCompany:function(t,e){var s=this,a=event.target.parentElement.getAttribute("comid"),o=[];this.permissionSelectDatas.forEach(function(t){o.push(t.id)}),Object(c.g)("sys_group_permission",a,o.join(",")).then(function(t){t.success&&(s.companySelectData=s.companySelectData.filter(function(t){return t.groupId!=a}),s.companySelectData=s.companySelectData.filter(function(t){return t.groupId!=a}))})},permissionSelectChange:function(t,e){this.permissionSelectDatas=t},submitPermission:function(){var s=this,t=this.userSelectData.map(function(t){return t.userId}),e=this.orgSelectData.map(function(t){return t.id}),a=this.departmentSelectData.map(function(t){return t.id}),o=this.companySelectData.map(function(t){return t.groupId}),i=this.permissionSelectDatas.map(function(t){return t.id}),n={userId:t.join(","),roleId:a.join(","),groupId:e.join(","),companyId:o.join(","),permissionId:i.join(",")};Object(c.c)(n).then(function(t){if(t.success){s.$Message.success(t.message),s.showPermissionModal=!1;var e=s.emitChange++;s.$emit("reGetData",e)}})},modalVisibleChange:function(t){t||this.$emit("emitPermissionModal",{modal:!1})},getData:function(){var t=this.appListId;"action"===this.modalName?(this.allPermissionColumns=[{type:"selection",width:60,align:"center"},{title:"动作名称",key:"name",width:100},{title:"说明",key:"desc"}],this.getActionPerData(t)):(this.allPermissionColumns=[{type:"selection",width:60,align:"center"},{title:"数据源名称",key:"name",width:100},{title:"说明",key:"desc"}],this.getResPerData(t))},getActionPerData:function(t){var e=this;Object(c.w)(t).then(function(t){e.allPermissionData=t.tableContent,e.allPermissionData.map(function(t){t.desc=a.a[t.resourceName]})})},getResPerData:function(t){var e=this;Object(c.y)(t).then(function(t){e.allPermissionData=t.tableContent,e.allPermissionData.map(function(t){t.desc=a.a[t.resourceName]})})}},mounted:function(){this.getData()}},X=s("aAio"),Y=s.n(X);var tt=function(t){s("LKb9")},et=s("VU/8")(Q,Y.a,!1,tt,null,null).exports,st={name:"permissionSource",components:{ActionModal:et},props:{isAdmin:Boolean},data:function(){return{listId:this.$route.params.listId,showActionModal:!1,isModalConfirm:1e3,actionData:[],modalName:"action",columns:[],userSources:[]}},watch:{isModalConfirm:function(){this.getActionData()},isAdmin:function(t){this.setColumns()}},methods:{reGetData:function(t){this.isModalConfirm=t},showModal:function(){this.editActionData={},this.showActionModal=!0,this.isEdit=""},emitPermissionModal:function(){this.showActionModal=!1},getActionData:function(){var e=this;Object(c.C)("action",this.listId).then(function(t){e.userSources=t.tableContent})},deleteAllPermission:function(n,t){var r=this,l=this;l.$Modal.confirm({title:"确认",content:"确认删除此权限？",onOk:function(){var t,s=[],e=[],a=[],o=[],i=[];n.row.action.forEach(function(t){for(var e in t)s.push(e)}),n.row.objNames.forEach(function(t){"user"===t.type?e.push(t.id):"group"===t.type?a.push(t.id):"role"===t.type?o.push(t.id):i.push(t.id)}),t={user:e.join(","),group:a.join(","),role:o.join(","),company:i.join(","),multi:s.join(",")},Object(c.p)(t).then(function(t){t.success&&(l.$Message.success(t.message),r.getActionData())})}})},setColumns:function(){var l=this,t=[{title:"已授权用户、组织或职位",key:"objNames",width:200,render:function(a,t){var e=t.row.objNames,o=[];if(0<e.length)return e.forEach(function(t,e){var s;s=a("span",{},t.name+"; "),o.push(s)}),a("div",o)}},{title:"动作",key:"source",render:function(o,n){var t=n.row.action,i=[],r=[];return t.forEach(function(t,e){for(var s in t)r.push(s)}),l.actionData.forEach(function(e,t){var s,a=void 0;r.forEach(function(t){t==e.id&&(a=e.id)}),s=o("span",{style:{marginLeft:"5px"}},[o("Checkbox",{props:{value:a,trueValue:e.id,falseValue:e.id+"_false",disabled:!l.isAdmin},on:{"on-change":function(t){var e=void 0,s=void 0,a=void 0,o=void 0,i=void 0;"sys_role_permission"===n.row.list?a=n.row.objId:"sys_user_permission"===n.row.list?e=n.row.objId:"sys_group_permission"===n.row.list?s=n.row.objId:o=n.row.objId,/_/.test(t)?(i=0,t=t.split("_")[0]):i=1,Object(c._26)(e,a,s,o,t,l.listId,i).then(function(t){t.success&&l.$Message.success(t.message)})}}}),o("span",{},e.name)]),i.push(s)}),o("div",i)}}],e=[{title:"操作",key:"list",align:"center",render:function(t,e){return t("div",[t("a",{on:{click:function(){l.deleteAllPermission(e,e.row.list)}}},"删除")])}}];this.isAdmin?this.columns=t.concat(e):this.columns=t}},created:function(){var e=this;Object(c.w)(this.listId).then(function(t){e.actionData=t.tableContent})},mounted:function(){this.setColumns(),this.getActionData()}},at=s("iutk"),ot=s.n(at);var it=function(t){s("GEJ2")},nt=s("VU/8")(st,ot.a,!1,it,"data-v-d10ce878",null).exports,rt={name:"permissionSourceData",components:{ActionModal:et},props:{isAdmin:Boolean},data:function(){return{listId:this.$route.params.listId,showActionModal:!1,isModalConfirm:1e3,resourceData:[],modalName:"resource",columns:[],userSources:[]}},watch:{isModalConfirm:function(){this.getResourceData()},isAdmin:function(t){this.setColumns()}},methods:{reGetData:function(t){this.isModalConfirm=t},showModal:function(){this.editActionData={},this.showActionModal=!0,this.isEdit=""},emitPermissionModal:function(){this.showActionModal=!1},getResourceData:function(){var e=this;Object(c.C)("resource",this.listId).then(function(t){e.userSources=t.tableContent})},deleteAllPermission:function(n,t){var r=this,l=this;l.$Modal.confirm({title:"确认",content:"确认删除此权限？",onOk:function(){var t,s=[],e=[],a=[],o=[],i=[];n.row.resource.forEach(function(t){for(var e in t)s.push(e)}),n.row.objNames.forEach(function(t){"user"===t.type?e.push(t.id):"group"===t.type?a.push(t.id):"role"===t.type?o.push(t.id):i.push(t.id)}),t={user:e.join(","),group:a.join(","),role:o.join(","),company:i.join(","),multi:s.join(",")},Object(c.p)(t).then(function(t){t.success&&(l.$Message.success(t.message),r.getResourceData())})}})},setColumns:function(){var l=this,t=[{title:"已授权用户、用户组",key:"objNames",width:200,render:function(a,t){var e=t.row.objNames,o=[];if(0<e.length)return e.forEach(function(t,e){var s;s=a("span",{},t.name+"; "),o.push(s)}),a("div",o)}},{title:"数据源",key:"source",render:function(o,n){var t=n.row.resource,i=[],r=[];return t.forEach(function(t,e){for(var s in t)r.push(s)}),l.resourceData.forEach(function(e,t){var s,a=void 0;r.forEach(function(t){t==e.id&&(a=e.id)}),s=o("span",{style:{marginLeft:"10px"}},[o("Checkbox",{props:{value:a,trueValue:e.id,falseValue:e.id+"_false",disabled:!l.isAdmin},on:{"on-change":function(t){var e=void 0,s=void 0,a=void 0,o=void 0,i=void 0;"sys_role_permission"===n.row.list?a=n.row.objId:"sys_user_permission"===n.row.list?e=n.row.objId:"sys_group_permission"===n.row.list?s=n.row.objId:o=n.row.objId,/_/.test(t)?(i=0,t=t.split("_")[0]):i=1,Object(c._26)(e,a,s,o,t,l.listId,i).then(function(t){t.success&&l.$Message.success(t.message)})}}}),o("span",{},e.name)]),i.push(s)}),o("div",i)}}],e=[{title:"操作",key:"list",align:"center",render:function(t,e){return t("div",[t("a",{on:{click:function(){l.deleteAllPermission(e,e.row.list)}}},"删除")])}}];this.isAdmin?this.columns=t.concat(e):this.columns=t}},created:function(){var e=this;Object(c.y)(this.listId).then(function(t){e.resourceData=t.tableContent})},mounted:function(){this.setColumns(),this.getResourceData()}},lt=s("l2sK"),ct=s.n(lt);var dt=function(t){s("FWQ/")},ut=s("VU/8")(rt,ct.a,!1,dt,"data-v-0aa04632",null).exports,ht={name:"permissionModal",components:{UserSelector:h.a,GroupSelector:D,RoleSelector:C},props:{modalStatis:Boolean,resourceId:String,isEdit:Boolean},data:function(){var o=this;return{appListId:this.$route.params.listId,emitChange:0,showPermissionModal:!1,isModalDisabled:!0,fieldData:[],allFieldData:[],fieldColumns:[{title:"字段",key:"fieldName",render:function(e,s){var a=[];return o.allFieldData.forEach(function(t){a.push(e("Option",{props:{value:t.fieldCode,parentCode:t.parentCode}},t.fieldName))}),e("div",[e("Select",{props:{value:s.row.fieldCode},on:{"on-change":function(t){o.fieldData[s.index].fieldCode=t}}},a)])}},{title:"规则",key:"rule",render:function(e,s){var a=[];return[{name:"大于",value:"gt"},{name:"小于",value:"lt"},{name:"等于",value:"eq"},{name:"小于等于",value:"le"},{name:"大于等于",value:"ge"},{name:"不等于",value:"ne"},{name:"包含",value:"like"},{name:"不包含",value:"nlike"}].forEach(function(t){a.push(e("Option",{props:{value:t.value}},t.name))}),e("div",[e("Select",{props:{value:s.row.operator},on:{"on-change":function(t){o.fieldData[s.index].operator=t}}},a)])}},{title:"值",key:"value",render:function(t,e){return t("div",[t("Input",{props:{value:e.row.value},on:{"on-blur":function(t){o.fieldData[e.index].value=t.target.value}}})])}},{title:"且/或",key:"or",render:function(e,s){var a=[];return[{name:"且",value:"and"},{name:"或",value:"or"}].forEach(function(t){a.push(e("Option",{props:{value:t.value}},t.name))}),e("div",[e("Select",{props:{value:s.row.logicOperator},on:{"on-change":function(t){o.fieldData[s.index].logicOperator=t}}},a)])}},{title:"操作",key:"list",align:"center",render:function(t,e){return t("Button",{props:{type:"error",size:"small"},on:{click:function(){o.fieldData.splice(e.index,1)}}},"删除")}}],userSelectData:[],orgSelectData:[],departmentSelectData:[],companySelectData:[],showSelector:{showUserSelector:!1,showGroupSelector:!1,showRoleSelector:!1}}},watch:{modalStatis:function(t,e){var s=this;this.isEdit?(this.userSelectData=[],this.orgSelectData=[],this.departmentSelectData=[],Object(c.Z)(this.appListId,this.resourceId).then(function(t){s.fieldData=t.resource,t.instance.forEach(function(t){var e={};"U"===t.substanceType?(e.nickname=t.substanceName,e.userId=t.substanceId,s.userSelectData.push(e)):"G"===t.substanceType?(e.name=t.substanceName,e.id=t.substanceId,s.orgSelectData.push(e)):"R"===t.substanceType&&(e.name=t.substanceName,e.id=t.substanceId,s.departmentSelectData.push(e))})})):(this.fieldData=[],this.userSelectData=[],this.orgSelectData=[],this.departmentSelectData=[]),this.showPermissionModal=t},fieldData:function(t){0<t.length&&(0<this.userSelectData.length||0<this.orgSelectData.length||0<this.departmentSelectData.length||0<this.companySelectData.length)?this.isModalDisabled=!1:this.isModalDisabled=!0},userSelectData:function(t){0<t.length?0<this.fieldData.length?this.isModalDisabled=!1:this.isModalDisabled=!0:(0<this.orgSelectData.length||0<this.departmentSelectData.length)&&0<this.fieldData.length?this.isModalDisabled=!1:this.isModalDisabled=!0},orgSelectData:function(t){0<t.length?0<this.fieldData.length?this.isModalDisabled=!1:this.isModalDisabled=!0:(0<this.userSelectData.length||0<this.departmentSelectData.length)&&0<this.fieldData.length?this.isModalDisabled=!1:this.isModalDisabled=!0},departmentSelectData:function(t){0<t.length?0<this.fieldData.length?this.isModalDisabled=!1:this.isModalDisabled=!0:(0<this.orgSelectData.length||0<this.userSelectData.length)&&0<this.fieldData.length?this.isModalDisabled=!1:this.isModalDisabled=!0}},methods:{emitUserModal:function(){this.showSelector.showUserSelector=!1},emitGroupModal:function(){this.showSelector.showGroupSelector=!1},emitRoleModal:function(){this.showSelector.showRoleSelector=!1},addNewField:function(){this.fieldData.push({fieldName:"",parentCode:"",fieldCode:"",operator:"",value:"",logicOperator:""})},cancelAddPermission:function(){this.showPermissionModal=!1},submitPermission:function(){var s=this,t=this.userSelectData.map(function(t){return t.userId}),e=this.orgSelectData.map(function(t){return t.id}),a=this.departmentSelectData.map(function(t){return t.id}),o=(this.companySelectData.map(function(t){return t.groupId}),{user:t,role:a,group:e,listId:this.appListId,resourceId:this.resourceId,resource:this.fieldData});this.isEdit?Object(c._24)(m()(o)).then(function(t){if(t.success){s.$Message.success(t.message),s.showPermissionModal=!1;var e=s.emitChange++;s.$emit("reGetData",e)}}).catch(function(t){s.$Message.error(t.data.message)}):Object(c._10)(m()(o)).then(function(t){if(t.success){s.$Message.success(t.message),s.showPermissionModal=!1;var e=s.emitChange++;s.$emit("reGetData",e)}}).catch(function(t){s.$Message.error(t.data.message)})},modalVisibleChange:function(t){t||this.$emit("emitPermissionModal",{modal:!1})},selectUserModal:function(){this.showSelector.showUserSelector=!0},selectGroupModal:function(){this.showSelector.showGroupSelector=!0},selectRoleModal:function(){this.showSelector.showRoleSelector=!0},getUserModalData:function(t){if(0<this.userSelectData.length){var e,s={};(e=this.userSelectData).push.apply(e,u()(t)),this.userSelectData=this.userSelectData.reduce(function(t,e){return!s[e.userId]&&(s[e.userId]=t.push(e)),t},[])}else this.userSelectData=t},getGroupModalData:function(t){if(0<this.orgSelectData.length){var e,s={};(e=this.orgSelectData).push.apply(e,u()(t)),this.orgSelectData=this.orgSelectData.reduce(function(t,e){return!s[e.id]&&(s[e.id]=t.push(e)),t},[])}else this.orgSelectData=t},getRoleModalData:function(t){if(0<this.departmentSelectData.length){var e,s={};(e=this.departmentSelectData).push.apply(e,u()(t)),this.departmentSelectData=this.departmentSelectData.reduce(function(t,e){return!s[e.id]&&(s[e.id]=t.push(e)),t},[])}else this.departmentSelectData=t},deleteUser:function(t){var e=t.target.parentElement.getAttribute("userid");this.userSelectData=this.userSelectData.filter(function(t){return t.userId!=e})},deleteOrg:function(t){var e=t.target.parentElement.getAttribute("orgid");this.orgSelectData=this.orgSelectData.filter(function(t){return t.id!=e})},deleteDepartment:function(t,e){var s=event.target.parentElement.getAttribute("depid");this.departmentSelectData=this.departmentSelectData.filter(function(t){return t.id!=s})}},created:function(){var e=this;Object(c.M)(this.appListId).then(function(t){e.allFieldData=t})},mounted:function(){}},pt=s("sJK6"),mt=s.n(pt);var ft=function(t){s("AyIr")},gt={name:"CustomDatasource",components:{CustomDatasourceModal:s("VU/8")(ht,mt.a,!1,ft,null,null).exports},props:{isAdmin:Boolean},data:function(){return{listId:this.$route.params.listId,isEdit:!1,resourceId:"",showActionModal:!1,isModalConfirm:1e3,actionData:[],modalName:"action",columns:[],userSources:[]}},watch:{isModalConfirm:function(){this.getResourceData()},isAdmin:function(t){this.setColumns()}},methods:{reGetData:function(t){this.isModalConfirm=t},showModal:function(){this.editActionData={},this.showActionModal=!0,this.isEdit=!1},emitPermissionModal:function(){this.showActionModal=!1},getResourceData:function(){var e=this;Object(c.Y)(this.listId).then(function(t){e.userSources=t})},deleteDataSource:function(t){var e=this;this.$Modal.confirm({title:"确认",content:"确认删除此数据源权限？",onOk:function(){Object(c.l)(t).then(function(t){t.success&&(e.$Message.success(t.message),e.getResourceData())})}})},setColumns:function(){var s=this,t=[{title:"字段过滤",key:"expression",width:200,render:function(e,t){var s=t.row.expression.split("br"),a=[];return s.forEach(function(t){a.push(e("div",{},t))}),e("div",a)}},{title:"已授权用户、组织或职位",key:"instance"}],e=[{title:"操作",key:"list",align:"center",render:function(t,e){return t("div",[t("a",{on:{click:function(){s.deleteDataSource(e.row.resourceId)}}},"删除"),t("span",{style:{height:"20px",borderLeft:"1px solid #39f",margin:"0px 5px"}}),t("a",{on:{click:function(){s.isEdit=!0,s.resourceId=e.row.resourceId,s.showActionModal=!0}}},"修改")])}}];this.isAdmin?this.columns=t.concat(e):this.columns=t}},created:function(){},mounted:function(){this.setColumns(),this.getResourceData()}},vt=s("wcdk"),wt=s.n(vt);var Dt=function(t){s("Ryk5")},St=s("VU/8")(gt,wt.a,!1,Dt,"data-v-77ebaeff",null).exports,bt={name:"FieldModal",components:{UserSelector:h.a,GroupSelector:D,RoleSelector:C},props:{modalStatis:Boolean,resourceId:String,isEdit:Boolean,row:Object},data:function(){var s=this;return{appListId:this.$route.params.listId,modalTitle:"字段或字段组权限",emitChange:0,showPermissionModal:!1,isModalDisabled:!0,isBlack:!0,fieldData:[],allFieldData:[],fieldColumns:[{title:"字段",slot:"fieldName"},{title:"操作",key:"list",align:"center",render:function(t,e){return t("Button",{props:{type:"error",size:"small"},on:{click:function(){s.fieldData.splice(e.index,1)}}},"删除")}}],userSelectData:[],orgSelectData:[],departmentSelectData:[],companySelectData:[],showSelector:{showUserSelector:!1,showGroupSelector:!1,showRoleSelector:!1}}},watch:{modalStatis:function(t,e){var s=this;this.isEdit?(this.userSelectData=[],this.orgSelectData=[],this.departmentSelectData=[],this.row?Object(c.H)(this.row.calcRelCode,this.resourceId).then(function(t){s.fieldData=t.data.resource,t.data.instance.forEach(function(t){var e={};"U"===t.objectType?(e.nickname=t.objectName,e.userId=t.objectId,s.userSelectData.push(e)):"G"===t.objectType?(e.name=t.objectName,e.id=t.objectId,s.orgSelectData.push(e)):"R"===t.objectType&&(e.name=t.objectName,e.id=t.objectId,s.departmentSelectData.push(e))})}):Object(c.N)(this.appListId,this.resourceId).then(function(t){s.fieldData=t.resource,t.instance.forEach(function(t){var e={};"U"===t.substanceType?(e.nickname=t.substanceName,e.userId=t.substanceId,s.userSelectData.push(e)):"G"===t.substanceType?(e.name=t.substanceName,e.id=t.substanceId,s.orgSelectData.push(e)):"R"===t.substanceType&&(e.name=t.substanceName,e.id=t.substanceId,s.departmentSelectData.push(e))})})):(this.fieldData=[],this.userSelectData=[],this.orgSelectData=[],this.departmentSelectData=[]),this.showPermissionModal=t},fieldData:function(t){0<t.length?(this.isBlack=t[0].isBlacklist,0<this.userSelectData.length||0<this.orgSelectData.length||0<this.departmentSelectData.length||0<this.companySelectData.length?this.isModalDisabled=!1:this.isModalDisabled=!0):(this.isBlack=!0,this.isModalDisabled=!0)},userSelectData:function(t){0<t.length?0<this.fieldData.length?this.isModalDisabled=!1:this.isModalDisabled=!0:(0<this.orgSelectData.length||0<this.departmentSelectData.length)&&0<this.fieldData.length?this.isModalDisabled=!1:this.isModalDisabled=!0},orgSelectData:function(t){0<t.length?0<this.fieldData.length?this.isModalDisabled=!1:this.isModalDisabled=!0:(0<this.userSelectData.length||0<this.departmentSelectData.length)&&0<this.fieldData.length?this.isModalDisabled=!1:this.isModalDisabled=!0},departmentSelectData:function(t){0<t.length?0<this.fieldData.length?this.isModalDisabled=!1:this.isModalDisabled=!0:(0<this.orgSelectData.length||0<this.userSelectData.length)&&0<this.fieldData.length?this.isModalDisabled=!1:this.isModalDisabled=!0},isChildSubject:function(t){this.modalTitle=t?"子科目权限":"字段或字段组权限"}},methods:{fieldSelectChange:function(t,e){this.fieldData[e].fieldCode=t},emitUserModal:function(){this.showSelector.showUserSelector=!1},emitGroupModal:function(){this.showSelector.showGroupSelector=!1},emitRoleModal:function(){this.showSelector.showRoleSelector=!1},addNewField:function(){this.fieldData.push({fieldName:"",isBlacklist:this.isBlack,fieldCode:""})},cancelAddPermission:function(){this.showPermissionModal=!1},changeBlackWhiteList:function(t){t?this.fieldData.forEach(function(t){t.isBlacklist=!0}):this.fieldData.forEach(function(t){t.isBlacklist=!1})},submitPermission:function(){var s=this,t=this.userSelectData.map(function(t){return t.userId}),e=this.orgSelectData.map(function(t){return t.id}),a=this.departmentSelectData.map(function(t){return t.id}),o=(this.companySelectData.map(function(t){return t.groupId}),{user:t,role:a,group:e,listId:this.appListId,resourceId:this.resourceId,resource:this.fieldData});if(this.row){for(var i in o)delete o.listId;o.calcRelCode=this.row.calcRelCode}o&&(this.isEdit?this.row?Object(c._23)(m()(o)).then(function(t){if(t.success){s.$Message.success(t.message),s.showPermissionModal=!1;var e=s.emitChange++;s.$emit("reGetData",e)}}).catch(function(t){s.$Message.error(t.data.message)}):Object(c._25)(m()(o)).then(function(t){if(t.success){s.$Message.success(t.message),s.showPermissionModal=!1;var e=s.emitChange++;s.$emit("reGetData",e)}}).catch(function(t){s.$Message.error(t.data.message)}):this.row?Object(c._8)(m()(o)).then(function(t){if(t.success){s.$Message.success(t.message),s.showPermissionModal=!1;var e=s.emitChange++;s.$emit("reGetData",e)}}).catch(function(t){s.$Message.error(t.data.message)}):Object(c._12)(m()(o)).then(function(t){if(t.success){s.$Message.success(t.message),s.showPermissionModal=!1;var e=s.emitChange++;s.$emit("reGetData",e)}}).catch(function(t){s.$Message.error(t.data.message)}))},modalVisibleChange:function(t){t||this.$emit("emitPermissionModal",{modal:!1})},selectUserModal:function(){this.showSelector.showUserSelector=!0},selectGroupModal:function(){this.showSelector.showGroupSelector=!0},selectRoleModal:function(){this.showSelector.showRoleSelector=!0},getUserModalData:function(t){if(0<this.userSelectData.length){var e,s={};(e=this.userSelectData).push.apply(e,u()(t)),this.userSelectData=this.userSelectData.reduce(function(t,e){return!s[e.userId]&&(s[e.userId]=t.push(e)),t},[])}else this.userSelectData=t},getGroupModalData:function(t){if(0<this.orgSelectData.length){var e,s={};(e=this.orgSelectData).push.apply(e,u()(t)),this.orgSelectData=this.orgSelectData.reduce(function(t,e){return!s[e.id]&&(s[e.id]=t.push(e)),t},[])}else this.orgSelectData=t},getRoleModalData:function(t){if(0<this.departmentSelectData.length){var e,s={};(e=this.departmentSelectData).push.apply(e,u()(t)),this.departmentSelectData=this.departmentSelectData.reduce(function(t,e){return!s[e.id]&&(s[e.id]=t.push(e)),t},[])}else this.departmentSelectData=t},deleteUser:function(t){var e=t.target.parentElement.getAttribute("userid");this.userSelectData=this.userSelectData.filter(function(t){return t.userId!=e})},deleteOrg:function(t){var e=t.target.parentElement.getAttribute("orgid");this.orgSelectData=this.orgSelectData.filter(function(t){return t.id!=e})},deleteDepartment:function(t,e){var s=event.target.parentElement.getAttribute("depid");this.departmentSelectData=this.departmentSelectData.filter(function(t){return t.id!=s})}},created:function(){var e=this;this.row?Object(c.I)(this.row.calcRelCode).then(function(t){t.success&&(e.allFieldData=t.data)}):Object(c.Q)(this.appListId).then(function(t){e.allFieldData=t})},mounted:function(){}},Mt=s("m0bS"),_t=s.n(Mt);var Ct=function(t){s("N94I")},kt={name:"FieldPermission",components:{FieldModal:s("VU/8")(bt,_t.a,!1,Ct,null,null).exports},props:{isAdmin:Boolean,row:Object},data:function(){return{listId:this.$route.params.listId,isEdit:!1,resourceId:"",showActionModal:!1,isChildSubject:!1,isModalConfirm:1e3,actionData:[],modalName:"action",columns:[],userSources:[]}},watch:{isModalConfirm:function(){this.getFieldListData()},isAdmin:function(t){this.setColumns()}},methods:{reGetData:function(t){this.isModalConfirm=t},showModal:function(){this.editActionData={},this.showActionModal=!0,this.isEdit=!1},emitPermissionModal:function(){this.showActionModal=!1},getFieldListData:function(){var e=this;this.row?Object(c.P)(this.row.calcRelCode).then(function(t){t.success&&(e.userSources=t.data)}):Object(c.O)(this.listId).then(function(t){e.userSources=t})},deleteFieldSource:function(t){var e=this;this.$Modal.confirm({title:"确认",content:"确认删除此数据源权限？",onOk:function(){e.row?Object(c.n)(t).then(function(t){t.success&&(e.$Message.success(t.message),e.getFieldListData())}).catch(function(t){e.$Message.error(t.data.message)}):Object(c.m)(t).then(function(t){t.success&&(e.$Message.success(t.message),e.getFieldListData())}).catch(function(t){e.$Message.error(t.data.message)})}})},setColumns:function(){var s=this,t=[{title:"字段或字段组",key:"fields",width:200,render:function(e,t){var s=t.row.fields.split("br"),a=[];return s.forEach(function(t){a.push(e("div",{},t))}),e("div",a)}},{title:"已授权用户、组织或职位",key:"instance"},{title:"名单类型",key:"isBlacklist",render:function(t,e){var s="黑名单";return e.row.isBlacklist||(s="白名单"),t("span",{},s)}}],e=[{title:"操作",key:"list",align:"center",render:function(t,e){return t("div",[t("a",{on:{click:function(){s.deleteFieldSource(e.row.resourceId)}}},"删除"),t("span",{style:{height:"20px",borderLeft:"1px solid #39f",margin:"0px 5px"}}),t("a",{on:{click:function(){s.isEdit=!0,s.resourceId=e.row.resourceId,s.showActionModal=!0}}},"修改")])}}];this.isAdmin?this.columns=t.concat(e):this.columns=t}},created:function(){},mounted:function(){this.setColumns(),this.getFieldListData()}},yt=s("6tFH"),It=s.n(yt);var Rt=function(t){s("ZDyq")},At=s("VU/8")(kt,It.a,!1,Rt,"data-v-a7b270ec",null).exports,Pt={name:"ChildSubject",components:{FieldPermission:At},props:{isAdmin:Boolean},data:function(){var a=this;return{listId:this.$route.params.listId,subjectData:[],columns:[{type:"expand",width:50,render:function(t,e){return t(At,{props:{row:e.row,isAdmin:a.isAdmin}})}},{title:"子科目名称",key:"calcRelName"},{title:"状态",key:"status",render:function(t,e){var s=!1;return 1===e.accountType&&(s=!0),a.isAdmin||(s=!0),t("Checkbox",{props:{value:1===e.row.status,disabled:s},on:{"on-change":function(t){t?Object(c._19)(e.row.calcRelCode).then(function(t){t.success?a.$Message.success(t.message):a.$Message.error(t.message)}):Object(c.e)(e.row.calcRelCode).then(function(t){t.success?a.$Message.success(t.message):a.$Message.error(t.message)})}}},"启用")}}]}},methods:{getChildSubjectData:function(){var e=this;Object(c._0)(this.listId).then(function(t){t.success&&(e.subjectData=t.obj)}).catch(function(t){e.$Message.error(t.data.message)})}},mounted:function(){this.getChildSubjectData()}},jt=s("0RZk"),xt=s.n(jt);var Ot=function(t){s("ktW4")},Ft=s("VU/8")(Pt,xt.a,!1,Ot,"data-v-3c2775b8",null).exports,$t={name:"permissionSource",components:{OperationManage:l,ReportView:O,AppForm:G,WorkFlow:H,ActionManage:nt,PermissionDataSource:ut,CustomDatasource:St,FieldPermission:At,ChildSubject:Ft},props:{listId:String,appType:String,enabledForbidden:Number,isAdmin:Boolean,isAddress:Boolean},data:function(){return{}},mounted:function(){}},Wt=s("QzSZ"),Tt=s.n(Wt);var Gt=function(t){s("FYMv")},Ut=s("VU/8")($t,Tt.a,!1,Gt,"data-v-04e40f54",null);e.default=Ut.exports},"6tFH":function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app",staticStyle:{"margin-top":"15px"}},[s("Row",{staticClass:"app-action"},[t.row?t._e():s("Row",{staticClass:"app-action-title"},[s("h3",[t._v("字段或字段组"),t.isAdmin?s("a",{staticClass:"app-action-title-add",on:{click:t.showModal}},[t._v("添加")]):t._e()]),t._v(" "),s("span",{staticClass:"warning-color marlr"},[t._v("应用字段授权给用户或用户组")])]),t._v(" "),s("div",{class:{"app-action-source":!t.row}},[t.isAdmin&&t.row?s("h3",{staticClass:"app-action-title-add",on:{click:t.showModal}},[s("Icon",{attrs:{type:"md-add"}}),t._v("添加")],1):t._e(),t._v(" "),s("Row",[s("Table",{attrs:{columns:t.columns,data:t.userSources,size:"small"}})],1)],1)],1),t._v(" "),s("field-modal",{attrs:{modalStatis:t.showActionModal,isEdit:t.isEdit,row:t.row,resourceId:t.resourceId},on:{reGetData:t.reGetData,emitPermissionModal:t.emitPermissionModal}})],1)},staticRenderFns:[]}},AyIr:function(t,e){},B23i:function(t,e){t.exports={render:function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("Modal",{attrs:{transfer:!1,title:"视图权限",width:"600","mask-closable":!1},on:{"on-visible-change":s.modalVisibleChange},model:{value:s.showPermissionModal,callback:function(t){s.showPermissionModal=t},expression:"showPermissionModal"}},[a("div",[a("Row",{staticStyle:{"margin-bottom":"10px"},attrs:{gutter:8}},[a("Col",{attrs:{span:"8"}},[a("Button",{attrs:{type:"info",shape:"circle"},on:{click:s.selectUserModal}},[s._v("选择用户")])],1),s._v(" "),a("Col",{attrs:{span:"8"}},[a("Button",{attrs:{type:"info",shape:"circle"},on:{click:s.selectGroupModal}},[s._v("选择组织")])],1),s._v(" "),a("Col",{attrs:{span:"8"}},[a("Button",{attrs:{type:"info",shape:"circle"},on:{click:s.selectRoleModal}},[s._v("选择职位")])],1)],1),s._v(" "),a("Row",{attrs:{gutter:8}},[a("Col",{staticClass:"permission-tab",attrs:{span:"24"}},[a("Row",{staticStyle:{"margin-top":"10px"}},[a("Col",{attrs:{span:"3"}},[a("b",{staticClass:"permission-title"},[s._v("用户")])]),s._v(" "),a("Col",{staticClass:"member-body",attrs:{span:"21"}},s._l(s.userSelectData,function(t,e){return a("Tag",{key:e,attrs:{userId:t.userId,closable:"",color:"warning"},on:{"on-close":s.deleteUser}},[s._v("\n          "+s._s(t.nickname)+"\n        ")])}))],1),s._v(" "),a("Row",{staticClass:"permission-line"}),s._v(" "),a("Row",[a("Col",{attrs:{span:"3"}},[a("b",{staticClass:"permission-title"},[s._v("组织")])]),s._v(" "),a("Col",{staticClass:"member-body",attrs:{span:"21"}},s._l(s.orgSelectData,function(t,e){return a("Tag",{key:e,attrs:{orgId:t.id,closable:"",color:"success"},on:{"on-close":s.deleteOrg}},[s._v("\n          "+s._s(t.name)+"\n        ")])}))],1),s._v(" "),a("Row",{staticClass:"permission-line"}),s._v(" "),a("Row",[a("Col",{attrs:{span:"3"}},[a("b",{staticClass:"permission-title"},[s._v("职位")])]),s._v(" "),a("Col",{staticClass:"member-body",attrs:{span:"21"}},s._l(s.departmentSelectData,function(t,e){return a("Tag",{key:e,attrs:{depId:t.id,closable:"",color:"primary"},on:{"on-close":s.deleteDepartment}},[s._v("\n          "+s._s(t.name)+"\n        ")])}))],1)],1)],1),s._v(" "),a("user-selector",{attrs:{showUserSelector:s.showSelector.showUserSelector},on:{emitUserModal:s.emitUserModal,userModalData:s.getUserModalData}}),s._v(" "),a("group-selector",{attrs:{showGroupSelector:s.showSelector.showGroupSelector},on:{emitGroupModal:s.emitGroupModal,groupModalData:s.getGroupModalData}}),s._v(" "),a("role-selector",{attrs:{showRoleSelector:s.showSelector.showRoleSelector},on:{emitRoleModal:s.emitRoleModal,roleModalData:s.getRoleModalData}})],1),s._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"default"},on:{click:s.cancelAddPermission}},[s._v("取消")]),s._v(" "),a("Button",{attrs:{type:"primary",disabled:s.isModalDisabled},on:{click:s.submitPermission}},[s._v("确定")])],1)])},staticRenderFns:[]}},CWWK:function(t,e){},"FWQ/":function(t,e){},FYMv:function(t,e){},FxqG:function(t,e){},GEJ2:function(t,e){},JfmC:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app-report"},[s("Row",{staticClass:"app-report-title"},[s("h3",[t._v("报表 "),t.isAdmin&&"subject"!=t.appType?s("a",{on:{click:t.goCreateView}},[t._v("添加报表")]):t._e()]),t._v(" "),s("span",{staticClass:"warning-color marlr"},[t._v("用户默认拥有此应用默认报表的权限")])]),t._v(" "),s("Row",{staticClass:"app-report-table"},[s("Table",{attrs:{columns:t.columns,data:t.reportSources,size:"small"}})],1),t._v(" "),s("report-modal",{attrs:{modalStatis:t.showReportModal,permissionId:t.permissionId,permissionData:t.permissionData},on:{emitPermissionModal:t.emitPermissionModal,reGetData:t.reGetData}})],1)},staticRenderFns:[]}},LKb9:function(t,e){},LSpa:function(t,e){t.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Modal",{attrs:{title:"工作流设置",width:"1010","mask-closable":!1,styles:{top:"20px"}},on:{"on-ok":e.selectWorkFlow,"on-visible-change":e.modalVisibleChange},model:{value:e.showWorkFlow,callback:function(t){e.showWorkFlow=t},expression:"showWorkFlow"}},[s("Row",{attrs:{gutter:8}},[s("Col",{attrs:{span:"12"}},[s("div",{staticClass:"flow-title"},[s("b",[e._v("所有工作流")]),e._v(" "),s("div",{staticClass:"app-search"},[s("Input",{staticStyle:{width:"300px"},attrs:{search:!0,placeholder:"搜索工作流名称"},on:{"on-search":e.workflowFilter},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}})],1)]),e._v(" "),s("Table",{attrs:{loading:e.loadingAll,stripe:"",height:"350",columns:e.allWorkFlowColumns,data:e.allWorkFlowData},on:{"on-row-dblclick":e.addWorkflowData}}),e._v(" "),s("div",{staticClass:"workflow-page"},[s("div",{staticStyle:{float:"right"}},[s("Page",{attrs:{total:e.allWorkFlowTotal,current:e.allCurrentPage,"page-size":e.pageSize,size:"small","show-total":""},on:{"on-change":e.onPageChange}})],1)])],1),e._v(" "),s("Col",{attrs:{span:"12"}},[s("div",{staticClass:"flow-title"},[s("b",[e._v("已关联的工作流")])]),e._v(" "),s("Table",{attrs:{loading:e.loadingRelative,stripe:"",height:"350",columns:e.relativeWorkFlowColumns,data:e.relativeWorkFlowData}}),e._v(" "),s("div",{staticClass:"workflow-page"},[s("div",{staticStyle:{float:"right"}},[s("Page",{attrs:{total:e.relativeWorkFlowTotal,current:e.relativeCurrentPage,"page-size":e.pageSize,size:"small","show-total":""},on:{"on-change":e.onRelativePageChange}})],1)])],1)],1)],1)},staticRenderFns:[]}},N94I:function(t,e){},Ogty:function(t,e){t.exports={render:function(){var a=this,t=a.$createElement,o=a._self._c||t;return o("div",[o("Modal",{attrs:{title:"职位选择","mask-closable":!1,styles:{top:"15px"}},on:{"on-ok":a.confirmDepartment,"on-cancel":a.cancelSelectDep,"on-visible-change":a.modalVisibleChange},model:{value:a.showDepartmentModal,callback:function(t){a.showDepartmentModal=t},expression:"showDepartmentModal"}},[o("div",{staticClass:"app-search"},[o("Input",{staticStyle:{width:"300px"},attrs:{search:!0,placeholder:"搜索"},on:{"on-search":a.depFilter},model:{value:a.searchDepValue,callback:function(t){a.searchDepValue=t},expression:"searchDepValue"}}),a._v(" "),o("p",{staticClass:"app-search-icon",on:{click:a.depFilter}},[o("Button",{attrs:{type:"primary",size:"small"}},[a._v("查询")])],1)],1),a._v(" "),o("Table",{ref:"roleTable",attrs:{height:"400",stripe:"",size:"small",loading:a.depLoading,columns:a.departmentColumns,data:a.departmentData},on:{"on-select-cancel":a.selectDepCancel,"on-select-all":a.onRoleSelectAll,"on-selection-change":a.selectDepartmentClick}}),a._v(" "),o("div",{staticClass:"user-page"},[o("div",{staticStyle:{float:"right"}},[o("Page",{attrs:{total:a.depTotal,current:a.depCurrentPage,"page-size":a.pageSize,size:"small","show-total":""},on:{"on-change":a.onDepPageChange}})],1)]),a._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:a.departmentSelection[0],expression:"departmentSelection[0] "}],staticClass:"page-selection-warp"},a._l(a.departmentSelection,function(e,s){return o("Tag",{key:e.id,attrs:{closable:"",type:"border",color:"primary",size:"small"},on:{"on-close":function(t){a.deleteSelectRole(e,s)}}},[a._v("\n        "+a._s(e.name)+"\n      ")])}))],1)],1)},staticRenderFns:[]}},QzSZ:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app-permission"},[s("operation-manage",{attrs:{enabledForbidden:t.enabledForbidden,isAdmin:t.isAdmin}}),t._v(" "),s("action-manage",{attrs:{isAdmin:t.isAdmin}}),t._v(" "),"subject"!==t.appType?s("permission-data-source",{attrs:{isAdmin:t.isAdmin}}):t._e(),t._v(" "),"subject"!==t.appType?s("custom-datasource",{attrs:{isAdmin:t.isAdmin}}):t._e(),t._v(" "),"subject"!==t.appType?s("field-permission",{attrs:{isAdmin:t.isAdmin}}):t._e(),t._v(" "),"subject"===t.appType?s("child-subject",{attrs:{isAdmin:t.isAdmin}}):t._e(),t._v(" "),s("report-view",{attrs:{appType:t.appType,isAdmin:t.isAdmin}}),t._v(" "),t.isAddress||"subject"===t.appType?t._e():s("app-form",{attrs:{isAdmin:t.isAdmin}}),t._v(" "),t.isAddress||"subject"===t.appType?t._e():s("work-flow",{attrs:{isAdmin:t.isAdmin}})],1)},staticRenderFns:[]}},RAte:function(t,e){t.exports={render:function(){var a=this,t=a.$createElement,o=a._self._c||t;return o("div",{staticClass:"app"},[o("Row",{staticClass:"app-action"},[o("Row",{staticClass:"app-action-title"},[o("h3",[a._v("动作")]),o("span",{staticClass:"warning-color marlr"},[a._v("勾选以启用或停用应用的动作")])]),a._v(" "),o("div",{staticClass:"app-action-source"},[o("Row",{staticClass:"app-action-source-list"},a._l(a.actionData,function(e,s){return o("Col",{key:s,staticClass:"app-action-source-item",attrs:{span:"6"}},[o("Col",{staticClass:"app-action-source-item-check",attrs:{span:"2"}},[o("Checkbox",{attrs:{disabled:!a.isAdmin,value:0===e.permType},on:{"on-change":function(t){a.isForbidden(e,s)}}})],1),a._v(" "),o("Col",{staticClass:"app-action-source-item-content",attrs:{span:"21"}},[o("h4",[a._v(a._s(e.name))]),a._v(" "),o("div",{staticClass:"app-action-source-item-desc"},[a._v(a._s(e.desc))])])],1)}))],1)],1)],1)},staticRenderFns:[]}},Ryk5:function(t,e){},UFJm:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app-workflow"},[s("Row",{staticClass:"app-workflow-title"},[s("h3",[t._v("工作流\n        "),t.isAdmin&&0===t.workflows.length?s("span",{staticClass:"app-workflow-create",on:{click:t.goCreateWorkflow}},[t._v("新建")]):t._e(),t._v(" "),t.isAdmin?s("span",{staticClass:"app-workflow-create",on:{click:t.showWorkflowModal}},[t._v("关联")]):t._e()])]),t._v(" "),s("Row",{staticClass:"app-workflow-table"},[s("Table",{attrs:{columns:t.columns,data:t.workflows,size:"small"}})],1),t._v(" "),s("workflow-modal",{attrs:{modalWorkflowStatus:t.showModal,deleteRelationWorkflow:t.deleteRelationWorkflow},on:{emitWorkFlowModal:t.emitWorkFlowModal,addWorkflow:t.addWorkflow}})],1)},staticRenderFns:[]}},Xqh5:function(t,e){t.exports={render:function(){var a=this,t=a.$createElement,o=a._self._c||t;return o("div",[o("Modal",{attrs:{title:"组织选择","mask-closable":!1,styles:{top:"15px"}},on:{"on-ok":a.confirmOrg,"on-cancel":a.cancelSelectOrg,"on-visible-change":a.modalVisibleChange},model:{value:a.showOrgModal,callback:function(t){a.showOrgModal=t},expression:"showOrgModal"}},[o("div",{staticClass:"app-search"},[o("Input",{staticStyle:{width:"300px"},attrs:{search:!0,placeholder:"搜索"},on:{"on-search":a.orgFilter},model:{value:a.searchOrgValue,callback:function(t){a.searchOrgValue=t},expression:"searchOrgValue"}}),a._v(" "),o("p",{staticClass:"app-search-icon",on:{click:a.orgFilter}},[o("Button",{attrs:{type:"primary",size:"small"}},[a._v("查询")])],1)],1),a._v(" "),o("Table",{ref:"orgTable",attrs:{height:"400",stripe:"",size:"small",loading:a.orgLoading,columns:a.orgColumns,data:a.orgData},on:{"on-select-cancel":a.selectOrgCancel,"on-select-all":a.onOrgSelectAll,"on-selection-change":a.selectOrgClick}}),a._v(" "),o("div",{staticClass:"user-page"},[o("div",{staticStyle:{float:"right"}},[o("Page",{attrs:{total:a.orgTotal,current:a.orgCurrentPage,"page-size":a.pageSize,size:"small","show-total":""},on:{"on-change":a.onOrgPageChange}})],1)]),a._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:a.orgSelection[0],expression:"orgSelection[0] "}],staticClass:"page-selection-warp"},a._l(a.orgSelection,function(e,s){return o("Tag",{key:e.id,attrs:{closable:"",type:"border",color:"primary",size:"small"},on:{"on-close":function(t){a.deleteSelectOrg(e,s)}}},[a._v("\n        "+a._s(e.name)+"\n      ")])}))],1)],1)},staticRenderFns:[]}},ZDyq:function(t,e){},aAio:function(t,e){t.exports={render:function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("Modal",{attrs:{transfer:!1,title:"应用权限",width:"1000",styles:{top:"15px"},"mask-closable":!1},on:{"on-visible-change":s.modalVisibleChange},model:{value:s.showPermissionModal,callback:function(t){s.showPermissionModal=t},expression:"showPermissionModal"}},[a("div",[a("Row",{staticStyle:{"margin-bottom":"10px"},attrs:{gutter:8}},[a("Col",{attrs:{span:"4"}},[a("Button",{attrs:{type:"info",shape:"circle"},on:{click:s.selectUserModal}},[s._v("选择用户")])],1),s._v(" "),a("Col",{attrs:{span:"4"}},[a("Button",{attrs:{type:"info",shape:"circle"},on:{click:s.selectGroupModal}},[s._v("选择组织")])],1),s._v(" "),a("Col",{attrs:{span:"4"}},[a("Button",{attrs:{type:"info",shape:"circle"},on:{click:s.selectRoleModal}},[s._v("选择职位")])],1),s._v(" "),s._e()],1),s._v(" "),a("Row",{attrs:{gutter:8}},[a("Col",{staticClass:"permission-tab",attrs:{span:"12"}},[a("Row",{staticStyle:{"margin-top":"10px"}},[a("Col",{attrs:{span:"3"}},[a("b",{staticClass:"permission-title"},[s._v("用户")])]),s._v(" "),a("Col",{staticClass:"member-body",attrs:{span:"21"}},s._l(s.userSelectData,function(t,e){return a("Tag",{key:e,attrs:{userId:t.userId,closable:"",color:"warning"},on:{"on-close":s.deleteUser}},[s._v("\n              "+s._s(t.nickname)+"\n            ")])}))],1),s._v(" "),a("Row",{staticClass:"permission-line"}),s._v(" "),a("Row",[a("Col",{attrs:{span:"3"}},[a("b",{staticClass:"permission-title"},[s._v("组织")])]),s._v(" "),a("Col",{staticClass:"member-body",attrs:{span:"21"}},s._l(s.orgSelectData,function(t,e){return a("Tag",{key:e,attrs:{orgId:t.id,closable:"",color:"success"},on:{"on-close":s.deleteOrg}},[s._v("\n            "+s._s(t.name)+"\n          ")])}))],1),s._v(" "),a("Row",{staticClass:"permission-line"}),s._v(" "),a("Row",[a("Col",{attrs:{span:"3"}},[a("b",{staticClass:"permission-title"},[s._v("职位")])]),s._v(" "),a("Col",{staticClass:"member-body",attrs:{span:"21"}},s._l(s.departmentSelectData,function(t,e){return a("Tag",{key:e,attrs:{depId:t.id,closable:"",color:"primary"},on:{"on-close":s.deleteDepartment}},[s._v("\n            "+s._s(t.name)+"\n          ")])}))],1),s._v(" "),s._e()],1),s._v(" "),a("Col",{attrs:{span:"12"}},[a("Table",{ref:"actionRef",attrs:{stripe:"",height:"350",columns:s.allPermissionColumns,size:"small",data:s.allPermissionData},on:{"on-selection-change":s.permissionSelectChange}})],1)],1),s._v(" "),a("user-selector",{attrs:{showUserSelector:s.showSelector.showUserSelector},on:{emitUserModal:s.emitUserModal,userModalData:s.getUserModalData}}),s._v(" "),a("group-selector",{attrs:{showGroupSelector:s.showSelector.showGroupSelector},on:{emitGroupModal:s.emitGroupModal,groupModalData:s.getGroupModalData}}),s._v(" "),a("role-selector",{attrs:{showRoleSelector:s.showSelector.showRoleSelector},on:{emitRoleModal:s.emitRoleModal,roleModalData:s.getRoleModalData}})],1),s._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"default"},on:{click:s.cancelAddPermission}},[s._v("取消")]),s._v(" "),a("Button",{attrs:{type:"primary",disabled:s.isModalDisabled},on:{click:s.submitPermission}},[s._v("确定")])],1)])},staticRenderFns:[]}},blmo:function(t,e){},dpLH:function(t,e){},eBIU:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app-form"},[s("Row",{staticClass:"app-form-title"},[s("h3",[t._v("表单 "),t.isAdmin?s("a",{on:{click:t.setForm}},[t._v("表单设置")]):t._e()])])],1)},staticRenderFns:[]}},hgVa:function(t,e){},iutk:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app",staticStyle:{"margin-top":"15px"}},[s("Row",{staticClass:"app-action"},[s("Row",{staticClass:"app-action-title"},[s("h3",[t._v("动作"),t.isAdmin?s("a",{staticClass:"app-action-title-add",on:{click:t.showModal}},[t._v("授权")]):t._e()]),t._v(" "),s("span",{staticClass:"warning-color marlr"},[t._v("授予用户、组织或职位当前应用动作的权限")])]),t._v(" "),s("div",{staticClass:"app-action-source"},[s("Row",[s("Table",{attrs:{columns:t.columns,data:t.userSources,size:"small"}})],1)],1)],1),t._v(" "),s("action-modal",{attrs:{modalStatis:t.showActionModal,modalName:t.modalName},on:{reGetData:t.reGetData,emitPermissionModal:t.emitPermissionModal}})],1)},staticRenderFns:[]}},ktW4:function(t,e){},l2sK:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app",staticStyle:{"margin-top":"15px"}},[s("Row",{staticClass:"app-action"},[s("Row",{staticClass:"app-action-title"},[s("h3",[t._v("数据源"),t.isAdmin?s("a",{staticClass:"app-action-title-add",on:{click:t.showModal}},[t._v("授权")]):t._e()]),t._v(" "),s("span",{staticClass:"warning-color marlr"},[t._v("用户默认可查看我创建的实例、我经办的实例、我负责的组织经办的实例")])]),t._v(" "),s("div",{staticClass:"app-action-source"},[s("Row",[s("Table",{attrs:{columns:t.columns,data:t.userSources,size:"small"}})],1)],1)],1),t._v(" "),s("action-modal",{attrs:{modalStatis:t.showActionModal,modalName:t.modalName},on:{reGetData:t.reGetData,emitPermissionModal:t.emitPermissionModal}})],1)},staticRenderFns:[]}},m0bS:function(t,e){t.exports={render:function(){var a=this,t=a.$createElement,o=a._self._c||t;return o("div",[o("Modal",{attrs:{title:a.modalTitle,width:"1000",transfer:!1,styles:{top:"15px"},"mask-closable":!1},on:{"on-visible-change":a.modalVisibleChange},model:{value:a.showPermissionModal,callback:function(t){a.showPermissionModal=t},expression:"showPermissionModal"}},[o("div",[o("Row",{staticStyle:{"margin-bottom":"10px"},attrs:{gutter:8}},[o("div",{staticClass:"field-toolbar"},[o("Button",{staticStyle:{"margin-bottom":"5px"},attrs:{type:"info",shape:"circle"},on:{click:a.addNewField}},[a._v("新增")]),a._v(" "),o("i-switch",{staticClass:"black-white",attrs:{size:"large"},on:{"on-change":a.changeBlackWhiteList},model:{value:a.isBlack,callback:function(t){a.isBlack=t},expression:"isBlack"}},[o("span",{attrs:{slot:"close"},slot:"close"},[a._v("白名单")]),a._v(" "),o("span",{attrs:{slot:"open"},slot:"open"},[a._v("黑名单")])])],1),a._v(" "),o("Table",{ref:"actionRef",attrs:{stripe:"",height:"200",columns:a.fieldColumns,size:"small","no-data-text":"请点击新增添加",data:a.fieldData},scopedSlots:a._u([{key:"fieldName",fn:function(t){var e=t.row,s=t.index;return[o("Select",{ref:"selectMenu",staticStyle:{width:"300px"},attrs:{value:e.fieldCode,filterable:""},on:{"on-change":function(t){a.fieldSelectChange(t,s)}}},a._l(a.allFieldData,function(t,e){return o("Option",{key:e,attrs:{label:t.fieldName,value:t.fieldCode}},[o("span",{staticClass:"select-field"},[a._v(a._s(t.fieldName))]),a._v(" "),t.fieldAlias?o("Poptip",{staticStyle:{float:"right"},attrs:{trigger:"hover",transfer:"",title:"对应视图字段名称",placement:"right"}},[o("span",{staticStyle:{color:"#39f"}},[o("Icon",{attrs:{type:"md-help"}})],1),a._v(" "),o("div",{attrs:{slot:"content"},slot:"content"},[o("ul",{staticClass:"hidden-field"},a._l(t.fieldAlias,function(t,e){return o("li",{key:e},[a._v(a._s(t.view+"—"+t.alias))])}))])]):a._e()],1)}))]}}])})],1),a._v(" "),o("Row",{staticStyle:{"margin-bottom":"10px"},attrs:{gutter:8}},[o("Col",{attrs:{span:"4"}},[o("Button",{attrs:{type:"info",shape:"circle"},on:{click:a.selectUserModal}},[a._v("选择用户")])],1),a._v(" "),o("Col",{attrs:{span:"4"}},[o("Button",{attrs:{type:"info",shape:"circle"},on:{click:a.selectGroupModal}},[a._v("选择组织")])],1),a._v(" "),o("Col",{attrs:{span:"4"}},[o("Button",{attrs:{type:"info",shape:"circle"},on:{click:a.selectRoleModal}},[a._v("选择职位")])],1),a._v(" "),a._e()],1),a._v(" "),o("Row",{attrs:{gutter:8}},[o("Col",{staticClass:"permission-tab",attrs:{span:"24"}},[o("Row",{staticStyle:{"margin-top":"10px"}},[o("Col",{attrs:{span:"3"}},[o("b",{staticClass:"permission-title"},[a._v("用户")])]),a._v(" "),o("Col",{staticClass:"member-body",attrs:{span:"21"}},a._l(a.userSelectData,function(t,e){return o("Tag",{key:e,attrs:{userId:t.userId,closable:"",color:"warning"},on:{"on-close":a.deleteUser}},[a._v("\n                "+a._s(t.nickname)+"\n              ")])}))],1),a._v(" "),o("Row",{staticClass:"permission-line"}),a._v(" "),o("Row",[o("Col",{attrs:{span:"3"}},[o("b",{staticClass:"permission-title"},[a._v("组织")])]),a._v(" "),o("Col",{staticClass:"member-body",attrs:{span:"21"}},a._l(a.orgSelectData,function(t,e){return o("Tag",{key:e,attrs:{orgId:t.id,closable:"",color:"success"},on:{"on-close":a.deleteOrg}},[a._v("\n              "+a._s(t.name)+"\n            ")])}))],1),a._v(" "),o("Row",{staticClass:"permission-line"}),a._v(" "),o("Row",[o("Col",{attrs:{span:"3"}},[o("b",{staticClass:"permission-title"},[a._v("职位")])]),a._v(" "),o("Col",{staticClass:"member-body",attrs:{span:"21"}},a._l(a.departmentSelectData,function(t,e){return o("Tag",{key:e,attrs:{depId:t.id,closable:"",color:"primary"},on:{"on-close":a.deleteDepartment}},[a._v("\n              "+a._s(t.name)+"\n            ")])}))],1),a._v(" "),a._e()],1)],1),a._v(" "),o("user-selector",{attrs:{showUserSelector:a.showSelector.showUserSelector},on:{emitUserModal:a.emitUserModal,userModalData:a.getUserModalData}}),a._v(" "),o("group-selector",{attrs:{showGroupSelector:a.showSelector.showGroupSelector},on:{emitGroupModal:a.emitGroupModal,groupModalData:a.getGroupModalData}}),a._v(" "),o("role-selector",{attrs:{showRoleSelector:a.showSelector.showRoleSelector},on:{emitRoleModal:a.emitRoleModal,roleModalData:a.getRoleModalData}})],1),a._v(" "),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("Button",{attrs:{type:"default"},on:{click:a.cancelAddPermission}},[a._v("取消")]),a._v(" "),o("Button",{attrs:{type:"primary",disabled:a.isModalDisabled},on:{click:a.submitPermission}},[a._v("确定")])],1)])],1)},staticRenderFns:[]}},sJK6:function(t,e){t.exports={render:function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("Modal",{attrs:{title:"自定义数据源",width:"1000",transfer:!1,styles:{top:"15px"},"mask-closable":!1},on:{"on-visible-change":s.modalVisibleChange},model:{value:s.showPermissionModal,callback:function(t){s.showPermissionModal=t},expression:"showPermissionModal"}},[a("div",[a("Row",{staticStyle:{"margin-bottom":"10px"},attrs:{gutter:8}},[a("Button",{staticStyle:{"margin-bottom":"5px"},attrs:{type:"info",shape:"circle"},on:{click:s.addNewField}},[s._v("新增字段")]),s._v(" "),a("Table",{ref:"actionRef",attrs:{stripe:"",height:"200",columns:s.fieldColumns,size:"small","no-data-text":"请添加新字段",data:s.fieldData}})],1),s._v(" "),a("Row",{staticStyle:{"margin-bottom":"10px"},attrs:{gutter:8}},[a("Col",{attrs:{span:"4"}},[a("Button",{attrs:{type:"info",shape:"circle"},on:{click:s.selectUserModal}},[s._v("选择用户")])],1),s._v(" "),a("Col",{attrs:{span:"4"}},[a("Button",{attrs:{type:"info",shape:"circle"},on:{click:s.selectGroupModal}},[s._v("选择组织")])],1),s._v(" "),a("Col",{attrs:{span:"4"}},[a("Button",{attrs:{type:"info",shape:"circle"},on:{click:s.selectRoleModal}},[s._v("选择职位")])],1),s._v(" "),s._e()],1),s._v(" "),a("Row",{attrs:{gutter:8}},[a("Col",{staticClass:"permission-tab",attrs:{span:"24"}},[a("Row",{staticStyle:{"margin-top":"10px"}},[a("Col",{attrs:{span:"3"}},[a("b",{staticClass:"permission-title"},[s._v("用户")])]),s._v(" "),a("Col",{staticClass:"member-body",attrs:{span:"21"}},s._l(s.userSelectData,function(t,e){return a("Tag",{key:e,attrs:{userId:t.userId,closable:"",color:"warning"},on:{"on-close":s.deleteUser}},[s._v("\n              "+s._s(t.nickname)+"\n            ")])}))],1),s._v(" "),a("Row",{staticClass:"permission-line"}),s._v(" "),a("Row",[a("Col",{attrs:{span:"3"}},[a("b",{staticClass:"permission-title"},[s._v("组织")])]),s._v(" "),a("Col",{staticClass:"member-body",attrs:{span:"21"}},s._l(s.orgSelectData,function(t,e){return a("Tag",{key:e,attrs:{orgId:t.id,closable:"",color:"success"},on:{"on-close":s.deleteOrg}},[s._v("\n            "+s._s(t.name)+"\n          ")])}))],1),s._v(" "),a("Row",{staticClass:"permission-line"}),s._v(" "),a("Row",[a("Col",{attrs:{span:"3"}},[a("b",{staticClass:"permission-title"},[s._v("职位")])]),s._v(" "),a("Col",{staticClass:"member-body",attrs:{span:"21"}},s._l(s.departmentSelectData,function(t,e){return a("Tag",{key:e,attrs:{depId:t.id,closable:"",color:"primary"},on:{"on-close":s.deleteDepartment}},[s._v("\n            "+s._s(t.name)+"\n          ")])}))],1),s._v(" "),s._e()],1)],1),s._v(" "),a("user-selector",{attrs:{showUserSelector:s.showSelector.showUserSelector},on:{emitUserModal:s.emitUserModal,userModalData:s.getUserModalData}}),s._v(" "),a("group-selector",{attrs:{showGroupSelector:s.showSelector.showGroupSelector},on:{emitGroupModal:s.emitGroupModal,groupModalData:s.getGroupModalData}}),s._v(" "),a("role-selector",{attrs:{showRoleSelector:s.showSelector.showRoleSelector},on:{emitRoleModal:s.emitRoleModal,roleModalData:s.getRoleModalData}})],1),s._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"default"},on:{click:s.cancelAddPermission}},[s._v("取消")]),s._v(" "),a("Button",{attrs:{type:"primary",disabled:s.isModalDisabled},on:{click:s.submitPermission}},[s._v("确定")])],1)])},staticRenderFns:[]}},wcdk:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app",staticStyle:{"margin-top":"15px"}},[s("Row",{staticClass:"app-action"},[s("Row",{staticClass:"app-action-title"},[s("h3",[t._v("自定义数据源"),t.isAdmin?s("a",{staticClass:"app-action-title-add",on:{click:t.showModal}},[t._v("添加")]):t._e()]),t._v(" "),s("span",{staticClass:"warning-color marlr"},[t._v("自定义应用字段过滤条件以及授权给用户或用户组")])]),t._v(" "),s("div",{staticClass:"app-action-source"},[s("Row",[s("Table",{attrs:{columns:t.columns,data:t.userSources,size:"small"}})],1)],1)],1),t._v(" "),s("custom-datasource-modal",{attrs:{modalStatis:t.showActionModal,isEdit:t.isEdit,resourceId:t.resourceId},on:{reGetData:t.reGetData,emitPermissionModal:t.emitPermissionModal}})],1)},staticRenderFns:[]}},yKKk:function(t,e){},zYdX:function(t,e){}});
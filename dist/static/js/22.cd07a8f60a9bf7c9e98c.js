webpackJsonp([22],{"75EL":function(t,a,i){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n=i("GIAq"),e=i("3SZ7"),s=i.n(e),o=i("i70d"),r={name:"appInfo",components:{vueWangeditor:i.n(o).a},props:{listId:String,appData:Object,isAdmin:Boolean,isCompanyAdmin:Boolean},data:function(){return{showEditAppInfo:!0,showAppEditAdmin:!0,showEditBtn:!0,adminLoading:!0,showAdminModal:!1,searchValue:"",total:0,currentPage:1,pageSize:10,menu:["|"],adminColumns:[{title:"头像",key:"photo",width:80,render:function(t,a){return t("div",[t("img",{attrs:{src:a.row.photo?a.row.photo:"/resources/images/icon/defaultUserPhoto.jpg"},style:{borderRadius:"50%",height:"32px",width:"32px"}})])}},{title:"工号",key:"userCode"},{title:"姓名",key:"nickname"},{title:"手机",key:"mobile"},{title:"邮箱",key:"email"}],adminData:[],selectAdminData:{}}},methods:{goList:function(){"000001"===this.appData.uniqueId?window.top.location.href="/Site/index.html#page/users":"000002"===this.appData.uniqueId?window.top.location.href="/Site/index.html#page/origanizations":"000003"===this.appData.uniqueId?window.top.location.href="/Site/index.html#page/jobs":"000004"===this.appData.uniqueId?window.top.location.href="/Site/index.html#page/companys":window.top.location.href="/Site/index.html#list/"+this.appData.uniqueId},clearAdmintrstor:function(){""===this.appData.administrator&&(this.appData.userId="")},childHasPublished:function(t){this.appData.publish=1},editAppinfo:function(){var t=this;if(this.isAdmin&&(this.showEditAppInfo=!this.showEditAppInfo),this.isCompanyAdmin&&(this.showAppEditAdmin=!1),!this.showEditBtn){var a={uniqueId:this.appData.uniqueId,title:this.appData.title,administrator:this.appData.userId,comment:this.$refs.editorInfo?this.$refs.editorInfo.getHtml():""};Object(n.Q)(a).then(function(a){a.success&&(t.$Message.success("更新成功!"),t.showAppEditAdmin=!0,t.$emit("reloadData"),t.$emit("changeAdmin"))})}this.showEditBtn=!this.showEditBtn},selectAdminModal:function(){this.showAdminModal=!0,this.searchValue="",this.getAdmintrstorData()},confirmModal:function(){this.appData.administrator=this.selectAdminData.nickname,this.appData.userId=this.selectAdminData.userId},dbclickConfirmModal:function(t){this.appData.administrator=t.nickname,this.appData.userId=t.userId,this.showAdminModal=!1},selectAdmin:function(t,a){this.selectAdminData=t},getAdmintrstorData:function(t){var a=this;this.adminLoading=!0,Object(n.o)(t,this.currentPage,this.pageSize).then(function(t){a.adminData=t.tableContent,a.total=t.dataCount,a.adminLoading=!1})},changeAppStatus:function(t){var a=this,i=this.listId,e=s()([{operator:"eq",value:"操作",property:"type"}]),o=[],r=[];Object(n.r)(i,e).then(function(i){i.tableContent.forEach(function(t){o.push(t.id),"查看"!=t.name&&r.push(t.id)}),"enabled"===t?Object(n.l)(o.join(",")).then(function(t){t.success&&(a.$Message.success(t.message),a.$emit("enabledForbiddenAppPermission"))}):Object(n.l)(null,r.join(",")).then(function(t){t.success&&(a.$Message.success(t.message),a.$emit("enabledForbiddenAppPermission"))})})},onPageChange:function(t){this.currentPage=t;var a=s()([{operator_1:"like",value_1:this.searchValue,property_1:"nickname",link:"or",operator_2:"like",value_2:this.searchValue,property_2:"userCode"}]);this.getAdmintrstorData(a)},adminFilter:function(){var t=s()([{operator_1:"like",value_1:this.searchValue,property_1:"nickname",link:"or",operator_2:"like",value_2:this.searchValue,property_2:"userCode"}]);this.getAdmintrstorData(t)}},mounted:function(){this.listId;this.getAdmintrstorData()}},p={render:function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{staticClass:"app-card"},[i("header",{staticClass:"app-header"},[i("Breadcrumb",[i("BreadcrumbItem",[t._v("首页")]),t._v(" "),i("BreadcrumbItem",[t._v("应用列表")]),t._v(" "),i("BreadcrumbItem",[t._v(t._s(t.appData.title))])],1)],1),t._v(" "),i("Row",{staticClass:"font14"},[i("Col",{staticClass:"pad15",attrs:{span:"2"}},[i("img",{staticClass:"appIcon",attrs:{src:t.appData.icon}})]),t._v(" "),i("Col",{staticClass:"pad15",attrs:{span:"21"}},[i("h3",[i("span",{staticClass:"app-detail-title",on:{click:t.goList}},[t._v(t._s(t.appData.title?t.appData.title:"待加载")+"\n          ")]),t._v("  - 应用详情\n        ")]),t._v(" "),i("Row",{staticClass:"pad5"},[i("Col",{attrs:{span:"6"}},[t._v("应用名称： \n            "),t.showAppEditAdmin?i("span",[t._v(t._s(t.appData.title))]):i("Input",{staticStyle:{width:"120px"},model:{value:t.appData.title,callback:function(a){t.$set(t.appData,"title",a)},expression:"appData.title"}}),t._v(" "),t.isCompanyAdmin?i("b",{on:{click:t.editAppinfo}},[t.showEditBtn?i("Tooltip",{attrs:{content:"编辑",placement:"top"}},[i("Icon",{staticClass:"app-edit-icon",attrs:{type:"ios-create-outline"}})],1):i("Tooltip",{attrs:{content:"保存",placement:"top"}},[i("b",{staticClass:"app-save-icon"},[t._v("保存")])])],1):t._e()],1),t._v(" "),i("Col",{attrs:{span:"6"}},[t._v("应用类型： "),i("span",[t._v(t._s(t.appData.TRANS_NAME))])]),t._v(" "),i("Col",{attrs:{span:"6"}},[t._v("应用管理员： \n            "),t.showAppEditAdmin?i("span",[i("Icon",{attrs:{type:"person"}}),t._v(t._s(t.appData.administrator)+"\n            ")],1):i("Input",{staticStyle:{width:"100px"},attrs:{icon:"md-arrow-dropdown"},on:{"on-click":t.selectAdminModal,"on-change":t.clearAdmintrstor},model:{value:t.appData.administrator,callback:function(a){t.$set(t.appData,"administrator",a)},expression:"appData.administrator"}})],1)],1),t._v(" "),i("Row",{staticClass:"pad5"},[i("Col",{attrs:{span:"6"}},[t._v("创建者： "),i("span",[t._v(t._s(t.appData.creator))])]),t._v(" "),i("Col",{attrs:{span:"6"}},[t._v("创建时间： "),i("span",[t._v(t._s(t.appData.crtTime))])]),t._v(" "),i("Col",{attrs:{span:"6"}},[t._v("修改者："+t._s(t.appData.modifer))]),t._v(" "),i("Col",{attrs:{span:"6"}},[t._v("修改时间： "),i("span",[t._v(t._s(t.appData.modTime))])])],1),t._v(" "),i("Row",{staticClass:"pad5"},[i("Col",{attrs:{span:"24"}},[t._v("说明："),t.showAppEditAdmin?i("span",{domProps:{innerHTML:t._s(t.appData.comment)}}):i("vue-wangeditor",{ref:"editorInfo",attrs:{id:"editorInfo",menus:t.menu,height:"100",width:"100%"},model:{value:t.appData.comment,callback:function(a){t.$set(t.appData,"comment",a)},expression:"appData.comment"}})],1)],1)],1),t._v(" "),i("Col",{attrs:{span:"1"}},[i("Dropdown",{staticClass:"app-dropdown",on:{"on-click":t.changeAppStatus}},[i("a",{attrs:{href:"javascript:void(0)"}},[t._v("\n                  操作\n                  "),i("Icon",{attrs:{type:"ios-arrow-down"}})],1),t._v(" "),t.isAdmin?i("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[i("DropdownItem",{attrs:{name:"enabled"}},[t._v("启用")]),t._v(" "),i("DropdownItem",{attrs:{name:"forbidden"}},[t._v("停用")])],1):t._e()],1)],1)],1),t._v(" "),i("Modal",{attrs:{title:"请选择管理员",width:"800"},on:{"on-ok":t.confirmModal},model:{value:t.showAdminModal,callback:function(a){t.showAdminModal=a},expression:"showAdminModal"}},[i("div",{staticClass:"app-search"},[i("Input",{staticStyle:{width:"300px"},attrs:{search:!0,placeholder:"搜索名称或工号"},on:{"on-search":t.adminFilter},model:{value:t.searchValue,callback:function(a){t.searchValue=a},expression:"searchValue"}}),t._v(" "),i("p",{staticClass:"app-search-icon",on:{click:t.adminFilter}},[i("Button",{attrs:{type:"primary",size:"small"}},[t._v("查询")])],1)],1),t._v(" "),i("Table",{attrs:{"highlight-row":!0,loading:t.adminLoading,height:"300",stripe:"",columns:t.adminColumns,size:"small",data:t.adminData},on:{"on-row-dblclick":t.dbclickConfirmModal,"on-row-click":t.selectAdmin}}),t._v(" "),i("div",{staticClass:"user-page"},[i("div",{staticStyle:{float:"right"}},[i("Page",{attrs:{total:t.total,current:t.currentPage,"page-size":t.pageSize,size:"small","show-total":""},on:{"on-change":t.onPageChange}})],1)])],1)],1)},staticRenderFns:[]};var d={name:"detail",components:{AppInfo:i("D8HT")(r,p,!1,function(t){i("R//M")},"data-v-318fa52f",null).exports},data:function(){return{listId:this.$route.params.listId,appData:{},enforData:[],isAdmin:!1,isCompanyAdmin:!1,isAddress:!1,appType:"",enabledForbidden:-1}},methods:{enabledForbiddenAppPermission:function(){this.enabledForbidden++},changeAdmin:function(){this.getAppInfoDatas()},getAppInfoDatas:function(){var t=this,a=this.listId,i=this.$currentUser,e=[];Object(n.F)(a).then(function(a){t.appData=a[0],t.appType=t.appData.type,i.isSysRoleList.forEach(function(t){e.push(t.id)}),t.appData.administrator?i.nickname===t.appData.administrator&&e.indexOf(1)>-1?(t.isAdmin=!0,t.isCompanyAdmin=!0):i.nickname==t.appData.administrator?t.isAdmin=!0:e.indexOf(1)>-1?(t.isCompanyAdmin=!0,t.isAdmin=!1):(t.isAdmin=!1,t.isCompanyAdmin=!1):e.indexOf(1)>-1?(t.isAdmin=!0,t.isCompanyAdmin=!0):(t.isAdmin=!1,t.isCompanyAdmin=!1),"hr"===t.appData.type&&(t.isAddress=!0)})},reloadData:function(){this.getAppInfoDatas()}},created:function(){this.getAppInfoDatas()}},l={render:function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{staticClass:"app-details"},[i("app-info",{attrs:{listId:this.$route.params.listId,enforData:t.enforData,isAdmin:t.isAdmin,isCompanyAdmin:t.isCompanyAdmin,appData:t.appData},on:{reloadData:t.reloadData,changeAdmin:t.changeAdmin,enabledForbiddenAppPermission:t.enabledForbiddenAppPermission}}),t._v(" "),i("Menu",{attrs:{mode:"horizontal",theme:"light","active-name":t.$route.name}},[i("router-link",{attrs:{to:{name:"change-log"}}},[i("MenuItem",{attrs:{name:"change-log"}},[t._v("\n        更新日志\n      ")])],1),t._v(" "),i("router-link",{attrs:{to:{name:"analysis"}}},[i("MenuItem",{attrs:{name:"analysis"}},[t._v("\n        数据分析\n      ")])],1),t._v(" "),i("router-link",{attrs:{to:{name:"interaction"}}},[i("MenuItem",{attrs:{name:"interaction"}},[t._v("\n        互动评论\n      ")])],1),t._v(" "),i("router-link",{attrs:{to:{name:"permission"}}},[i("MenuItem",{attrs:{name:"permission"}},[t._v("\n        资源授权\n      ")])],1),t._v(" "),i("router-link",{attrs:{to:{name:"connection"}}},[i("MenuItem",{attrs:{name:"connection"}},[t._v("\n        连接&API\n      ")])],1)],1),t._v(" "),i("div",{staticClass:"detail-content"},[i("router-view",{attrs:{listId:this.$route.params.listId,isAdmin:t.isAdmin,isAddress:t.isAddress,appType:t.appType,isCompanyAdmin:t.isCompanyAdmin,enabledForbidden:t.enabledForbidden}})],1)],1)},staticRenderFns:[]};var c=i("D8HT")(d,l,!1,function(t){i("PoD7")},"data-v-96801f6c",null);a.default=c.exports},PoD7:function(t,a){},"R//M":function(t,a){}});
webpackJsonp([1],{"+7eS":function(e,t,a){var s=a("3UZo"),o=a("LiZD");a("MEDl")("keys",function(){return function(e){return o(s(e))}})},"1jer":function(e,t){},"2FEj":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("3SZ7"),o=a.n(s),i=a("cfvZ"),n=a.n(i),r=a("oAV5"),l=a("o32f"),c={name:"userInfo",components:{},props:{userInfo:{type:Object}},data:function(){return{httpHeaders:{Authorization:Object(r.c)()},logo:"",searchValue:"",userId:this.$route.params.userId,hiddenInput:!1,showCompanyModal:!1,visible:!1,checkout:!0,isEdit:!0,isAdd:!0,loading:!1,companyTable:{total:0,currentPage:1,pageSize:10},companyColumns:[{title:"公司名称",key:"groupName"},{title:"公司简称",key:"groupShortName"},{title:"公司类型",key:"companyType"},{title:"创建者",key:"creator"}],companyData:[],selectedCompanyData:{},formItem:{userCode:"",nickname:"",mobile:"",officePhone:"",email:"",status:"1",gender:"1",termOfValidity:"",userType:"1",entityId:"",entityName:""},ruleValidate:{userCode:[{required:!0,message:"请输入用户工号",trigger:"blur"}],nickname:[{required:!0,message:"请输入用户名称",trigger:"blur"}],entityName:[{required:!0,message:"请选择公司主体",trigger:"blur"}],termOfValidity:[{required:!0,message:"请选择有效期"}],mobile:[{required:!0,message:"手机号输入不合法",trigger:"blur",pattern:/^[1][3,4,5,7,8][0-9]{9}$/}],email:[{type:"email",message:"邮箱输入不合法",trigger:"blur"}],officePhone:[{message:"座机输入不合法",trigger:"blur",pattern:/^((0\d{2,3})-)(\d{7,8})(-(\d{3,}))?$/}]}}},watch:{userInfo:function(){n()(this.userInfo).length>0&&(console.log(this.userInfo),this.formItem.userCode=this.userInfo.userCode,this.formItem.nickname=this.userInfo.nickname,this.formItem.mobile=this.userInfo.mobile,this.formItem.officePhone=this.userInfo.officePhone,this.formItem.email=this.userInfo.email,this.formItem.termOfValidity=this.userInfo.termOfValidity,this.formItem.gender=String(this.userInfo.gender),this.formItem.status=String(this.userInfo.status),this.formItem.userType=String(this.userInfo.userType),this.logo=this.userInfo.photo,this.formItem.entityId=this.userInfo.entityId,this.formItem.entityName=this.userInfo.entityName)}},methods:{userCodeBlur:function(){var e=this,t=void 0;if(this.userId){var a=this.formItem.userCode;t=o()([{filedName:"userCode",symbol:"=",value:a},{filedName:"userId",symbol:"<>",value:this.userId}]),Object(l.i)("sys_user",t).then(function(t){1===t.result?(e.checkout=!1,e.$Message.error("工号已存在，请重新输入！")):e.checkout=!0})}else this.formItem.userCode&&(t=o()([{filedName:"userCode",symbol:"=",value:this.formItem.userCode}]),Object(l.i)("sys_user",t).then(function(t){1===t.result?(e.checkout=!1,e.$Message.error("工号已存在，请重新输入！")):e.checkout=!0}))},handleSuccess:function(e,t){this.logo="/H_roleplay-si/ds/download?width=128&height=128&url="+e.data[0].attacthment},handleView:function(){this.visible=!0},handleRemove:function(){this.logo="",this.$refs.upload.fileList.splice(0,this.$refs.upload.fileList.length)},handleMaxSize:function(e){this.$Notice.warning({title:"文件大小超出范围",desc:"文件大小最大为2M"})},handleFormatError:function(e){this.$Notice.warning({title:"文件格式不对",desc:"请上传格式为png 或者 jpg 的图片"})},editUserInfo:function(){this.isEdit=!this.isEdit},updateUserData:function(){var e=this;this.$refs.formItem.validate(function(t){t&&(e.checkout?(e.formItem.photo=e.logo,e.formItem.termOfValidity&&(e.formItem.termOfValidity=e.formatDate(e.formItem.termOfValidity)),e.userInfo.userId?(e.formItem.userId=e.userInfo.userId,Object(l._8)(e.formItem).then(function(t){t.success&&(e.$Message.success("更新成功"),window.location.reload())}).catch(function(t){e.$Message.error(t.data.message)})):Object(l.g)(e.formItem).then(function(t){t&&(e.$Message.success("保存成功"),e.$router.push({path:"/addressBook/user/detail/"+t.user_id}),window.location.reload())}).catch(function(t){e.$Message.error(t.data.message)})):e.$Message.error("工号已存在，请重新输入！"))})},selectCompanyModal:function(){this.showCompanyModal=!0},onDbClick:function(e,t){this.formItem.entityId=e.groupCode,this.formItem.entityName=e.groupName,this.showCompanyModal=!1},onRowClick:function(e,t){this.selectedCompanyData=e},onPageChange:function(e){this.companyTable.currentPage=e,this.getAllCompanysData(this.searchValue)},pageSizeChange:function(e){this.companyTable.pageSize=e,this.getAllCompanysData(this.searchValue)},companyFilter:function(){this.getAllCompanysData(this.searchValue)},getAllCompanysData:function(e){var t=this;this.loading=!0,Object(l.s)(this.companyTable.pageSize,this.companyTable.currentPage,e).then(function(e){t.companyData=e.tableContent,t.companyTable.total=e.dataCount,t.loading=!1})},selectCompany:function(){this.formItem.entityId=this.selectedCompanyData.groupCode,this.formItem.entityName=this.selectedCompanyData.groupName},saveAndAddUser:function(){var e=this;this.userCodeBlur(),this.$refs.formItem.validate(function(t){t&&e.checkout&&(e.formItem.photo=e.logo,e.formItem.termOfValidity&&(e.formItem.termOfValidity=e.formatDate(e.formItem.termOfValidity)),e.userInfo.userId?(e.formItem.userId=e.userInfo.userId,Object(l._8)(e.formItem).then(function(t){t.success&&(e.$Message.success(t.message),e.$router.push({path:"/addressBook/user/add"}),window.location.reload())}).catch(function(t){e.$Message.error(t.data.message)})):Object(l.g)(e.formItem).then(function(t){t&&(e.$Message.success("新增成功！"),e.$refs.formItem.resetFields(),e.formItem.termOfValidity="",e.logo="",e.formItem.photo="",e.formItem.gender="1",e.formItem.status="1",e.formItem.userType="1",e.$refs.upload.fileList.splice(0,e.$refs.upload.fileList.length))}).catch(function(t){e.$Message.error(t.data.message)}))})},goUserList:function(){this.$Modal.confirm({title:"系统提示",content:"确认要关闭当前页面吗？",onOk:function(){location.href="/Site/index.html#page/users"}})},formatDate:function(e){var t=new Date(e),a=t.getFullYear(),s=t.getMonth()+1,o=t.getDate();return s>=1&&s<=9&&(s="0"+s),a+"-"+s+"-"+o}},mounted:function(){var e=this;this.getAllCompanysData(),Object(l.K)("000001").then(function(t){e.userId||(e.isAdd=!1,e.isEdit=!1),t[0].action.update||(e.isAdd=!1)})}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"info"},[a("Row",{staticClass:"info-detail"},[a("Form",{ref:"formItem",class:{"is-required":e.isEdit},attrs:{model:e.formItem,rules:e.ruleValidate,"label-width":107}},[a("FormItem",{attrs:{label:"头像："}},[e.isEdit?a("img",{staticStyle:{width:"128px",height:"128px"},attrs:{src:!!e.logo&&e.logo}}):a("Upload",{ref:"upload",staticStyle:{display:"inline-block",width:"128px","vertical-align":"middle"},attrs:{"show-upload-list":!1,"on-success":e.handleSuccess,format:["jpg","jpeg","png"],"max-size":2048,"on-format-error":e.handleFormatError,"on-exceeded-size":e.handleMaxSize,type:"drag",action:"/H_roleplay-si/ds/upload",headers:e.httpHeaders}},[e.logo?e._e():a("div",{staticStyle:{width:"128px",height:"128px","line-height":"128px"}},[e.logo?a("img",{attrs:{src:e.logo}}):e._e(),e._v(" "),e.logo?e._e():a("i",{staticClass:"iconfont"},[e._v("")])]),e._v(" "),e.logo?a("div",{staticClass:"demo-upload-list",staticStyle:{width:"128px",height:"128px","line-height":"128px"}},[a("img",{attrs:{src:e.logo}}),e._v(" "),a("div",{staticClass:"demo-upload-list-cover"},[a("Icon",{attrs:{type:"ios-eye-outline",color:"#fff",size:"30"},on:{click:function(t){return t.stopPropagation(),e.handleView(t)}}}),e._v(" "),a("Icon",{attrs:{type:"ios-trash-outline",color:"#fff",size:"30"},on:{click:function(t){return t.stopPropagation(),e.handleRemove(t)}}})],1)]):e._e()]),e._v(" "),a("Modal",{attrs:{title:"查看头像"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e.visible?a("img",{staticStyle:{width:"100%"},attrs:{src:e.logo}}):e._e()])],1),e._v(" "),a("FormItem",{attrs:{label:"工号：",prop:"userCode"}},[a("Input",{class:{"info-edit":e.isAdd},staticStyle:{width:"60%"},attrs:{readonly:e.isAdd},on:{"on-blur":e.userCodeBlur},model:{value:e.formItem.userCode,callback:function(t){e.$set(e.formItem,"userCode",t)},expression:"formItem.userCode"}})],1),e._v(" "),a("FormItem",{attrs:{label:"姓名：",prop:"nickname"}},[a("Input",{class:{"info-edit":e.isEdit},staticStyle:{width:"60%"},attrs:{readonly:e.isEdit},model:{value:e.formItem.nickname,callback:function(t){e.$set(e.formItem,"nickname",t)},expression:"formItem.nickname"}})],1),e._v(" "),a("FormItem",{attrs:{label:"性别："}},[a("RadioGroup",{model:{value:e.formItem.gender,callback:function(t){e.$set(e.formItem,"gender",t)},expression:"formItem.gender"}},[a("Radio",{attrs:{disabled:e.isEdit,label:"1"}},[e._v("男")]),e._v(" "),a("Radio",{attrs:{disabled:e.isEdit,label:"0"}},[e._v("女")])],1)],1),e._v(" "),a("div",{staticClass:"info-line"}),e._v(" "),a("FormItem",{attrs:{label:"手机：",prop:"mobile"}},[a("Input",{class:{"info-edit":e.isEdit},staticStyle:{width:"60%"},attrs:{readonly:e.isEdit},model:{value:e.formItem.mobile,callback:function(t){e.$set(e.formItem,"mobile",t)},expression:"formItem.mobile"}})],1),e._v(" "),a("FormItem",{attrs:{label:"座机：",prop:"officePhone"}},[a("Input",{class:{"info-edit":e.isEdit},staticStyle:{width:"60%"},attrs:{readonly:e.isEdit},model:{value:e.formItem.officePhone,callback:function(t){e.$set(e.formItem,"officePhone",t)},expression:"formItem.officePhone"}})],1),e._v(" "),a("FormItem",{attrs:{label:"邮箱：",prop:"email"}},[a("Input",{class:{"info-edit":e.isEdit},staticStyle:{width:"60%"},attrs:{readonly:e.isEdit},model:{value:e.formItem.email,callback:function(t){e.$set(e.formItem,"email",t)},expression:"formItem.email"}})],1),e._v(" "),a("div",{staticClass:"info-line"}),e._v(" "),a("FormItem",{attrs:{label:"类型："}},[a("RadioGroup",{model:{value:e.formItem.userType,callback:function(t){e.$set(e.formItem,"userType",t)},expression:"formItem.userType"}},[a("Radio",{attrs:{disabled:e.isEdit,label:"1"}},[e._v("长期有效")]),e._v(" "),a("Radio",{attrs:{disabled:e.isEdit,label:"0"}},[e._v("临时账户")])],1)],1),e._v(" "),"0"===e.formItem.userType?a("FormItem",{attrs:{label:"账户有效期：",prop:"termOfValidity"}},[a("DatePicker",{class:{"info-edit":e.isEdit},attrs:{readonly:e.isEdit,type:"date",placeholder:""},model:{value:e.formItem.termOfValidity,callback:function(t){e.$set(e.formItem,"termOfValidity",t)},expression:"formItem.termOfValidity"}})],1):e._e(),e._v(" "),a("FormItem",{attrs:{label:"状态："}},[e.isEdit?a("span",[e._v(e._s(e.userInfo.statusText))]):a("Select",{staticStyle:{width:"60%"},model:{value:e.formItem.status,callback:function(t){e.$set(e.formItem,"status",t)},expression:"formItem.status"}},[a("Option",{attrs:{value:"1"}},[e._v("使用中")]),e._v(" "),a("Option",{attrs:{value:"3"}},[e._v("草稿")]),e._v(" "),a("Option",{attrs:{value:"-1"}},[e._v("停用")]),e._v(" "),a("Option",{attrs:{value:"2"}},[e._v("未使用")])],1)],1),e._v(" "),a("FormItem",{attrs:{label:"公司：",prop:"entityName"}},[a("Input",{class:{"info-edit":e.isEdit},staticStyle:{width:"60%"},attrs:{icon:e.isEdit?"":"md-arrow-dropdown",readonly:e.isEdit},on:{"on-click":e.selectCompanyModal},model:{value:e.formItem.entityName,callback:function(t){e.$set(e.formItem,"entityName",t)},expression:"formItem.entityName"}})],1),e._v(" "),e.hiddenInput?a("FormItem",{staticStyle:{width:"60%"},attrs:{label:"公司主体id"}},[a("Input",{model:{value:e.formItem.entityId,callback:function(t){e.$set(e.formItem,"entityId",t)},expression:"formItem.entityId"}})],1):e._e(),e._v(" "),a("div",{staticClass:"info-line"}),e._v(" "),e.isAdd&&e.isEdit?a("FormItem",{attrs:{label:"创建者："}},[a("span",[e._v(e._s(e.userInfo.creatorName))])]):e._e(),e._v(" "),e.isAdd&&e.isEdit?a("FormItem",{attrs:{label:"创建时间："}},[a("span",[e._v(e._s(e.userInfo.crtTime))])]):e._e(),e._v(" "),e.isAdd&&e.isEdit?a("FormItem",{attrs:{label:"修改者："}},[a("span",[e._v(e._s(e.userInfo.modifierName))])]):e._e(),e._v(" "),e.isAdd&&e.isEdit?a("FormItem",{attrs:{label:"修改时间："}},[a("span",[e._v(e._s(e.userInfo.modTime))])]):e._e()],1)],1),e._v(" "),a("Row",{staticClass:"info-btn"},[a("Button",{staticClass:"radius0",staticStyle:{"background-color":"rgb(81, 90, 110) !important",color:"#fff","font-weight":"bold",padding:"6px 15px"},on:{click:e.goUserList}},[e._v("\n            关闭\n        ")]),e._v(" "),e.isAdd?a("Button",{staticClass:"radius0",staticStyle:{"background-color":"rgb(0, 150, 136) !important",color:"#fff","font-weight":"bold",padding:"6px 15px"},on:{click:e.editUserInfo}},[e._v("\n            "+e._s(e.isEdit?"编辑":"放弃编辑")+"\n        ")]):e._e(),e._v(" "),e.isEdit?e._e():a("Button",{staticClass:"radius0",staticStyle:{"background-color":"rgb(0, 150, 136) !important",color:"#fff","font-weight":"bold",padding:"6px 15px"},on:{click:e.updateUserData}},[e._v("\n            保存\n        ")]),e._v(" "),e.userId?e._e():a("Button",{staticClass:"radius0",staticStyle:{"background-color":"rgb(0, 150, 136) !important",color:"#fff","font-weight":"bold",padding:"6px 15px"},on:{click:e.saveAndAddUser}},[e._v("\n            保存并新建\n        ")])],1),e._v(" "),a("Modal",{attrs:{title:"选择公司",styles:{top:"20px"},width:"800"},on:{"on-ok":e.selectCompany},model:{value:e.showCompanyModal,callback:function(t){e.showCompanyModal=t},expression:"showCompanyModal"}},[a("div",{staticClass:"app-search"},[a("Input",{staticStyle:{width:"300px"},attrs:{search:!0,placeholder:"搜索公司名称"},on:{"on-search":e.companyFilter},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}}),e._v(" "),a("p",{staticClass:"app-search-icon",on:{click:e.companyFilter}},[a("Button",{attrs:{type:"primary",size:"small"}},[e._v("查询")])],1)],1),e._v(" "),a("Table",{ref:"selection",staticClass:"rfd-principal-table",attrs:{"highlight-row":!0,height:"400",loading:e.loading,columns:e.companyColumns,data:e.companyData},on:{"on-row-dblclick":e.onDbClick,"on-row-click":e.onRowClick}}),e._v(" "),a("div",{staticClass:"user-page"},[a("div",{staticClass:"fr"},[a("Page",{attrs:{total:e.companyTable.total,"show-elevator":"","show-sizer":"",current:e.companyTable.currentPage,"page-size":e.companyTable.pageSize,size:"small","show-total":""},on:{"on-page-size-change":e.pageSizeChange,"on-change":e.onPageChange}})],1)])],1)],1)},staticRenderFns:[]};var h=a("D8HT")(c,u,!1,function(e){a("hhkS")},null,null).exports,d={name:"higherUser",components:{},props:{},data:function(){var e=this;return{userId:this.$route.params.userId,highUser:{total:0,currentPage:1,usertotal:0,usercurrentPage:1,pageSize:10,allUserpageSize:10},searchValue:"",loading:!0,userLoading:!0,showModal:!1,columns:[{title:"头像",key:"photo",width:80,render:function(e,t){return e("div",[e("Avatar",{props:{src:t.row.photo?t.row.photo:"../../../../../resources/images/icon/defaultUserPhoto.jpg"}})])}},{title:"工号",key:"userCode"},{title:"姓名",key:"nickname"},{title:"性别",key:"gender",render:function(e,t){return e("span",{},1===t.row.gender?"男":"女")}},{title:"手机号",key:"mobile"},{title:"邮箱",key:"email",width:180},{title:"操作",key:"action",align:"center",render:function(t,a){return t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.$Modal.confirm({title:"确认",content:"确认删除此用户？",onOk:function(){Object(l.q)(e.userId).then(function(t){t.success&&(e.$Message.success("删除成功！"),e.getHigherUserData(),e.$emit("changeInstance"))}).catch(function(t){e.$Message.error(t.data.message)})}})}}},"删除")}}],userColumns:[{title:"头像",key:"photo",width:80,render:function(e,t){return e("div",[e("Avatar",{props:{src:t.row.photo?t.row.photo:"../../../../../resources/images/icon/defaultUserPhoto.jpg"}})])}},{title:"工号",key:"userCode"},{title:"姓名",key:"nickname"},{title:"性别",key:"gender",render:function(e,t){return e("span",{},1===t.row.gender?"男":"女")}},{title:"手机号",key:"mobile"},{title:"邮箱",key:"email",width:180}],higherUserData:[],userData:[],onRowClickSelectData:{}}},methods:{getHigherUserData:function(){var e=this;this.userId?(this.loading=!0,Object(l.G)(this.userId,this.highUser.pageSize,this.highUser.currentPage).then(function(t){e.higherUserData=t.tableContent,e.highUser.total=t.dataCount,e.loading=!1})):this.loading=!1},onPageChange:function(e){this.highUser.currentPage=e,this.getHigherUserData()},onPageSizeChange:function(e){this.highUser.pageSize=e,this.getHigherUserData()},onAllUserPageSizeChange:function(e){var t=o()([{operator_1:"like",value_1:this.searchValue,property_1:"nickname",link:"or",operator_2:"like",value_2:this.searchValue,property_2:"userCode"},{operator:"ne",value:this.userId,property:"userId"}]);this.highUser.allUserpageSize=e,this.getAllUsersData(t)},onUserPageChange:function(e){var t=o()([{operator_1:"like",value_1:this.searchValue,property_1:"nickname",link:"or",operator_2:"like",value_2:this.searchValue,property_2:"userCode"},{operator:"ne",value:this.userId,property:"userId"}]);this.highUser.usercurrentPage=e,this.getAllUsersData(t)},onDbClick:function(e,t){var a=this,s=e.userId;s&&this.userId&&Object(l._6)(this.userId,s).then(function(e){e.success&&(a.showModal=!1,a.$Message.success("更新成功"),a.getHigherUserData(),a.$emit("changeInstance"))}).catch(function(e){a.$Message.error(e.data.message)})},addHighUser:function(){var e=this,t=this.onRowClickSelectData.userId;t&&this.userId&&Object(l._6)(this.userId,t).then(function(t){t.success&&(e.$Message.success("更新成功"),e.getHigherUserData(),e.$emit("changeInstance"))})},onRowClick:function(e,t){this.onRowClickSelectData=e},showUserModal:function(){this.showModal=!0,this.searchValue="",this.getAllUsersData()},getAllUsersData:function(e){var t=this,a=e||o()([{operator:"ne",value:this.userId,property:"userId"}]);this.userLoading=!0,Object(l.z)(this.highUser.allUserpageSize,this.highUser.usercurrentPage,a).then(function(e){t.userData=e.tableContent,t.highUser.usertotal=e.dataCount,t.userLoading=!1})},userFilter:function(){var e=o()([{operator_1:"like",value_1:this.searchValue,property_1:"nickname",link:"or",operator_2:"like",value_2:this.searchValue,property_2:"userCode"},{operator:"ne",value:this.userId,property:"userId"}]);this.getAllUsersData(e)}},mounted:function(){this.getHigherUserData()}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"higher-user"},[a("div",{staticClass:"higher-user-detail",attrs:{id:"cliHeight"}},[a("b",{staticClass:"higher-user-detail-btn",on:{click:e.showUserModal}},[e._v("上级用户")]),e._v(" "),a("span",{staticStyle:{color:"#7a7676"}},[e._v("-添加上级用户")]),e._v(" "),a("Table",{ref:"selection",attrs:{columns:e.columns,loading:e.loading,data:e.higherUserData}})],1),e._v(" "),a("Modal",{attrs:{title:"选择用户",styles:{top:"20px"},width:"1000"},on:{"on-ok":e.addHighUser},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[a("div",{staticClass:"app-search"},[a("Input",{staticStyle:{width:"300px"},attrs:{search:!0,placeholder:"搜索工号或名称"},on:{"on-search":e.userFilter},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}}),e._v(" "),a("p",{staticClass:"app-search-icon",on:{click:e.userFilter}},[a("Button",{attrs:{type:"primary",size:"small"}},[e._v("查询")])],1)],1),e._v(" "),a("Table",{ref:"selection",staticClass:"rfd-principal-table",attrs:{"highlight-row":!0,height:"400",loading:e.userLoading,columns:e.userColumns,data:e.userData},on:{"on-row-dblclick":e.onDbClick,"on-row-click":e.onRowClick}}),e._v(" "),a("div",{staticClass:"user-page"},[a("div",{staticClass:"fr"},[a("Page",{attrs:{total:e.highUser.usertotal,"show-elevator":"","show-sizer":"",current:e.highUser.usercurrentPage,"page-size":e.highUser.allUserpageSize,size:"small","show-total":""},on:{"on-page-size-change":e.onAllUserPageSizeChange,"on-change":e.onUserPageChange}})],1)])],1)],1)},staticRenderFns:[]};var m=a("D8HT")(d,g,!1,function(e){a("K8UT")},null,null).exports,p=a("Sxqw"),f=a.n(p),v={name:"lowerUser",components:{},props:{},data:function(){var e=this;return{userId:this.$route.params.userId,lowUser:{total:0,usertotal:0,currentPage:1,usercurrentPage:1,pageSize:10,allUserpageSize:10},searchValue:"",loading:!0,userLoading:!0,showModal:!1,onPageSelection:[],columns:[{type:"selection",align:"center"},{title:"头像",key:"photo",width:80,render:function(e,t){return e("div",[e("Avatar",{props:{src:t.row.photo?t.row.photo:"../../../../../resources/images/icon/defaultUserPhoto.jpg"}})])}},{title:"工号",key:"userCode"},{title:"姓名",key:"nickname"},{title:"性别",key:"gender",render:function(e,t){return e("span",{},1===t.row.gender?"男":"女")}},{title:"手机号",key:"mobile"},{title:"邮箱",key:"email",width:180},{title:"操作",key:"action",align:"center",render:function(t,a){return t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.$Modal.confirm({title:"确认",content:"确认删除此用户？",onOk:function(){Object(l.q)(a.row.userId).then(function(t){e.$Message.success("删除成功！"),e.getLowerUserData(),e.$emit("changeInstance")}).catch(function(t){e.$Message.error(t.data.message)})}})}}},"删除")}}],userColumns:[{type:"selection",width:60,align:"center"},{title:"头像",key:"photo",width:80,render:function(e,t){return e("div",[e("Avatar",{props:{src:t.row.photo?t.row.photo:"../../../../../resources/images/icon/defaultUserPhoto.jpg"}})])}},{title:"工号",key:"userCode"},{title:"姓名",key:"nickname"},{title:"性别",key:"gender",render:function(e,t){return e("span",{},1===t.row.gender?"男":"女")}},{title:"手机号",key:"mobile",width:130},{title:"邮箱",key:"email",width:180}],lowerUserData:[],userData:[],selectUserData:[],selectLowUserData:[]}},methods:{getLowerUserData:function(){var e=this;this.userId?(this.loading=!0,Object(l.L)(this.userId,this.lowUser.pageSize,this.lowUser.currentPage).then(function(t){e.lowerUserData=t.tableContent,e.lowUser.total=t.dataCount,e.loading=!1})):this.loading=!1},onPageChange:function(e){this.lowUser.currentPage=e,this.getLowerUserData()},onPageSizeChange:function(e){this.lowUser.pageSize=e,this.getLowerUserData()},onAllUserPageSizeChange:function(e){var t=o()([{operator_1:"like",value_1:this.searchValue,property_1:"nickname",link:"or",operator_2:"like",value_2:this.searchValue,property_2:"userCode"},{operator:"ne",value:this.userId,property:"userId"}]);this.lowUser.allUserpageSize=e,this.getAllUsersData(t)},onUserPageChange:function(e){var t=o()([{operator_1:"like",value_1:this.searchValue,property_1:"nickname",link:"or",operator_2:"like",value_2:this.searchValue,property_2:"userCode"},{operator:"ne",value:this.userId,property:"userId"}]);this.lowUser.usercurrentPage=e,this.getAllUsersData(t)},selectLowUser:function(e){this.selectLowUserData=e},deleteSelectUser:function(e,t){var a=this;this.onPageSelection.splice(t,1),this.$refs.selection.data.forEach(function(t,s){e.userId===t.userId&&a.$refs.selection.toggleSelect(s)})},addLowUser:function(){var e=this,t=[];this.onPageSelection.length>0?this.onPageSelection.forEach(function(e){t.push(e.userId)}):this.$Message.warning("请选择至少一个用户！"),t&&this.userId?Object(l._6)(t.join(","),this.userId).then(function(t){t.success&&(e.$Message.success("更新成功"),e.getLowerUserData(),e.$emit("changeInstance"))}).catch(function(t){e.$Message.error(t.data.message)}):this.$Message.warning("无用户ID，请先保存用户再进行编辑！")},deleteLowUser:function(){var e=this,t=[];0===this.selectLowUserData.length?this.$Message.warning("请先选择要删除的用户！"):(this.selectLowUserData.forEach(function(e){t.push(e.userId)}),this.$Modal.confirm({title:"确认",content:"确认删除选择的用户？",onOk:function(){Object(l.q)(t.join(",")).then(function(t){e.selectLowUserData=[],e.$Message.success("删除成功！"),e.getLowerUserData(),e.$emit("changeInstance")}).catch(function(t){e.$Message.error(t.data.message)})}}))},onSelectionChange:function(e){if(0===e.length){var t=this.$refs.selection.data,a=this.onPageSelection;t.map(function(e){a=a.filter(function(t){return t.userId!==e.userId})}),this.onPageSelection=a}else{var s,o={};(s=this.onPageSelection).push.apply(s,f()(e)),this.onPageSelection=this.onPageSelection.reduce(function(e,t){return!o[t.userId]&&(o[t.userId]=e.push(t)),e},[])}},onSelectAll:function(e){var t,a={};(t=this.onPageSelection).push.apply(t,f()(e)),this.onPageSelection=this.onPageSelection.reduce(function(e,t){return!a[t.userId]&&(a[t.userId]=e.push(t)),e},[])},onSelectCancel:function(e,t){this.onPageSelection=this.onPageSelection.filter(function(e){return e.userId!==t.userId})},showUserModal:function(){this.showModal=!0,this.searchValue="",this.onPageSelection=[],this.getAllUsersData()},getAllUsersData:function(e){var t=this,a=e||o()([{operator:"ne",value:this.userId,property:"userId"}]);this.userLoading=!0,Object(l.z)(this.lowUser.allUserpageSize,this.lowUser.usercurrentPage,a).then(function(e){t.userData=e.tableContent,t.lowUser.usertotal=e.dataCount,t.userLoading=!1,t.onPageSelection.length>0&&t.userData.map(function(e){t.onPageSelection.map(function(t){e.userId===t.userId&&(e._checked=!0)})})})},userFilter:function(){var e=o()([{operator_1:"like",value_1:this.searchValue,property_1:"nickname",link:"or",operator_2:"like",value_2:this.searchValue,property_2:"userCode"},{operator:"ne",value:this.userId,property:"userId"}]);this.getAllUsersData(e)}},mounted:function(){this.getLowerUserData()}},w={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"lower-user"},[a("div",{staticClass:"lower-user-detail",attrs:{id:"lowHeight"}},[a("div",{staticClass:"lower-user-header"},[a("b",{staticClass:"lower-user-detail-btn",on:{click:e.showUserModal}},[e._v("下级用户")]),e._v(" "),a("span",{staticStyle:{color:"#7a7676"}},[e._v("-添加下级用户")]),e._v(" "),a("b",{staticClass:"lower-user-detail-btn",on:{click:e.deleteLowUser}},[e._v("删除")]),e._v(" "),a("span",{staticStyle:{color:"#7a7676"}},[e._v("-批量删除下级用户")])]),e._v(" "),a("div",{staticClass:"lower-user-table"},[a("Table",{attrs:{columns:e.columns,loading:e.loading,data:e.lowerUserData},on:{"on-selection-change":e.selectLowUser}}),e._v(" "),a("div",{staticClass:"user-page"},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:e.lowUser.total,"show-elevator":"","show-sizer":"",current:e.lowUser.currentPage,"page-size":e.lowUser.pageSize,size:"small","show-total":""},on:{"on-page-size-change":e.onPageSizeChange,"on-change":e.onPageChange}})],1)])],1)]),e._v(" "),a("Modal",{attrs:{title:"选择用户",styles:{top:"15px"},width:"1000"},on:{"on-ok":e.addLowUser},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[a("div",{staticClass:"app-search"},[a("Input",{staticStyle:{width:"300px"},attrs:{search:!0,placeholder:"搜索工号或姓名"},on:{"on-search":e.userFilter},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}}),e._v(" "),a("p",{staticClass:"app-search-icon",on:{click:e.userFilter}},[a("Button",{attrs:{type:"primary",size:"small"}},[e._v("查询")])],1)],1),e._v(" "),a("Table",{ref:"selection",attrs:{height:"400",loading:e.userLoading,columns:e.userColumns,data:e.userData},on:{"on-selection-change":e.onSelectionChange,"on-select-all":e.onSelectAll,"on-select-cancel":e.onSelectCancel}}),e._v(" "),a("div",{staticClass:"user-page"},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:e.lowUser.usertotal,"show-elevator":"","show-sizer":"",current:e.lowUser.usercurrentPage,"page-size":e.lowUser.allUserpageSize,size:"small","show-total":""},on:{"on-page-size-change":e.onAllUserPageSizeChange,"on-change":e.onUserPageChange}})],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.onPageSelection[0],expression:"onPageSelection[0] "}],staticClass:"page-selection-warp"},e._l(e.onPageSelection,function(t,s){return a("Tag",{key:t.userId,attrs:{userId:t.userId,closable:"",type:"border",color:"primary",size:"small"},on:{"on-close":function(a){e.deleteSelectUser(t,s)}}},[e._v("\n            "+e._s(t.nickname)+"\n          ")])}))],1)],1)},staticRenderFns:[]};var I=a("D8HT")(v,w,!1,function(e){a("xRDx")},"data-v-870cd794",null).exports,y={name:"departmentMember",components:{},props:{},data:function(){var e=this;return{userId:this.$route.params.userId,total:0,currentPage:1,pageSize:10,loading:!0,showModal:!1,columns:[{type:"selection",width:60,align:"center"},{title:"类型",key:"groupType",render:function(e,t){var a="";switch(t.row.groupType){case"M":a="管理部";break;case"A":a="事业部";break;case"O":a="部门";break;case"G":a="小组"}return e("span",{},a)}},{title:"名称",key:"groupName",ellipsis:!0},{title:"负责人",key:"principalName"},{title:"默认部门",key:"isDefault",align:"center",render:function(t,a){var s=!1;return 1===a.row.isDefault&&(s=!0),t("Radio",{props:{value:s},on:{"on-change":function(t){e.onClickDefaultView(a)}}})}},{title:"操作",key:"action",maxWidth:120,align:"center",render:function(t,a){return t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.$Modal.confirm({title:"确认",content:"确认删除此部门？",onOk:function(){Object(l.m)("sys_group_user",a.row.groupId,e.userId).then(function(t){t.success&&(e.$Message.success("删除成功！"),e.getDepartmentData(),e.$emit("changeInstance"))}).catch(function(t){e.$Message.error(t.data.message)})}})}}},"删除")}}],departmentData:[],groupData:[],selectGroup:[],selectDeleteGroupData:[]}},methods:{onClickDefaultView:function(e){var t=this;this.$Modal.confirm({title:"确认",content:"确认设置此部门为默认部门？",onOk:function(){t.setDefaultViews(e)},onCancel:function(){t.reRenderDefaultView()}})},setDefaultViews:function(e){var t=this;Object(l._3)(this.userId,"group",e.row.groupId).then(function(e){e.success&&(t.$Message.success(e.message),t.getDepartmentData())}).catch(function(e){t.$Message.error(e.data.message)})},reRenderDefaultView:function(){var e=this;this.columns[4].render=function(t,a){var s=!1;return 1===a.row.isDefault&&(s=!0),t("Radio",{props:{value:s},on:{"on-change":function(){e.onClickDefaultView(a)}}})}},getDepartmentData:function(){var e=this;this.userId?(this.loading=!0,Object(l.C)(this.userId,this.pageSize,this.currentPage).then(function(t){e.departmentData=t.tableContent,e.total=t.dataCount,e.loading=!1})):this.loading=!1},onPageChange:function(e){this.currentPage=e,this.getDepartmentData()},onPageSizeChange:function(e){this.pageSize=e,this.getDepartmentData()},showGroupModal:function(){this.showModal=!0,this.groupData=[],this.getAllGroupData(7)},deleteGroup:function(){var e=this,t=[];0===this.selectDeleteGroupData.length?this.$Message.warning("请先选择要删除的用户部门！"):(this.selectDeleteGroupData.forEach(function(e){t.push(e.groupId)}),this.$Modal.confirm({title:"确认",content:"确认删除选择的用户部门？",onOk:function(){Object(l.m)("sys_group_user",t.join(","),e.userId).then(function(t){t.success&&(e.selectDeleteGroupData=[],e.$Message.success("删除成功！"),e.getDepartmentData(),e.$emit("changeInstance"))}).catch(function(t){e.$Message.error(t.data.message)})}}))},selectDeleteGroup:function(e){this.selectDeleteGroupData=e},addDepartment:function(){var e=this;if(this.selectGroup&&this.userId){var t=[];this.selectGroup.forEach(function(e){t.push(e.groupId)}),Object(l.d)("sys_group_user",t.join(","),this.userId).then(function(t){t.success&&(e.selectGroup=[],e.$Message.success("更新成功"),e.getDepartmentData(),e.$emit("changeInstance"))}).catch(function(t){e.$Message.error(t.data.message)})}},getAllGroupData:function(e){var t=this;0===this.groupData.length&&Object(l.E)(e).then(function(e){e.tableContent.forEach(function(e){0===e.leaf?t.groupData.push({title:e.groupName,groupId:e.groupId,loading:!1,children:[]}):t.groupData.push({title:e.groupName,groupId:e.groupId})})})},loadData:function(e,t){Object(l.E)(e.groupId).then(function(e){var a=[];e.tableContent.forEach(function(e){0===e.leaf?a.push({title:e.groupName,groupId:e.groupId,loading:!1,children:[]}):a.push({title:e.groupName,groupId:e.groupId})}),t(a)})},selectNode:function(e){this.selectGroup=e}},mounted:function(){this.getDepartmentData()}},_={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"department"},[a("div",{staticClass:"department-detail",attrs:{id:"depHeight"}},[a("div",{staticClass:"department-header"},[a("b",{staticClass:"department-detail-btn",attrs:{type:"info"},on:{click:e.showGroupModal}},[e._v("部门")]),e._v(" "),a("span",{staticStyle:{color:"#7a7676"}},[e._v("-添加部门")]),e._v(" "),a("b",{staticClass:"department-detail-btn",attrs:{type:"info"},on:{click:e.deleteGroup}},[e._v("删除")]),e._v(" "),a("span",{staticStyle:{color:"#7a7676"}},[e._v("-批量删除部门")])]),e._v(" "),a("div",{staticClass:"department-table"},[a("Table",{ref:"selection",attrs:{columns:e.columns,loading:e.loading,data:e.departmentData},on:{"on-selection-change":e.selectDeleteGroup}}),e._v(" "),a("div",{staticClass:"user-page"},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:e.total,"show-elevator":"","show-sizer":"",current:e.currentPage,"page-size":e.pageSize,size:"small","show-total":""},on:{"on-page-size-change":e.onPageSizeChange,"on-change":e.onPageChange}})],1)])],1)]),e._v(" "),a("Modal",{attrs:{title:"选择部门",width:"300"},on:{"on-ok":e.addDepartment},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[a("Tree",{staticClass:"dep-tree",attrs:{multiple:!0,data:e.groupData,"load-data":e.loadData},on:{"on-select-change":e.selectNode}})],1)],1)},staticRenderFns:[]};var k=a("D8HT")(y,_,!1,function(e){a("vVwL")},"data-v-6dfd30ae",null).exports,b={name:"roleMember",components:{},props:{},data:function(){var e=this;return{userId:this.$route.params.userId,rolePage:{total:0,roletotal:0,currentPage:1,rolecurrentPage:1,pageSize:10,allRolepageSize:10},searchValue:"",loading:!0,roleLoading:!0,showModal:!1,columns:[{type:"selection",width:60,align:"center"},{title:"职位名称",key:"name"},{title:"职位类型",key:"type",render:function(e,t){var a="";switch(t.row.type){case"Y":a="营销类";break;case"C":a="操作类";break;case"J":a="技术类";break;case"M":a="管理类";break;case"Z":a="专职类"}return e("span",{},a)}},{title:"说明",key:"describe"},{title:"默认职位",key:"isDefault",align:"center",render:function(t,a){var s=!1;return 1===a.row.isDefault&&(s=!0),t("Radio",{props:{value:s},on:{"on-change":function(t){e.onClickDefaultView(a)}}})}},{title:"操作",key:"action",maxWidth:150,align:"center",render:function(t,a){return t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.$Modal.confirm({title:"确认",content:"确认删除此职位？",onOk:function(){Object(l.m)("sys_user_role",e.userId,a.row.id).then(function(t){t.success&&(e.$Message.success("删除成功！"),e.getRoleData(),e.$emit("changeInstance"))}).catch(function(t){e.$Message.error(t.data.message)})}})}}},"删除")}}],RoleColumns:[{type:"selection",width:60,align:"center"},{title:"职位名称",key:"name"},{title:"职位类型",key:"type",render:function(e,t){var a="";switch(t.row.type){case"Y":a="营销类";break;case"C":a="操作类";break;case"J":a="技术类";break;case"M":a="管理类";break;case"Z":a="专职类"}return e("span",{},a)}},{title:"说明",key:"describe"}],roleData:[],selectRoleData:[],allRoleData:[],selectDeleteRoleData:[]}},methods:{onClickDefaultView:function(e){var t=this;this.$Modal.confirm({title:"确认",content:"确认设置此职位为默认职位？",onOk:function(){t.setDefaultViews(e)},onCancel:function(){t.reRenderDefaultView()}})},setDefaultViews:function(e){var t=this;Object(l._3)(this.userId,"role",e.row.id).then(function(e){e.success&&(t.$Message.success(e.message),t.getRoleData())}).catch(function(e){t.$Message.error(e.data.message)})},reRenderDefaultView:function(){var e=this;this.columns[4].render=function(t,a){var s=!1;return 1===a.row.isDefault&&(s=!0),t("Radio",{props:{value:s},on:{"on-change":function(){e.onClickDefaultView(a)}}})}},getRoleData:function(){var e=this;this.userId?(this.loading=!0,Object(l.Q)(this.userId,this.rolePage.pageSize,this.rolePage.currentPage).then(function(t){e.roleData=t.tableContent,e.rolePage.total=t.dataCount,e.loading=!1})):this.loading=!1},onPageChange:function(e){this.rolePage.currentPage=e,this.getRoleData()},onPageSizeChange:function(e){this.rolePage.pageSize=e,this.getRoleData()},onAllRolePageSizeChange:function(e){var t=o()([{operator:"like",value:this.searchValue,property:"name"},{operator:"eq",value:1,property:"status"}]);this.rolePage.allRolepageSize=e,this.getAllRoleData(t)},onRolePageChange:function(e){var t=o()([{operator:"like",value:this.searchValue,property:"name"},{operator:"eq",value:1,property:"status"}]);this.rolePage.rolecurrentPage=e,this.getAllRoleData(t)},selectDeleteRole:function(e){this.selectDeleteRoleData=e},deleteUserRole:function(){var e=this,t=[];0===this.selectDeleteRoleData.length?this.$Message.warning("请先选择要删除的用户职位！"):(this.selectDeleteRoleData.forEach(function(e){t.push(e.id)}),this.$Modal.confirm({title:"确认",content:"确认删除选择的用户职位？",onOk:function(){Object(l.m)("sys_user_role",e.userId,t.join(",")).then(function(t){t.success&&(e.selectDeleteRoleData=[],e.$Message.success("删除成功！"),e.getRoleData(),e.$emit("changeInstance"))}).catch(function(t){e.$Message.error(t.data.message)})}}))},addRole:function(){var e=this,t=[];this.selectRoleData.length>0?this.selectRoleData.forEach(function(e){t.push(e.id)}):this.$Message.warning("请选择至少一个职位！"),t&&this.userId?Object(l.d)("sys_user_role",this.userId,t.join(",")).then(function(t){t.success&&(e.$Message.success("更新成功"),e.getRoleData(),e.$emit("changeInstance"))}).catch(function(t){e.$Message.error(t.data.message)}):this.$Message.warning("无用户ID，请先保存用户再进行编辑！")},deleteSelectUser:function(e,t){var a=this;this.selectRoleData.splice(t,1),this.$refs.selection.data.forEach(function(t,s){e.id===t.id&&a.$refs.selection.toggleSelect(s)})},onSelectionChange:function(e){if(0===e.length){var t=this.$refs.selection.data,a=this.selectRoleData;t.map(function(e){a=a.filter(function(t){return t.id!==e.id})}),this.selectRoleData=a}else{var s,o={};(s=this.selectRoleData).push.apply(s,f()(e)),this.selectRoleData=this.selectRoleData.reduce(function(e,t){return!o[t.id]&&(o[t.id]=e.push(t)),e},[])}},onSelectAll:function(e){var t,a={};(t=this.selectRoleData).push.apply(t,f()(e)),this.selectRoleData=this.selectRoleData.reduce(function(e,t){return!a[t.id]&&(a[t.id]=e.push(t)),e},[])},onSelectCancel:function(e,t){this.selectRoleData=this.selectRoleData.filter(function(e){return e.id!==t.id})},showRoleModal:function(){this.showModal=!0,this.searchValue="",this.selectRoleData=[],this.getAllRoleData()},getAllRoleData:function(e){var t=this,a=e||o()([{operator:"eq",value:1,property:"status"}]);this.roleLoading=!0,Object(l.x)(this.rolePage.allRolepageSize,this.rolePage.rolecurrentPage,a).then(function(e){t.allRoleData=e.tableContent,t.rolePage.roletotal=e.dataCount,t.roleLoading=!1,t.selectRoleData.length>0&&t.allRoleData.map(function(e){t.selectRoleData.map(function(t){e.id===t.id&&(e._checked=!0)})})})},roleFilter:function(){var e=o()([{operator:"like",value:this.searchValue,property:"name"},{operator:"eq",value:1,property:"status"}]);this.getAllRoleData(e)}},mounted:function(){this.getRoleData()}},C={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"role"},[a("div",{staticClass:"role-detail",attrs:{id:"roleHeight"}},[a("div",{staticClass:"role-header"},[a("b",{staticClass:"role-detail-btn",on:{click:e.showRoleModal}},[e._v("职位")]),e._v(" "),a("span",{staticStyle:{color:"#7a7676"}},[e._v("-添加职位")]),e._v(" "),a("b",{staticClass:"role-detail-btn",on:{click:e.deleteUserRole}},[e._v("删除")]),e._v(" "),a("span",{staticStyle:{color:"#7a7676"}},[e._v("-批量删除职位")])]),e._v(" "),a("div",{staticClass:"role-table"},[a("Table",{attrs:{columns:e.columns,loading:e.loading,data:e.roleData},on:{"on-selection-change":e.selectDeleteRole}}),e._v(" "),a("div",{staticClass:"user-page"},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:e.rolePage.total,"show-elevator":"","show-sizer":"",current:e.rolePage.currentPage,"page-size":e.rolePage.pageSize,size:"small","show-total":""},on:{"on-page-size-change":e.onPageSizeChange,"on-change":e.onPageChange}})],1)])],1)]),e._v(" "),a("Modal",{attrs:{title:"选择职位",styles:{top:"15px"},width:"1000"},on:{"on-ok":e.addRole},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[a("div",{staticClass:"app-search"},[a("Input",{staticStyle:{width:"300px"},attrs:{search:!0,placeholder:"搜索职位名称"},on:{"on-search":e.roleFilter},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}}),e._v(" "),a("p",{staticClass:"app-search-icon",on:{click:e.roleFilter}},[a("Button",{attrs:{type:"primary",size:"small"}},[e._v("查询")])],1)],1),e._v(" "),a("Table",{ref:"selection",attrs:{height:"400",loading:e.roleLoading,columns:e.RoleColumns,data:e.allRoleData},on:{"on-selection-change":e.onSelectionChange,"on-select-all":e.onSelectAll,"on-select-cancel":e.onSelectCancel}}),e._v(" "),a("div",{staticClass:"user-page"},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:e.rolePage.roletotal,"show-elevator":"","show-sizer":"",current:e.rolePage.rolecurrentPage,"page-size":e.rolePage.allRolepageSize,size:"small","show-total":""},on:{"on-page-size-change":e.onAllRolePageSizeChange,"on-change":e.onRolePageChange}})],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.selectRoleData[0],expression:"selectRoleData[0] "}],staticClass:"page-selection-warp"},e._l(e.selectRoleData,function(t,s){return a("Tag",{key:t.id,attrs:{userId:t.id,closable:"",type:"border",color:"primary",size:"small"},on:{"on-close":function(a){e.deleteSelectUser(t,s)}}},[e._v("\n            "+e._s(t.name)+"\n          ")])}))],1)],1)},staticRenderFns:[]};var D=a("D8HT")(b,C,!1,function(e){a("mhlI")},"data-v-6f3b30c0",null).exports,S={name:"directPermission",components:{PermissionModal:a("3zRX").a},props:{},data:function(){var e=this;return{userId:this.$route.params.userId,searchValue:"",type:"sys_user_permission",total:0,currentPage:1,pageSize:10,loading:!0,showModal:!1,columns:[{type:"selection",width:60,align:"center"},{title:"名称",key:"name"},{title:"操作",key:"action",width:150,align:"center",render:function(t,a){return t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.$Modal.confirm({title:"确认",content:"确认删除此权限？",onOk:function(){Object(l.l)(e.userId,a.row.id).then(function(t){t.success&&(e.$Message.success("删除成功！"),e.getDirPermissionData(),e.$emit("changeInstance"))}).catch(function(t){e.$Message.error(t.data.message)})}})}}},"删除")}}],dirPermissionData:[],selectDeletePermission:[]}},methods:{permissionChange:function(){this.getDirPermissionData(),this.$emit("changeInstance")},changeModalStatus:function(){this.showModal=!1},getDirPermissionData:function(e){var t=this;this.userId?(this.loading=!0,Object(l.D)(this.userId,this.pageSize,this.currentPage,e).then(function(e){t.dirPermissionData=e.tableContent,t.total=e.dataCount,t.loading=!1})):this.loading=!1},onPageChange:function(e){var t=o()([{operator:"like",value:this.searchValue,property:"name"}]);this.currentPage=e,this.getDirPermissionData(t)},onPageSizeChange:function(e){this.pageSize=e,this.getDirPermissionData()},deletePermission:function(){var e=this,t=[];0===this.selectDeletePermission.length?this.$Message.warning("请先选择要删除的权限！"):(this.selectDeletePermission.forEach(function(e){t.push(e.id)}),t&&this.userId&&this.$Modal.confirm({title:"确认",content:"确认删除已选的权限？",onOk:function(){Object(l.l)(e.userId,t.join(",")).then(function(t){t.success&&(e.selectDeletePermission=[],e.$Message.success("删除成功！"),e.getDirPermissionData(),e.$emit("changeInstance"))}).catch(function(t){e.$Message.error(t.data.message)})}}))},onSelectionChange:function(e){this.selectDeletePermission=e},showAddPermission:function(){this.showModal=!0},permissionFilter:function(){var e=o()([{operator:"like",value:this.searchValue,property:"name"}]);this.getDirPermissionData(e)}},mounted:function(){this.getDirPermissionData()}},P={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"direct"},[a("div",{staticClass:"direct-detail",attrs:{id:"directHeight"}},[a("div",{staticClass:"direct-header"},[a("b",{staticClass:"direct-detail-btn",on:{click:e.showAddPermission}},[e._v("添加权限")]),e._v(" "),a("span",{staticStyle:{color:"#7a7676"}},[e._v("-添加直接权限")]),e._v(" "),a("b",{staticClass:"direct-detail-btn",on:{click:e.deletePermission}},[e._v("删除权限")]),e._v(" "),a("span",{staticStyle:{color:"#7a7676"}},[e._v("-删除直接权限")]),e._v(" "),a("div",{staticClass:"app-table-search"},[a("Input",{staticStyle:{width:"300px"},attrs:{search:!0,placeholder:"搜索权限名称"},on:{"on-search":e.permissionFilter},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}}),e._v(" "),a("a",{staticClass:"app-search-icon",on:{click:e.permissionFilter}},[a("Button",{attrs:{type:"primary",size:"small"}},[e._v("查询")])],1)],1)]),e._v(" "),a("div",{staticClass:"direct-table"},[a("Table",{staticStyle:{"margin-top":"10px"},attrs:{columns:e.columns,loading:e.loading,data:e.dirPermissionData},on:{"on-selection-change":e.onSelectionChange}}),e._v(" "),a("div",{staticClass:"user-page"},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{size:"small",total:e.total,current:e.currentPage,"page-size":e.pageSize,"show-total":"","show-elevator":"","show-sizer":""},on:{"on-page-size-change":e.onPageSizeChange,"on-change":e.onPageChange}})],1)])],1)]),e._v(" "),a("permission-modal",{attrs:{permissionId:e.userId,permissionType:e.type,isShowModal:e.showModal},on:{changeModalStatus:e.changeModalStatus,permissionChange:e.permissionChange}})],1)},staticRenderFns:[]};var M={name:"indirectPermission",components:{},props:{},data:function(){return{userId:this.$route.params.userId,total:0,currentPage:1,pageSize:10,loading:!0,columns:[{type:"selection",width:60,align:"center"},{title:"名称",key:"name"},{title:"权限来源",key:"origin"}],indirPermissionData:[]}},methods:{getIndirPermissionData:function(){var e=this;this.userId?(this.loading=!0,Object(l.H)(this.userId,this.pageSize,this.currentPage).then(function(t){e.indirPermissionData=t.tableContent,e.total=t.dataCount,e.loading=!1})):this.loading=!1},onPageChange:function(e){this.currentPage=e,this.getIndirPermissionData()},onPageSizeChange:function(e){this.pageSize=e,this.getIndirPermissionData()}},mounted:function(){this.getIndirPermissionData()}},U={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"indirect"},[a("div",{staticClass:"indirect-detail",attrs:{id:"indirectHeight"}},[a("Table",{ref:"selection",attrs:{columns:e.columns,loading:e.loading,data:e.indirPermissionData}}),e._v(" "),a("div",{staticClass:"user-page"},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:e.total,"show-elevator":"","show-sizer":"",current:e.currentPage,"page-size":e.pageSize,size:"small","show-total":""},on:{"on-page-size-change":e.onPageSizeChange,"on-change":e.onPageChange}})],1)])],1)])},staticRenderFns:[]};var z={name:"workflowTask",components:{},props:{},data:function(){var e=this;return{userId:this.$route.params.userId,total:0,currentPage:1,pageSize:10,loading:!0,columns:[{type:"selection",width:60,align:"center"},{title:"任务编号",key:"taskId",render:function(e,t){var a=!0;return 1===t.row.type&&(a=!1),e("div",[e("Badge",{props:{dot:a},style:{marginRight:"5px",paddingBottom:"8px"}}),e("span",{},t.row.taskId)])}},{title:"流程交易号",key:"businessKey",render:function(e,t){return e("a",{on:{click:function(){window.open("/Form/index.html?data="+t.row.businessKey)}}},t.row.businessKey)}},{title:"操作名称",key:"nodeName",render:function(e,t){return e("a",{on:{click:function(){window.open("/Form/index.html?data="+t.row.businessKey)}}},t.row.nodeName)}},{title:"应用名称",key:"processName"},{title:"经办人",key:"handlerName2"},{title:"发起人",key:"crtName"},{title:"部门",key:"handlerUnitName",ellipsis:!0},{title:"创建时间",key:"startTime"},{title:"表单状态",key:"baseinfoStatus",render:function(e,t){return 0===t.row.baseinfoStatus?e("b",{style:{color:"#999"}},"草稿"):1===t.row.baseinfoStatus?e("b",{style:{color:"#e4393c"}},"已生效"):e("b",{style:{color:"#19be6b"}},"进行中")}},{title:"已过时间",key:"orig",render:function(t,a){return t("span",{},e.calcLeadTime(a.row.startTime))}}],worlflowTaskData:[]}},methods:{getWorkflowTaskData:function(){var e=this;this.userId?(this.loading=!0,Object(l.T)(this.userId,this.currentPage,this.pageSize).then(function(t){e.worlflowTaskData=t.tableContent,e.total=t.dataCount,e.loading=!1})):this.loading=!1},onPageChange:function(e){this.currentPage=e,this.getWorkflowTaskData()},onPageSizeChange:function(e){this.pageSize=e,this.getWorkflowTaskData()},calcLeadTime:function(e){var t=new Date(e.replace(/-/g,"/")),a=(new Date).getTime()-t.getTime(),s=a%864e5,o=s%36e5,i=o%6e4;return Math.floor(a/864e5)+"天"+Math.floor(s/36e5)+"时"+Math.floor(o/6e4)+"分"+Math.round(i/1e3)+"秒"}},mounted:function(){this.getWorkflowTaskData()}},$={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"workflow"},[a("div",{staticClass:"workflow-detail"},[a("Table",{ref:"selection",attrs:{columns:e.columns,loading:e.loading,data:e.worlflowTaskData}}),e._v(" "),a("div",{staticClass:"user-page"},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:e.total,"show-elevator":"","show-sizer":"",current:e.currentPage,"page-size":e.pageSize,size:"small","show-total":""},on:{"on-page-size-change":e.onPageSizeChange,"on-change":e.onPageChange}})],1)])],1)])},staticRenderFns:[]};var R={name:"detail",components:{UserInfo:h,HigherUser:m,LowerUser:I,DepartmentMember:k,RoleMember:D,DirectPermission:a("D8HT")(S,P,!1,function(e){a("1jer")},"data-v-de4d7ab0",null).exports,IndirectPermission:a("D8HT")(M,U,!1,function(e){a("pk3O")},"data-v-2f51639e",null).exports,WorkfowTask:a("D8HT")(z,$,!1,function(e){a("3rDw")},"data-v-8f674a4c",null).exports},props:{},data:function(){return{userId:this.$route.params.userId,showTag:!0,whichShow:{userinfo:!0,highuser:!1,lowuser:!1,dep:!1,role:!1,dirper:!1,indirper:!1,workflow:!1},userInformation:{},relativeInstance:[{name:"工作流任务",showName:"workflow",isShow:!0,isShowAcive:!1,relativeNum:0,type:"md-menu"},{name:"间接权限",showName:"indirper",isShow:!0,isShowAcive:!1,relativeNum:0,type:"ios-people"},{name:"直接权限",showName:"dirper",isShow:!0,isShowAcive:!1,relativeNum:0,type:"md-person"},{name:"职位",showName:"role",isShow:!0,isShowAcive:!1,relativeNum:0,imgUrl:"resources/images/icon/job.png"},{name:"部门",showName:"dep",isShow:!0,isShowAcive:!1,relativeNum:0,imgUrl:"resources/images/icon/organization.png"},{name:"下级用户",showName:"lowuser",isShow:!0,isShowAcive:!1,relativeNum:0,imgUrl:"buildresources/images/icon/user.png"},{name:"上级用户",showName:"highuser",isShow:!0,isShowAcive:!1,relativeNum:0,imgUrl:"resources/images/icon/user.png"},{name:"基本信息",showName:"userinfo",isShow:!0,isShowAcive:!0,type:"ios-home"}]}},created:function(){},methods:{onClickTab:function(e){var t=this;this.relativeInstance.forEach(function(a,s){e===s?(a.isShowAcive=!0,t.whichShow[a.showName]=!0):(a.isShowAcive=!1,t.whichShow[a.showName]=!1)})},getUserInfoData:function(){var e=this;this.userId&&Object(l.S)(this.userId).then(function(t){e.userInformation=t.tableContent[0],1===e.userInformation.status?e.userInformation.statusText="使用中":-1===e.userInformation.status?e.userInformation.statusText="停用":3===e.userInformation.status?e.userInformation.statusText="草稿":e.userInformation.statusText="未使用"})},getInstanceCount:function(){var e=this;this.userId&&Object(l.J)(this.userId).then(function(t){e.relativeInstance[0].relativeNum=t.workFlow,e.relativeInstance[1].relativeNum=t.SysPermission,e.relativeInstance[2].relativeNum=t.objectPermission,e.relativeInstance[3].relativeNum=t.role,e.relativeInstance[4].relativeNum=t.group,e.relativeInstance[5].relativeNum=t.subordinate,e.relativeInstance[6].relativeNum=t.superior})}},mounted:function(){this.getUserInfoData(),this.getInstanceCount()}},x={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Row",{staticClass:"detail"},[a("Row",{staticClass:"detail-user-header"},[a("div",{staticClass:"detail-header-bread"},[a("span",{staticClass:"detail-user-header-bread-user"},[e._v("用户")]),e._v(" "),a("span",{staticClass:"detail-user-header-bread-others"},[e._v("/")]),e._v(" "),e.userInformation.nickname?a("span",{staticClass:"detail-user-header-bread-others"},[e._v("\n        "+e._s(e.userInformation.nickname)+"\n      ")]):e._e(),e._v(" "),a("span",{staticClass:"detail-user-header-bread-others"},[e._v(e._s(e.userInformation.userCode?"":"创建"))]),e._v(" "),a("Tag",{directives:[{name:"show",rawName:"v-show",value:e.userInformation.status?e.showTag:!e.showTag,expression:"userInformation.status?showTag:!showTag"},{name:"instanceStateDirective",rawName:"v-instanceStateDirective",value:{status:e.userInformation.status},expression:"{status:userInformation.status}"}],staticClass:"radius10 marlr10 color_fff"})],1)]),e._v(" "),a("Row",{staticClass:"detail-tabs"},e._l(e.relativeInstance,function(t,s){return(e.userInformation.userId?t.isShow:t.isShowAcive)?a("div",{key:s,class:{"detail-tabs-child":!0,"active-item":t.isShowAcive},on:{click:function(t){e.onClickTab(s)}}},[t.type?a("Icon",{staticClass:"icon",attrs:{type:t.type}}):a("img",{attrs:{src:t.imgUrl}}),e._v(" "),a("div",{staticClass:"detail-tabs-child-right"},[a("span",[e._v(e._s(t.relativeNum))]),e._v(" "),a("p",[e._v(e._s(t.name))])])],1):e._e()})),e._v(" "),a("Row",{staticClass:"detail-content-tabs"},[a("user-info",{directives:[{name:"show",rawName:"v-show",value:e.whichShow.userinfo,expression:"whichShow.userinfo"}],attrs:{userInfo:e.userInformation}}),e._v(" "),e.whichShow.highuser?a("higher-user",{on:{changeInstance:e.getInstanceCount}}):e._e(),e._v(" "),e.whichShow.lowuser?a("lower-user",{on:{changeInstance:e.getInstanceCount}}):e._e(),e._v(" "),e.whichShow.dep?a("department-member",{on:{changeInstance:e.getInstanceCount}}):e._e(),e._v(" "),e.whichShow.role?a("role-member",{on:{changeInstance:e.getInstanceCount}}):e._e(),e._v(" "),e.whichShow.dirper?a("direct-permission",{on:{changeInstance:e.getInstanceCount}}):e._e(),e._v(" "),e.whichShow.indirper?a("indirect-permission"):e._e(),e._v(" "),e.whichShow.workflow?a("workfow-task"):e._e()],1)],1)},staticRenderFns:[]};var O=a("D8HT")(R,x,!1,function(e){a("jT1h")},"data-v-45ea2cb1",null);t.default=O.exports},"3rDw":function(e,t){},K8UT:function(e,t){},MEDl:function(e,t,a){var s=a("dwHk"),o=a("hkgF"),i=a("jg1N");e.exports=function(e,t){var a=(o.Object||{})[e]||Object[e],n={};n[e]=t(a),s(s.S+s.F*i(function(){a(1)}),"Object",n)}},cfvZ:function(e,t,a){e.exports={default:a("t5rF"),__esModule:!0}},hhkS:function(e,t){},jT1h:function(e,t){},mhlI:function(e,t){},pk3O:function(e,t){},t5rF:function(e,t,a){a("+7eS"),e.exports=a("hkgF").Object.keys},vVwL:function(e,t){},xRDx:function(e,t){}});
{"source":"webpackJsonp([28],{\"0e4j\":function(t,a){},\"75EL\":function(t,a,e){\"use strict\";Object.defineProperty(a,\"__esModule\",{value:!0});var o=e(\"GIAq\"),i=e(\"mvHQ\"),p=e.n(i),n=e(\"oAV5\"),s={name:\"appInfo\",components:{},props:{listId:String,appData:Object,isAdmin:Boolean,isCompanyAdmin:Boolean},data:function(){return{httpHeaders:{Authorization:Object(n.c)()},showEditAppInfo:!0,showAppEditAdmin:!0,showEditBtn:!0,adminLoading:!0,showAdminModal:!1,searchValue:\"\",total:0,currentPage:1,pageSize:10,adminColumns:[{title:\"头像\",key:\"photo\",width:80,render:function(t,a){return t(\"div\",[t(\"img\",{attrs:{src:a.row.photo?a.row.photo:\"/resources/images/icon/defaultUserPhoto.jpg\"},style:{borderRadius:\"50%\",height:\"32px\",width:\"32px\"}})])}},{title:\"工号\",key:\"userCode\"},{title:\"姓名\",key:\"nickname\"},{title:\"手机\",key:\"mobile\"},{title:\"邮箱\",key:\"email\"}],adminData:[],selectAdminData:{}}},methods:{handleReview:function(){this.appData.icon=this.appData.defaultIcon},handleRemove:function(){this.appData.icon=\"\",this.$refs.upload.fileList.splice(0,this.$refs.upload.fileList.length)},handleSuccess:function(t,a){this.appData.icon=\"/H_roleplay-si/ds/download?width=100&height=100&url=\"+t.data[0].attacthment},handleMaxSize:function(t){this.$Notice.warning({title:\"文件大小超出范围\",desc:\"文件大小最大为2M\"})},handleFormatError:function(t){this.$Notice.warning({title:\"文件格式不对\",desc:\"请上传格式为png 、jpeg 或者 jpg 的图片\"})},goList:function(){\"000001\"===this.appData.uniqueId?window.top.location.href=\"/Site/index.html#page/users\":\"000002\"===this.appData.uniqueId?window.top.location.href=\"/Site/index.html#page/origanizations\":\"000003\"===this.appData.uniqueId?window.top.location.href=\"/Site/index.html#page/jobs\":\"000004\"===this.appData.uniqueId?window.top.location.href=\"/Site/index.html#page/companys\":\"subject\"===this.appData.type?window.top.location.href=\"/Site/index.html#subject/\"+this.appData.uniqueId:window.top.location.href=\"/Site/index.html#list/\"+this.appData.uniqueId},clearAdmintrstor:function(){\"\"===this.appData.administrator&&(this.appData.userId=\"\")},childHasPublished:function(t){this.appData.publish=1},editAppinfo:function(){var a=this;if(this.isAdmin&&(this.showEditAppInfo=!this.showEditAppInfo),this.isCompanyAdmin&&(this.showAppEditAdmin=!1),!this.showEditBtn){var t={uniqueId:this.appData.uniqueId,title:this.appData.title,administrator:this.appData.userId,comment:this.appData.comment.replace(/\\r\\n/g,\"<br>\").replace(/\\n/g,\"<br>\").replace(/\\s/g,\" \"),customIcon:this.appData.icon};Object(o._2)(t).then(function(t){t.success&&(a.$Message.success(\"更新成功!\"),a.showAppEditAdmin=!0,a.$emit(\"reloadData\"))})}this.showEditBtn=!this.showEditBtn},selectAdminModal:function(){this.showAdminModal=!0,this.searchValue=\"\",this.getAdmintrstorData()},confirmModal:function(){this.appData.administrator=this.selectAdminData.nickname,this.appData.userId=this.selectAdminData.userId},dbclickConfirmModal:function(t){this.appData.administrator=t.nickname,this.appData.userId=t.userId,this.showAdminModal=!1},selectAdmin:function(t,a){this.selectAdminData=t},getAdmintrstorData:function(t){var a=this;this.adminLoading=!0,Object(o.r)(t,this.currentPage,this.pageSize).then(function(t){a.adminData=t.tableContent,a.total=t.dataCount,a.adminLoading=!1})},changeAppStatus:function(a){var e=this,t=this.listId,i=p()([{operator:\"eq\",value:\"操作\",property:\"type\"}]),n=[],s=[];Object(o.u)(t,i).then(function(t){t.tableContent.forEach(function(t){n.push(t.id),\"查看\"!=t.name&&s.push(t.id)}),\"enabled\"===a?Object(o.o)(n.join(\",\")).then(function(t){t.success&&(e.$Message.success(t.message),e.$emit(\"enabledForbiddenAppPermission\"))}):Object(o.o)(null,s.join(\",\")).then(function(t){t.success&&(e.$Message.success(t.message),e.$emit(\"enabledForbiddenAppPermission\"))})})},onPageChange:function(t){this.currentPage=t;var a=p()([{operator_1:\"like\",value_1:this.searchValue,property_1:\"nickname\",link:\"or\",operator_2:\"like\",value_2:this.searchValue,property_2:\"userCode\"}]);this.getAdmintrstorData(a)},adminFilter:function(){var t=p()([{operator_1:\"like\",value_1:this.searchValue,property_1:\"nickname\",link:\"or\",operator_2:\"like\",value_2:this.searchValue,property_2:\"userCode\"}]);this.getAdmintrstorData(t)}},mounted:function(){this.listId;this.getAdmintrstorData()}},r=e(\"GlcG\"),d=e.n(r);var c=function(t){e(\"0e4j\")},l={name:\"detail\",components:{AppInfo:e(\"VU/8\")(s,d.a,!1,c,\"data-v-2bb78794\",null).exports},data:function(){return{listId:this.$route.params.listId,appData:{},enforData:[],isAdmin:!1,isCompanyAdmin:!1,isAddress:!1,appType:\"\",appTransType:\"\",enabledForbidden:-1}},methods:{enabledForbiddenAppPermission:function(){this.enabledForbidden++},getAppInfoDatas:function(){var a=this,t=this.listId,e=this.$currentUser,i=[];Object(o.Q)(t).then(function(t){a.appData=t[0],a.appData.comment&&(a.appData.comment=a.appData.comment.replace(/<br>/g,\"\\r\\n\")),a.appType=a.appData.type,a.appTransType=a.appData.transType,e.isSysRoleList.forEach(function(t){i.push(t.id)}),a.appData.administrator?e.nickname===a.appData.administrator&&-1<i.indexOf(1)?(a.isAdmin=!0,a.isCompanyAdmin=!0):e.nickname==a.appData.administrator?a.isAdmin=!0:-1<i.indexOf(1)?(a.isCompanyAdmin=!0,a.isAdmin=!1):(a.isAdmin=!1,a.isCompanyAdmin=!1):-1<i.indexOf(1)?(a.isAdmin=!0,a.isCompanyAdmin=!0):(a.isAdmin=!1,a.isCompanyAdmin=!1),\"hr\"===a.appData.type&&(a.isAddress=!0)})},reloadData:function(){this.getAppInfoDatas()}},created:function(){this.getAppInfoDatas()}},m=e(\"IKuO\"),h=e.n(m);var u=function(t){e(\"PKrO\")},v=e(\"VU/8\")(l,h.a,!1,u,\"data-v-1c01b3e9\",null);a.default=v.exports},GlcG:function(t,a){t.exports={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e(\"div\",{staticClass:\"app-card\"},[e(\"header\",{staticClass:\"app-header\"},[e(\"Breadcrumb\",[e(\"BreadcrumbItem\",[a._v(\"首页\")]),a._v(\" \"),e(\"BreadcrumbItem\",[a._v(\"应用列表\")]),a._v(\" \"),e(\"BreadcrumbItem\",[a._v(a._s(a.appData.title))])],1)],1),a._v(\" \"),e(\"Row\",{staticClass:\"font14\",staticStyle:{height:\"220px\"}},[e(\"div\",{staticClass:\"app-left\"},[a.showEditBtn?e(\"img\",{staticClass:\"appIcon\",attrs:{src:!!a.appData.icon&&a.appData.icon}}):e(\"Upload\",{ref:\"upload\",staticClass:\"info-upload\",attrs:{\"show-upload-list\":!1,\"on-success\":a.handleSuccess,format:[\"jpg\",\"jpeg\",\"png\"],\"max-size\":2048,\"on-format-error\":a.handleFormatError,\"on-exceeded-size\":a.handleMaxSize,type:\"drag\",action:\"/H_roleplay-si/ds/upload\",headers:a.httpHeaders}},[a.appData.icon?a._e():e(\"div\",{staticClass:\"info-upload-container\"},[a.appData.icon?e(\"img\",{attrs:{src:a.appData.icon}}):a._e(),a._v(\" \"),a.appData.icon?a._e():e(\"i\",{staticClass:\"iconfont\"},[a._v(\"\")])]),a._v(\" \"),a.appData.icon?e(\"div\",{staticClass:\"demo-upload-list info-upload-container\"},[e(\"img\",{attrs:{src:a.appData.icon}}),a._v(\" \"),e(\"div\",{staticClass:\"demo-upload-list-cover\"},[e(\"Icon\",{attrs:{type:\"ios-trash-outline\",color:\"#fff\",size:\"30\"},on:{click:function(t){return t.stopPropagation(),a.handleRemove(t)}}}),a._v(\" \"),e(\"Poptip\",{attrs:{trigger:\"hover\",transfer:\"\",content:\"还原为默认图标\",placement:\"right\"}},[e(\"Icon\",{attrs:{type:\"md-share-alt\",color:\"#fff\",size:\"30\"},on:{click:function(t){return t.stopPropagation(),a.handleReview(t)}}})],1)],1)]):a._e()])],1),a._v(\" \"),e(\"div\",{staticClass:\"app-middle\"},[e(\"h3\",{staticStyle:{\"padding-left\":\"5px\"}},[e(\"span\",{staticClass:\"app-detail-title\",on:{click:a.goList}},[a._v(a._s(a.appData.title?a.appData.title:\"待加载\")+\"\\n          \")]),a._v(\"  - 应用详情\\n        \")]),a._v(\" \"),e(\"Row\",{staticClass:\"pad5\"},[e(\"Col\",{attrs:{span:\"6\"}},[a._v(\"应用名称： \\n            \"),a.showAppEditAdmin?e(\"span\",[a._v(a._s(a.appData.title))]):e(\"Input\",{staticStyle:{width:\"120px\"},model:{value:a.appData.title,callback:function(t){a.$set(a.appData,\"title\",t)},expression:\"appData.title\"}}),a._v(\" \"),a.isCompanyAdmin?e(\"b\",{on:{click:a.editAppinfo}},[a.showEditBtn?e(\"Tooltip\",{attrs:{content:\"编辑\",placement:\"top\"}},[e(\"Icon\",{staticClass:\"app-edit-icon\",attrs:{type:\"ios-create-outline\"}})],1):e(\"Tooltip\",{attrs:{content:\"保存\",placement:\"top\"}},[e(\"b\",{staticClass:\"app-save-icon\"},[a._v(\"保存\")])])],1):a._e()],1),a._v(\" \"),e(\"Col\",{attrs:{span:\"6\"}},[a._v(\"应用类型： \"),e(\"span\",[a._v(a._s(a.appData.TRANS_NAME))])]),a._v(\" \"),e(\"Col\",{attrs:{span:\"6\"}},[a._v(\"应用管理员： \\n            \"),a.showAppEditAdmin?e(\"span\",[e(\"Icon\",{attrs:{type:\"person\"}}),a._v(a._s(a.appData.administrator)+\"\\n            \")],1):e(\"Input\",{staticStyle:{width:\"100px\"},attrs:{icon:\"md-arrow-dropdown\"},on:{\"on-click\":a.selectAdminModal,\"on-change\":a.clearAdmintrstor},model:{value:a.appData.administrator,callback:function(t){a.$set(a.appData,\"administrator\",t)},expression:\"appData.administrator\"}})],1)],1),a._v(\" \"),e(\"Row\",{staticClass:\"pad5\"},[e(\"Col\",{attrs:{span:\"6\"}},[a._v(\"创建者： \"),e(\"span\",[a._v(a._s(a.appData.creator))])]),a._v(\" \"),e(\"Col\",{attrs:{span:\"6\"}},[a._v(\"创建时间： \"),e(\"span\",[a._v(a._s(a.appData.crtTime))])]),a._v(\" \"),e(\"Col\",{attrs:{span:\"6\"}},[a._v(\"修改者：\"+a._s(a.appData.modifer))]),a._v(\" \"),e(\"Col\",{attrs:{span:\"6\"}},[a._v(\"修改时间： \"),e(\"span\",[a._v(a._s(a.appData.modTime))])])],1),a._v(\" \"),e(\"Row\",{staticClass:\"pad5\"},[e(\"Col\",{attrs:{span:\"24\"}},[a._v(\"说明：\\n            \"),a.showAppEditAdmin?e(\"pre\",{staticClass:\"app-pre\"},[a._v(a._s(a.appData.comment))]):a._e(),a._v(\" \"),e(\"Input\",{directives:[{name:\"show\",rawName:\"v-show\",value:!a.showAppEditAdmin,expression:\"!showAppEditAdmin\"}],attrs:{type:\"textarea\"},model:{value:a.appData.comment,callback:function(t){a.$set(a.appData,\"comment\",t)},expression:\"appData.comment\"}})],1)],1)],1),a._v(\" \"),e(\"div\",{staticClass:\"app-right\"},[e(\"Dropdown\",{staticClass:\"app-dropdown\",on:{\"on-click\":a.changeAppStatus}},[e(\"a\",{attrs:{href:\"javascript:void(0)\"}},[a._v(\"\\n                  操作\\n                  \"),e(\"Icon\",{attrs:{type:\"ios-arrow-down\"}})],1),a._v(\" \"),a.isAdmin?e(\"DropdownMenu\",{attrs:{slot:\"list\"},slot:\"list\"},[e(\"DropdownItem\",{attrs:{name:\"enabled\"}},[a._v(\"启用\")]),a._v(\" \"),e(\"DropdownItem\",{attrs:{name:\"forbidden\"}},[a._v(\"停用\")])],1):a._e()],1)],1)]),a._v(\" \"),e(\"Modal\",{attrs:{title:\"请选择管理员\",width:\"800\"},on:{\"on-ok\":a.confirmModal},model:{value:a.showAdminModal,callback:function(t){a.showAdminModal=t},expression:\"showAdminModal\"}},[e(\"div\",{staticClass:\"app-search\"},[e(\"Input\",{staticStyle:{width:\"300px\"},attrs:{search:!0,placeholder:\"搜索名称或工号\"},on:{\"on-search\":a.adminFilter},model:{value:a.searchValue,callback:function(t){a.searchValue=t},expression:\"searchValue\"}}),a._v(\" \"),e(\"p\",{staticClass:\"app-search-icon\",on:{click:a.adminFilter}},[e(\"Button\",{attrs:{type:\"primary\",size:\"small\"}},[a._v(\"查询\")])],1)],1),a._v(\" \"),e(\"Table\",{attrs:{\"highlight-row\":!0,loading:a.adminLoading,height:\"300\",stripe:\"\",columns:a.adminColumns,size:\"small\",data:a.adminData},on:{\"on-row-dblclick\":a.dbclickConfirmModal,\"on-row-click\":a.selectAdmin}}),a._v(\" \"),e(\"div\",{staticClass:\"user-page\"},[e(\"div\",{staticStyle:{float:\"right\"}},[e(\"Page\",{attrs:{total:a.total,current:a.currentPage,\"page-size\":a.pageSize,size:\"small\",\"show-total\":\"\"},on:{\"on-change\":a.onPageChange}})],1)])],1)],1)},staticRenderFns:[]}},IKuO:function(t,a){t.exports={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e(\"div\",{staticClass:\"app-details\"},[e(\"app-info\",{attrs:{listId:this.$route.params.listId,enforData:t.enforData,isAdmin:t.isAdmin,isCompanyAdmin:t.isCompanyAdmin,appData:t.appData},on:{reloadData:t.reloadData,enabledForbiddenAppPermission:t.enabledForbiddenAppPermission}}),t._v(\" \"),e(\"Menu\",{attrs:{mode:\"horizontal\",theme:\"light\",\"active-name\":t.$route.name}},[e(\"router-link\",{attrs:{to:{name:\"change-log\"}}},[e(\"MenuItem\",{attrs:{name:\"change-log\"}},[t._v(\"\\n        更新日志\\n      \")])],1),t._v(\" \"),e(\"router-link\",{attrs:{to:{name:\"analysis\"}}},[e(\"MenuItem\",{attrs:{name:\"analysis\"}},[t._v(\"\\n        数据分析\\n      \")])],1),t._v(\" \"),e(\"router-link\",{attrs:{to:{name:\"interaction\"}}},[e(\"MenuItem\",{attrs:{name:\"interaction\"}},[t._v(\"\\n        互动评论\\n      \")])],1),t._v(\" \"),e(\"router-link\",{attrs:{to:{name:\"permission\"}}},[e(\"MenuItem\",{attrs:{name:\"permission\"}},[t._v(\"\\n        资源授权\\n      \")])],1),t._v(\" \"),e(\"router-link\",{attrs:{to:{name:\"connection\",params:{appTransType:t.appTransType}}}},[e(\"MenuItem\",{attrs:{name:\"connection\"}},[t._v(\"\\n        连接&API\\n      \")])],1)],1),t._v(\" \"),e(\"div\",{staticClass:\"detail-content\"},[e(\"router-view\",{attrs:{listId:this.$route.params.listId,isAdmin:t.isAdmin,isAddress:t.isAddress,appType:t.appType,appTransType:t.appTransType,isCompanyAdmin:t.isCompanyAdmin,enabledForbidden:t.enabledForbidden}})],1)],1)},staticRenderFns:[]}},PKrO:function(t,a){}});"}
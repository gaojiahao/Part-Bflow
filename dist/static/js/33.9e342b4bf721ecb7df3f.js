webpackJsonp([33],{"4HqH":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("mvHQ"),s=a.n(n),o=a("UzZq"),i={name:"FlowtaskAll",data:function(){var a=this;return{columns:[{title:"任务编号",key:"taskId",width:90,render:function(e,t){var a=!0;return 1===t.row.type&&(a=!1),e("div",[e("Badge",{props:{dot:a},style:{marginRight:"5px",paddingBottom:"8px"}}),e("span",{},t.row.taskId)])}},{title:"交易号",slot:"businessKey",width:160},{title:"往来",key:"dealerName",width:140},{title:"操作名称",key:"nodeName",width:160},{title:"应用名称",key:"processName",width:160},{title:"经办人",key:"handlerName2",width:80},{title:"发起人",key:"crtName",width:80},{title:"待办创建时间",key:"crtTime",width:150},{title:"已过小时数",key:"pastTimeHour",width:120,sortable:"custom",render:function(e,t){return e("span",{},a.calcLeadTime(t.row.startTime,!0))}},{title:"已过时间",key:"crtTime",width:150,render:function(e,t){return e("span",{},a.calcLeadTime(t.row.startTime))}}],data:[],pageInfo:{limit:30,page:1,total:0,filter:[]},sortColumn:null,searchkeywords:"",tableHeight:1}},methods:{onSortChange:function(e){"normal"===e.order?(delete this.pageInfo.sort,this.sortColumn=null):this.sortColumn=[{property:e.key,direction:e.order}],this.getFlowAllTasks()},getFlowAllTasks:function(){var t=this;this.pageInfo.filter=s()([{link:"or",operator_1:"like",value_1:this.searchkeywords,property_1:"businessKey",operator_2:"like",value_2:this.searchkeywords,property_2:"dealerName"}]),this.sortColumn&&(this.pageInfo.sort=s()(this.sortColumn)),Object(o.e)(this.pageInfo).then(function(e){t.data=e.tableContent,t.pageInfo.total=e.dataCount})},handlePageChange:function(e){this.pageInfo.page=e,this.getFlowAllTasks()},handlePageSizeChange:function(e){this.pageInfo.limit=e,this.getFlowAllTasks()},handleSearch:function(){this.pageInfo.page=1,this.getFlowAllTasks()},calcLeadTime:function(e,t){var a=new Date(e.replace(/-/g,"/")),n=(new Date).getTime()-a.getTime(),s=Math.floor(n/864e5),o=n%864e5,i=Math.floor(o/36e5),r=o%36e5,l=Math.floor(r/6e4),c=r%6e4,h=Math.round(c/1e3);return t?24*s+i+"小时":s+"天"+i+"时"+l+"分"+h+"秒"},subscribeMessage:function(){var t=this;this.$deepstream.event.subscribe("taskChange/"+this.$currentUser.userId,function(e){t.getFlowAllTasks()})}},mounted:function(){var e=this;this.getFlowAllTasks(),this.subscribeMessage(),this.tableHeight=document.body.clientHeight-200,window.onresize=function(){e.tableHeight=document.body.clientHeight-200}}},r=a("W/2M"),l=a.n(r);var c=function(e){a("OYpN")},h=a("VU/8")(i,l.a,!1,c,"data-v-93904f1c",null);t.default=h.exports},OYpN:function(e,t){},"W/2M":function(e,t){e.exports={render:function(){var a=this,e=a.$createElement,n=a._self._c||e;return n("div",{staticClass:"alltask"},[n("div",{staticClass:"alltask-header"},[a._v("\n        我的所有任务\n    ")]),a._v(" "),n("div",{staticClass:"alltask-content"},[n("div",{staticClass:"alltask-content-container shadow"},[n("div",{staticClass:"alltask-content-container-toolbar"},[n("Input",{staticClass:"alltask-content-container-toolbar-search",attrs:{search:"",placeholder:"输入交易号或往来对象查询"},on:{"on-enter":a.handleSearch,"on-change":a.handleSearch},model:{value:a.searchkeywords,callback:function(e){a.searchkeywords=e},expression:"searchkeywords"}})],1),a._v(" "),n("Table",{staticClass:"alltask-content-table",attrs:{columns:a.columns,data:a.data,height:a.tableHeight},on:{"on-sort-change":a.onSortChange},scopedSlots:a._u([{key:"businessKey",fn:function(e){var t=e.row;return[n("a",{attrs:{href:"/Form/index.html?data="+t.businessKey,target:"_blank"}},[a._v(a._s(t.businessKey))])]}}])}),a._v(" "),n("Page",{staticClass:"alltask-content-page",attrs:{total:a.pageInfo.total,"page-size":a.pageInfo.limit,current:a.pageInfo.page,"show-total":"",size:"small","show-elevator":"","show-sizer":"","prev-text":"上一页","next-text":"下一页"},on:{"on-page-size-change":a.handlePageSizeChange,"on-change":a.handlePageChange}})],1)])])},staticRenderFns:[]}}});
webpackJsonp([8],{"0jEs":function(t,e){},"3eNe":function(t,e){},"9iX7":function(t,e){},Cetb:function(t,e){},W3wg:function(t,e){},bJtM:function(t,e,n){"use strict";var s=n("mvHQ"),i=n.n(s),o=n("GIAq"),a=n("3ovf"),c=n("ejmB"),r={name:"childComments",components:{MyPopTip:a.a,commentPublish:c.a},props:{comments:{type:Array,default:function(){return[]}},superComment:{type:Object,default:function(){return{}}}},data:function(){return{userInfo:{},cmtsMap:{}}},methods:{handlerShowThumbsUpInfo:function(t){this.$forceUpdate(),this.comments.map(function(e){e.id!=t.id&&(e.showPraises=!1),t.showReply=!1}),t.showPraises=!t.showPraises},handleThumbsUp:function(t){var e=this,n=t.id;Object(o.e)({commentId:n}).then(function(s){if(s.success){var a={commentId:n,limit:50,page:1,sort:i()([{property:"crtTime",direction:"DESC"}])};t.isPraise=!0,Object(o.x)(a).then(function(e){t.praises=e.tableContent})}else e.$Notice.warning({title:"系统提示",desc:"点赞,您可以尝试再次点赞或者联系企业管理员哦!"})})},handleShowReply:function(t){this.$forceUpdate(),this.comments.map(function(e){e.id!=t.id&&(e.showReply=!1),t.showPraises=!1}),t.showReply=!t.showReply},handleReplyPublish:function(t,e,n,s){var a=this,c={type:n.type,content:t,relationKey:n.relationKey,parentId:n.id,commentAttachments:e,commentAndReply:s};Object(o.M)(c).then(function(t){if(t.success){var e={parentId:a.superComment.id,limit:50,page:1,sort:i()([{property:"crtTime",direction:"DESC"}])};a.getLowerComments(e,a.superComment)}else a.$Notice.warning({title:"系统提示",desc:"添加回复,请联系企业管理员!"})})},showUserInfo:function(t){var e=this;Object(o.F)(t).then(function(t){t.dataCount&&(e.userInfo=t.tableContent[0])})},getLowerComments:function(t,e){Object(o.z)(t).then(function(t){e.childComment=t.tableContent,e.childCommentNum=t.dataCount})}},mounted:function(){}},l={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"child-comments"},t._l(t.comments,function(e,s){return n("div",{key:s,staticClass:"child-comments-item"},[n("p",[n("my-pop-tip",{attrs:{userInfo:t.userInfo,trigger:"click"}},[n("span",{staticClass:"child-comments-user",attrs:{slot:"userCard"},on:{click:function(n){t.showUserInfo(e.creator)}},slot:"userCard"},[t._v(t._s(e.creatorName)+"\n            ")])]),t._v(" "),n("span",[t._v(":回复")]),t._v(" "),n("span",{staticClass:"child-comments-user"},[t._v("@")]),t._v(" "),n("my-pop-tip",{attrs:{userInfo:t.userInfo,trigger:"click"}},[n("span",{staticClass:"child-comments-user",attrs:{slot:"userCard"},on:{click:function(n){t.showUserInfo(e.replyUserId)}},slot:"userCard"},[t._v(t._s(e.replyUserName)+"\n                ")])]),t._v(" "),n("span",[t._v(":")]),t._v(" "),n("span",{domProps:{innerHTML:t._s(e.content)}})],1),t._v(" "),n("p",[n("span",{directives:[{name:"overTimeDirective",rawName:"v-overTimeDirective",value:{time:e.crtTime},expression:"{time:comment.crtTime}"}]}),t._v(" "),n("span",{staticClass:"fr"},[n("span",{staticClass:"cursor-pointer",on:{click:function(n){t.handleShowReply(e)}}},[t._v("回复")]),t._v(" "),n("span",{staticClass:"cursor-pointer",class:{"comment-isPraise":e.isPraise}},[n("Icon",{attrs:{type:"md-thumbs-up",size:"18"},on:{click:function(n){t.handleThumbsUp(e)}}}),t._v("\n                    "+t._s(e.praises.length)+"\n                ")],1),t._v(" "),e.praises.length>0?n("span",{staticClass:"cursor-pointer"},[n("Icon",{attrs:{type:"ios-arrow-down",size:"18"},on:{click:function(n){t.handlerShowThumbsUpInfo(e)}}})],1):t._e()])]),t._v(" "),e.showReply?n("commentPublish",{attrs:{handlePublish:t.handleReplyPublish,superComment:e,allowFile:!1,ischild:!0}}):t._e(),t._v(" "),e.showPraises?n("div",{staticClass:"list-content-item-praises"},[n("p",[t._v("共"),n("b",[t._v(t._s(e.praises.length))]),t._v("人点赞")]),t._v(" "),n("div",{staticClass:"list-content-item-praises-content"},[n("my-pop-tip",{attrs:{userInfo:t.userInfo,trigger:"click"}},t._l(e.praises,function(e,s){return n("img",{key:s,attrs:{slot:"userCard",onerror:"src='resources/images/icon/defaultUserPhoto.jpg'",src:e.photo?e.photo:"resources/images/icon/defaultUserPhoto.jpg",width:"40"},on:{click:function(n){t.showUserInfo(e.creator)}},slot:"userCard"})}))],1)]):t._e()],1)}))},staticRenderFns:[]};var m=n("VU/8")(r,l,!1,function(t){n("W3wg")},null,null).exports,u={name:"thumbsup",props:{comment:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{handlerShowThumbsUpInfo:function(){this.$forceUpdate(),this.comment.showPraises=!this.comment.showPraises},handleThumbsUp:function(){var t=this,e=this.tempComment.id;Object(o.e)({commentId:e}).then(function(e){e.success?t.refreshThumbaUps():t.$Notice.warning({title:"系统提示",desc:e.message})})},refreshThumbaUps:function(){var t=this,e={commentId:this.tempComment.id,limit:50,page:1,sort:[{property:"crtTime",direction:"DESC"}]};this.tempComment.isPraise=!0,Object(o.x)(e).then(function(e){t.comment.praises=e.tableContent})}},mounted:function(){},created:function(){}},h={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"thumbsup"},[t.comment.praises.length>0?n("span",[n("Icon",{attrs:{type:"ios-arrow-down",size:"18"},nativeOn:{click:function(e){return t.handlerShowThumbsUpInfo(e)}}})],1):t._e(),t._v(" "),n("span",{class:{"comment-isPraise":t.comment.isPraise}},[n("Icon",{attrs:{type:"md-thumbs-up",size:"18"},nativeOn:{click:function(e){return t.handleThumbsUp(e)}}}),t._v("\n        "+t._s(t.comment.praises.length)+"\n    ")],1)])},staticRenderFns:[]};var p=n("VU/8")(u,h,!1,function(t){n("0jEs")},null,null).exports,d={name:"comments",components:{commentPublish:c.a,comments:C,MyPopTip:a.a,childComments:m,thumbsup:p},props:{comments:{type:Array,default:function(){return[]}},allowReply:{type:Boolean,default:!0}},data:function(){return{userInfo:{}}},watch:{},methods:{handlerShowThumbsUpInfo:function(t){this.$forceUpdate(),this.comments.map(function(e){e.id!=t.id&&(e.showPraises=!1),t.showReply=!1,t.showChilds=!1}),t.showPraises=!t.showPraises;var e={commentId:t.id,limit:50,page:1,sort:i()([{property:"crtTime",direction:"DESC"}])};t.isPraise=!0,Object(o.x)(e).then(function(e){t.praises=e.tableContent,t.praiseNum=e.dataCount})},handleThumbsUp:function(t){var e=this;Object(o.e)({commentId:t.id}).then(function(n){if(n.success){var s={commentId:t.id,limit:50,page:1,sort:i()([{property:"crtTime",direction:"DESC"}])};t.isPraise=!0,Object(o.x)(s).then(function(e){t.praises=e.tableContent,t.praiseNum=e.dataCount})}else e.$Notice.warning({title:"系统提示",desc:"点赞,您可以尝试再次点赞或者联系企业管理员哦!"})})},handleShowChilds:function(t){this.$forceUpdate(),this.comments.map(function(e){e.id!=t.id&&(e.showReply=!1),t.showPraises=!1}),t.showChilds=!t.showChilds;var e={parentId:t.id,limit:50,page:1,sort:i()([{property:"crtTime",direction:"DESC"}])};this.getLowerComments(e,t)},handleShowReply:function(t){this.$forceUpdate(),this.comments.map(function(e){e.id!=t.id&&(e.showReply=!1),e.showPraises=!1,e.showChilds=!1}),t.showReply=!t.showReply,t.showReply&&t.childCommentNum},handleReplyPublish:function(t,e,n,s){var a=this;this.$forceUpdate();var c={type:n.type,content:t,relationKey:n.relationKey,parentId:n.id,commentAttachments:e,commentAndReply:s};n.showChilds=!0,Object(o.M)(c).then(function(t){if(t.success){var e={parentId:n.id,limit:50,page:1,sort:i()([{property:"crtTime",direction:"DESC"}])};a.getLowerComments(e,n)}else a.$Notice.warning({title:"系统提示",desc:"添加回复,请联系企业管理员!"})})},handleViewFile:function(t){window.open(t.attachment)},showUserInfo:function(t){var e=this;Object(o.F)(t).then(function(t){t.dataCount&&(e.userInfo=t.tableContent[0])})},getLowerComments:function(t,e){Object(o.z)(t).then(function(t){e.childComment=t.tableContent,e.childCommentNum=t.dataCount})}},created:function(){},mounted:function(){}},f={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"comments"},[n("div",{staticClass:"commnets-content"},t._l(t.comments,function(e,s){return n("Row",{key:s,staticClass:"comments-content-item"},[n("Col",{staticClass:"comments-content-item-user",attrs:{span:"2"}},[n("my-pop-tip",{attrs:{userInfo:t.userInfo,trigger:"click"}},[n("img",{attrs:{slot:"userCard",onerror:"src='resources/images/icon/defaultUserPhoto.jpg'",src:e.photo?e.photo:"resources/images/icon/contactor.png"},on:{click:function(n){t.showUserInfo(e.creator)}},slot:"userCard"})])],1),t._v(" "),n("Col",{staticClass:"comments-content-item-content",attrs:{span:"22"}},[n("p",[n("b",[t._v(t._s(e.creatorName))])]),t._v(" "),n("div",{staticClass:"comments-content-item-content-text",domProps:{innerHTML:t._s(e.content)}}),t._v(" "),e.commentAttachments.length>0?n("div",{staticClass:"comments-content-item-img"},t._l(e.commentAttachments,function(e,s){return"image"===e.type?n("img",{key:s,attrs:{src:e.attachment?e.attachment:"resources/images/icon/defaultUserPhoto.png",width:"100",height:"100"}}):t._e()})):t._e(),t._v(" "),e.commentAttachments.length>0?n("div",{staticClass:"comments-content-item-file"},t._l(e.commentAttachments,function(e,s){return"file"===e.type?n("p",{key:s},[n("a",{on:{click:function(n){t.handleViewFile(e)}}},[t._v(t._s(e.name)+"\r\n                        ")])]):t._e()})):t._e(),t._v(" "),n("div",{staticClass:"comments-content-item-content-bar"},[n("span",{staticClass:"comments-content-item-content-bar-left"},[n("span",[n("span",{directives:[{name:"overTimeDirective",rawName:"v-overTimeDirective",value:{time:e.crtTime},expression:"{time:comment.crtTime}"}]}),t._v("发布\r\n                        ")]),t._v(" "),e.childCommentNum>0?n("span",{staticClass:"cursor-pointer",on:{click:function(n){t.handleShowChilds(e)}}},[t._v("| 查看"+t._s(e.childCommentNum)+"条回复\r\n                            ")]):t._e()]),t._v(" "),n("span",{staticClass:"comments-content-item-content-bar-right"},[n("span",{staticClass:"cursor-pointer",on:{click:function(n){t.handleShowReply(e)}}},[t._v(" 回复")]),t._v(" "),n("span",{class:{"comment-isPraise":e.isPraise}},[n("Icon",{attrs:{type:"md-thumbs-up",size:"18"},nativeOn:{click:function(n){t.handleThumbsUp(e)}}}),t._v("\r\n                            "+t._s(e.praiseNum)+"\r\n                        ")],1),t._v(" "),e.praises.length>0?n("span",[n("Icon",{attrs:{type:"ios-arrow-down",size:"18"},nativeOn:{click:function(n){t.handlerShowThumbsUpInfo(e)}}})],1):t._e()])]),t._v(" "),e.showReply||e.showChilds?n("div",{staticStyle:{"background-color":"rgb(240, 240, 240)",padding:"10px",border:"1px solid #ddd"}},[e.showReply?n("commentPublish",{attrs:{handlePublish:t.handleReplyPublish,superComment:e,ischild:!0,allowFile:!1}}):t._e(),t._v(" "),e.showChilds?n("child-comments",{attrs:{superComment:e,comments:e.childComment}}):t._e()],1):t._e(),t._v(" "),e.showPraises?n("div",{staticClass:"comments-content-item-praises"},[n("p",[t._v("共"),n("b",[t._v(t._s(e.praiseNum))]),t._v("人点赞")]),t._v(" "),n("div",{staticClass:"comments-content-item-praises-content"},[n("my-pop-tip",{attrs:{userInfo:t.userInfo,trigger:"click"}},t._l(e.praises,function(e,s){return n("img",{key:s,attrs:{slot:"userCard",onerror:"src='resources/images/icon/defaultUserPhoto.jpg'",src:e.photo?e.photo:"resources/images/icon/defaultUserPhoto.jpg",width:"40"},on:{click:function(n){t.showUserInfo(e.creator)}},slot:"userCard"})}))],1)]):t._e()])],1)}))])},staticRenderFns:[]};var v=n("VU/8")(d,f,!1,function(t){n("3eNe")},"data-v-c7d6953e",null),C=e.a=v.exports},c72o:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n("woOf"),i=n.n(s),o=n("mvHQ"),a=n.n(o),c=n("GIAq"),r=n("bJtM"),l=n("ejmB"),m={name:"userComments",components:{comments:r.a,commentPublish:l.a},props:{},data:function(){return{transCode:this.$route.params.transCode,type:"instance",comments:[],commentsCount:0,pageInfo:{limit:10,page:1,total:0}}},methods:{handlePublish:function(t,e){var n=this,s={type:this.type,content:t,relationKey:this.transCode,parentId:-1,commentAndReply:!1,commentAttachments:e};Object(c.M)(s).then(function(t){t.success?n.refreshComments():n.$Notice.warning({title:"系统提示",desc:"添加评论失败,请联系企业管理员!"})})},refreshComments:function(){var t=this,e={relationKey:this.transCode,sort:a()([{property:"crtTime",direction:"DESC"}])};e=i()(e,this.pageInfo),Object(c.y)(e).then(function(e){t.comments=e.tableContent,t.pageInfo.total=e.dataCount})},handlePageChange:function(t){this.pageInfo.page=t,this.refreshComments()}},mounted:function(){this.refreshComments()}},u={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bg_ff "},[n("Row",{staticClass:"comments"},[n("commentPublish",{attrs:{handlePublish:t.handlePublish}}),t._v(" "),t.comments.length>0?n("div",{staticClass:"comments-header martop10"},[n("strong",[t._v("最新评论("+t._s(t.pageInfo.total)+")")])]):t._e(),t._v(" "),n("comments",{attrs:{comments:t.comments,refreshRootComments:t.refreshComments}}),t._v(" "),t.pageInfo.total>0?n("Page",{staticClass:"pad20",attrs:{total:t.pageInfo.total,"page-size":t.pageInfo.limit,current:t.pageInfo.page,"prev-text":"上一页","next-text":"下一页"},on:{"on-change":t.handlePageChange}}):t._e()],1)],1)},staticRenderFns:[]};var h=n("VU/8")(m,u,!1,function(t){n("Cetb")},"data-v-3927b783",null);e.default=h.exports},ejmB:function(t,e,n){"use strict";var s=n("oAV5"),i={name:"coment-publish",props:{discContent:{type:Object,default:function(){return{txt:""}}},handlePublish:{type:Function},comments:{type:Array,default:function(){return[]}},superComment:{type:Object,default:function(){return{}}},allowFile:{type:Boolean,default:!0},ischild:{type:Boolean,default:!1}},data:function(){return{innerText:this.discContent.txt,lock:!1,httpHeaders:{Authorization:Object(s.c)()},faces:[],defaultList:[],defaultFileList:[],imgName:"",visible:!1,uploadList:[],disabledSendBtn:!0,commentAndReply:!1}},watch:{discContent:{handler:function(t,e){this.lock||(this.innerText=this.discContent.txt),t.txt&&(this.disabledSendBtn=!1)},deep:!0}},methods:{choice_face:function(t){this.discContent.txt=this.discContent.txt+'<img src="'+t+'" width="20">'},changeTxt:function(t){this.discContent.txt=t.target.innerHTML},send:function(){var t=this.uploadList.map(function(t){return{attachment:t.url,type:"image"}}),e=this.uploadFileList.map(function(t){return{attachment:t.url,type:"file"}});e=e.concat(t),this.handlePublish(this.discContent.txt,e,this.superComment,this.commentAndReply),this.innerText="",this.discContent.txt="",this.$refs.upload.clearFiles(),this.$refs.uploadFile.clearFiles(),this.uploadList=[],this.uploadFileList=[]},handleView:function(t){this.imgName=t,this.visible=!0},handleRemove:function(t){var e=this.$refs.upload.fileList;this.$refs.upload.fileList.splice(e.indexOf(t),1)},handleSuccess:function(t,e){e.url="/H_roleplay-si/ds/download?url="+t.data[0].attacthment,e.name=t.data[0].attacthment},handleFileSuccess:function(t,e){e.url="/H_roleplay-si/ds/download?url="+t.data[0].attacthment},handleFormatError:function(t){this.$Notice.warning({title:"系统提示",desc:"图片 "+t.name+"格式不支持, 请选择格式为jpg或者png的图片"})},handleMaxSize:function(t){this.$Notice.warning({title:"超过文件大小限制",desc:"文件  "+t.name+"太大,最多支持2M."})},handleBeforeUpload:function(){var t=this.uploadList.length<9;return t||this.$Notice.warning({title:"最多可以上传九张图片。 "}),t}},created:function(){for(var t=1;t<=141;t++)t<10?this.faces.push("resources/images/face/00"+t.toString()+"@2x.png"):t<=99?this.faces.push("resources/images/face/0"+t.toString()+"@2x.png"):this.faces.push("resources/images/face/"+t.toString()+"@2x.png")},mounted:function(){this.uploadList=this.$refs.upload.fileList,this.uploadFileList=this.$refs.uploadFile.fileList}},o={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"publish"},[n("Row",{staticClass:"publish-container"},[n("div",{staticClass:"publish-container-content",attrs:{contenteditable:"true"},domProps:{innerHTML:t._s(t.innerText)},on:{input:t.changeTxt,focus:function(e){t.lock=!0},blur:function(e){t.lock=!1}}})]),t._v(" "),n("br"),t._v(" "),n("Row",{staticClass:"publish-bar"},[n("Col",{staticClass:"publish-bar-left",attrs:{span:"12"}},[n("Poptip",{attrs:{placement:"bottom-start",width:"400"}},[n("Icon",{staticClass:"choice-face",attrs:{type:"ios-happy-outline",size:"24"}}),t._v("表情\n                    "),n("div",{staticClass:"api",attrs:{slot:"content"},slot:"content"},t._l(t.faces,function(e){return n("img",{key:e,staticStyle:{float:"left",margin:"2px",cursor:"pointer"},attrs:{src:e,width:"24"},on:{click:function(n){t.choice_face(e)}}})}))],1),t._v(" "),n("Poptip",{directives:[{name:"show",rawName:"v-show",value:t.allowFile,expression:"allowFile"}],attrs:{placement:"bottom-start",width:"230"}},[n("Icon",{staticClass:"choice-img",attrs:{type:"md-images",size:"24"}}),t._v("图片\n                    "),n("div",{staticClass:"api",attrs:{slot:"content"},slot:"content"},[n("p",{staticClass:"lh25"},[n("span",[n("b",[t._v("本地上传")])]),t._v(" "),n("span",{staticClass:"fr"},[t._v("共"+t._s(t.uploadList.length)+"张,还能上传"+t._s(9-t.uploadList.length)+"张")])]),t._v(" "),t._l(t.uploadList,function(e,s){return n("div",{key:s,staticClass:"comment-upload-list"},["finished"===e.status?[n("img",{attrs:{src:e.url}}),t._v(" "),n("div",{staticClass:"comment-upload-list-cover"},[n("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(n){t.handleView(e.name)}}}),t._v(" "),n("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(n){t.handleRemove(e)}}})],1)]:[e.showProgress?n("Progress",{attrs:{percent:e.percentage,"hide-info":""}}):t._e()]],2)}),t._v(" "),n("Upload",{directives:[{name:"show",rawName:"v-show",value:t.uploadList.length<9,expression:"uploadList.length<9"}],ref:"upload",staticStyle:{display:"table",width:"58px"},attrs:{"show-upload-list":!1,"default-file-list":t.defaultList,"on-success":t.handleSuccess,format:["jpg","jpeg","png"],"max-size":2048,headers:t.httpHeaders,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize,"before-upload":t.handleBeforeUpload,multiple:"",type:"drag",action:"/H_roleplay-si/ds/upload"}},[n("div",{staticStyle:{width:"58px",height:"58px","line-height":"58px"}},[n("Icon",{attrs:{type:"ios-camera",size:"20"}})],1)]),t._v(" "),n("Modal",{attrs:{title:"查看图片"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[t.visible?n("img",{staticStyle:{width:"100%"},attrs:{src:"/H_roleplay-si/ds/download?url="+t.imgName}}):t._e()])],2)],1),t._v(" "),n("Poptip",{directives:[{name:"show",rawName:"v-show",value:t.allowFile,expression:"allowFile"}],attrs:{placement:"bottom-start"}},[n("Icon",{staticClass:"choice-file",attrs:{type:"md-attach",size:"24"}}),t._v("文件\n                "),n("div",{attrs:{slot:"content"},slot:"content"},[n("Upload",{ref:"uploadFile",attrs:{multiple:"",headers:t.httpHeaders,"on-success":t.handleFileSuccess,"default-file-list":t.defaultFileList,action:"/H_roleplay-si/ds/upload"}},[n("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v("上传文件")])],1)],1)],1),t._v(" "),t.ischild?n("span",[n("Checkbox",{model:{value:t.commentAndReply,callback:function(e){t.commentAndReply=e},expression:"commentAndReply"}},[t._v("同时评论到此应用")])],1):t._e()],1),t._v(" "),n("Col",{staticClass:"publish-bar-right",attrs:{span:"12"}},[n("Button",{nativeOn:{click:function(e){return t.send(e)}}},[t._v("发送")])],1)],1)],1)},staticRenderFns:[]};var a=n("VU/8")(i,o,!1,function(t){n("9iX7")},"data-v-12ec143e",null);e.a=a.exports}});
//# sourceMappingURL=8.90516cf11e19cdead94c.js.map
webpackJsonp([42],{"5sS/":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("Gu7T"),a=n.n(i),l=n("JUNF"),o={name:"KnowledgeBase",components:{},data:function(){return{currentPage:1,total:0,limit:10,isRolling:!1,searchValue:"",filter:!1,knowledgeData:[]}},methods:{knowledgeFilter:function(){this.currentPage=1,this.filter=!0,this.getAllKnowledgeData()},handleScroll:function(){var e=this,t=document.getElementById("knowledgeList");t.addEventListener("scroll",function(){Math.ceil(t.clientHeight+t.scrollTop)+2>=t.scrollHeight&&(e.total>e.knowledgeData.length?(e.currentPage++,e.isRolling=!0,e.getAllKnowledgeData()):e.isRolling=!1)})},getAllKnowledgeData:function(){var e=this;Object(l.b)(this.currentPage,this.limit,this.searchValue).then(function(t){if(t.success){var n;if(e.filter)e.knowledgeData=t.tableContent,e.filter=!1;else if(e.isRolling)e.knowledgeData=(n=e.knowledgeData).concat.apply(n,a()(t.tableContent));else e.knowledgeData=t.tableContent;e.total=t.dataCount,e.knowledgeData.forEach(function(t){t.img||(t.img=e.getString(t.content),t.content=e.deleteImg(t.content))})}})},addKnowledgeData:function(){this.$router.push({name:"knowledgeAdd",path:"/knowledge/add"})},editKnowledgeData:function(e,t){this.$router.push({name:"knowledgeView",path:"/knowledge/view/"+e.id,params:{id:e.id}})},deleteKnowledge:function(e,t){var n=this,i=[];this.$Modal.confirm({title:"确认",content:"确认删除<b style=color:#e4393c;>"+e.title+"</b>么？",onOk:function(){i.push(e.id),Object(l.a)(i).then(function(e){e.success&&(n.$Message.success(e.message),n.currentPage=1,n.knowledgeData.splice(t,1))}).catch(function(e){n.$Message.error(e.data.message)})}})},getString:function(e){var t=void 0,n=void 0,i=void 0,a=void 0;return e&&(e.indexOf("img")>-1?(t=e.indexOf("img"),i=(n=e.slice(t-1)).indexOf(">"),a=n.slice(0,i+1)):a=""),a},deleteImg:function(e){var t=void 0,n=void 0,i=void 0,a=void 0;return e&&(e.indexOf("img")>-1?(t=e.indexOf("img"),i=(n=e.slice(t-1)).indexOf(">"),a=n.slice(0,i+1),a=e.replace(a,""),this.deleteImg(a)):a=e),a}},mounted:function(){this.getAllKnowledgeData(),this.handleScroll()}},s={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"knowledge"},[n("div",{staticClass:"knowledge-toolbar"},[n("span",{staticClass:"knowledge-toolbar-add",on:{click:e.addKnowledgeData}},[e._v("新增")]),e._v(" "),n("div",{staticClass:"knowledge-toolbar-search"},[n("Input",{staticStyle:{width:"300px"},attrs:{search:!0,placeholder:"搜索"},on:{"on-search":e.knowledgeFilter},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}})],1)]),e._v(" "),n("div",{staticClass:"knowledge-list",attrs:{id:"knowledgeList"}},e._l(e.knowledgeData,function(t,i){return n("Row",{key:i,staticClass:"knowledge-list-item",attrs:{gutter:8}},[n("Col",{attrs:{span:t.img?"22":"24"}},[n("div",{staticClass:"knowledge-list-item-title"},[n("b",{on:{click:function(n){e.editKnowledgeData(t,i)}}},[e._v(e._s(t.title))]),e._v(" "),n("span",{staticClass:"knowledge-delete",on:{click:function(n){e.deleteKnowledge(t,i)}}},[e._v("删除")])]),e._v(" "),n("p",{domProps:{innerHTML:e._s(t.content)}}),e._v(" "),n("span",[e._v(e._s(t.creator))]),e._v(" "),n("span",[e._v(e._s(t.crtTime))])]),e._v(" "),n("Col",{attrs:{span:t.img?"2":"0"}},[n("div",{staticClass:"knowledge-img"},[n("div",{domProps:{innerHTML:e._s(t.img)}})])])],1)}))])},staticRenderFns:[]};var d=n("VU/8")(o,s,!1,function(e){n("HFNQ")},"data-v-4e6e3548",null);t.default=d.exports},HFNQ:function(e,t){}});
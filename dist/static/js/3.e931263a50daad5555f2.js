webpackJsonp([3],{"0rwx":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("GIAq"),o={name:"permissionModal",components:{},props:{appListId:String,modalPermissionStatus:Boolean},data:function(){return{selectUser:"",selectOrg:"",selectPosition:"",searchValue:"",showUserModal:!1,showOrgModal:!1,showDepartmentModal:!1,showPermissionModal:!1,sameUserData:[],userSelectData:[],orgSelectData:[],departmentSelectData:[],userColumns:[],userData:[],orgColumns:[],orgData:[],departmentColumns:[],departmentData:[],allPermissionData:[],permissionSelectDatas:[],allPermissionColumns:[{type:"selection",width:60,align:"center"},{title:"类型",key:"type"},{title:"资源",key:"name"}],userSelection:[],orgSelection:[],departmentSelection:[]}},watch:{modalPermissionStatus:function(t,e){this.showPermissionModal=t},searchValue:function(t){var e=[];t?(this.sameUserData.forEach(function(s,a){(s.nickname.indexOf(t)>-1||s.userCode.indexOf(t)>-1)&&e.push(s)}),this.userData=e):this.userData=this.sameUserData}},methods:{confirmMember:function(){},selectUserModal:function(){var t=this;this.showUserModal=!0,this.userColumns=[{type:"selection",width:60,align:"center"},{title:"姓名",key:"nickname"},{title:"工号",key:"userCode"}],Object(a.h)().then(function(e){t.userData=e.tableContent,t.sameUserData=e.tableContent})},selectOrgModal:function(){var t=this;this.showOrgModal=!0,this.orgColumns=[{type:"selection",width:60,align:"center"},{title:"名称",key:"name"}],Object(a.e)().then(function(e){t.orgData=e.tableContent})},selectPositionModal:function(){var t=this;this.showDepartmentModal=!0,this.departmentColumns=[{type:"selection",width:60,align:"center"},{title:"名称",key:"name"}],Object(a.d)().then(function(e){t.departmentData=e.tableContent})},selectUserClick:function(t,e){var s=this;this.userSelection.length>0?t.forEach(function(t,e){s.userSelection.push(t)}):this.userSelection=t},selectOrgClick:function(t,e){var s=this;this.orgSelection.length>0?t.forEach(function(t,e){s.orgSelection.push(t)}):this.orgSelection=t},selectDepartmentClick:function(t,e){var s=this;this.departmentSelection.length>0?t.forEach(function(t,e){s.departmentSelection.push(t)}):this.departmentSelection=t},deleteUser:function(t){this.userSelectData.splice(t,1)},deleteOrg:function(t){this.orgSelectData.splice(t,1)},deleteDepartment:function(t){this.departmentSelectData.splice(t,1)},permissionSelectData:function(t,e){this.permissionSelectDatas=t},confirmUser:function(){var t={};this.userSelectData=this.userSelection.reduce(function(e,s){return!t[s.userId]&&(t[s.userId]=e.push(s)),e},[])},confirmOrg:function(){var t={};this.orgSelectData=this.orgSelection.reduce(function(e,s){return!t[s.id]&&(t[s.id]=e.push(s)),e},[])},confirmDepartment:function(){var t={};this.departmentSelectData=this.departmentSelection.reduce(function(e,s){return!t[s.id]&&(t[s.id]=e.push(s)),e},[])},submitPermission:function(){var t=this,e=this.userSelectData.map(function(t){return t.userId}),s=this.orgSelectData.map(function(t){return t.id}),o=this.departmentSelectData.map(function(t){return t.id}),i=this.permissionSelectDatas.map(function(t){return t.id}),n={userId:e.join(","),roleId:o.join(","),groupId:s.join(","),permissionId:i.join(",")};n&&Object(a.a)(n).then(function(e){e.success&&t.$Message.success(e.message)})},modalVisibleChange:function(t){t||this.$emit("emitPermissionModal",{modal:!1})}},mounted:function(){var t=this,e={listId:this.appListId};Object(a.f)(e).then(function(e){t.allPermissionData=e.tableContent})}},i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Modal",{attrs:{title:"应用权限",width:"1000","mask-closable":!1},on:{"on-ok":t.submitPermission,"on-visible-change":t.modalVisibleChange},model:{value:t.showPermissionModal,callback:function(e){t.showPermissionModal=e},expression:"showPermissionModal"}},[s("div",[s("Row",{staticStyle:{"margin-bottom":"15px"},attrs:{gutter:8}},[s("Col",{attrs:{span:"8"}},[s("label",[t._v("用户")]),t._v(" "),s("Input",{staticStyle:{width:"200px"},attrs:{icon:"arrow-down-b"},on:{"on-click":t.selectUserModal},model:{value:t.selectUser,callback:function(e){t.selectUser=e},expression:"selectUser"}})],1),t._v(" "),s("Col",{attrs:{span:"8"}},[s("label",[t._v("组织")]),t._v(" "),s("Input",{staticStyle:{width:"200px"},attrs:{icon:"arrow-down-b"},on:{"on-click":t.selectOrgModal},model:{value:t.selectOrg,callback:function(e){t.selectOrg=e},expression:"selectOrg"}})],1),t._v(" "),s("Col",{attrs:{span:"8"}},[s("label",[t._v("职位")]),t._v(" "),s("Input",{staticStyle:{width:"200px"},attrs:{icon:"arrow-down-b"},on:{"on-click":t.selectPositionModal},model:{value:t.selectPosition,callback:function(e){t.selectPosition=e},expression:"selectPosition"}})],1)],1),t._v(" "),s("Row",{attrs:{gutter:8}},[s("Col",{staticClass:"permission-tab",attrs:{span:"12"}},[s("Row",{staticClass:"permission-top-line"}),t._v(" "),s("Row",[s("Col",{attrs:{span:"3"}},[s("b",{staticClass:"permission-title"},[t._v("用户")])]),t._v(" "),s("Col",{staticStyle:{height:"100px"},attrs:{span:"21"}},t._l(t.userSelectData,function(e,a){return s("Tag",{key:a,attrs:{type:"border",closable:"",color:"yellow"},on:{"on-close":function(e){t.deleteUser(a)}}},[t._v(t._s(e.nickname))])}))],1),t._v(" "),s("Row",{staticClass:"permission-line"}),t._v(" "),s("Row",[s("Col",{attrs:{span:"3"}},[s("b",{staticClass:"permission-title"},[t._v("组织")])]),t._v(" "),s("Col",{staticStyle:{height:"100px"},attrs:{span:"21"}},t._l(t.orgSelectData,function(e,a){return s("Tag",{key:a,attrs:{type:"border",closable:"",color:"green"},on:{"on-close":function(e){t.deleteOrg(a)}}},[t._v(t._s(e.name))])}))],1),t._v(" "),s("Row",{staticClass:"permission-line"}),t._v(" "),s("Row",[s("Col",{attrs:{span:"3"}},[s("b",{staticClass:"permission-title"},[t._v("职位")])]),t._v(" "),s("Col",{staticStyle:{height:"100px"},attrs:{span:"21"}},t._l(t.departmentSelectData,function(e,a){return s("Tag",{key:a,attrs:{type:"border",closable:"",color:"blue"},on:{"on-close":function(e){t.deleteDepartment(a)}}},[t._v(t._s(e.name))])}))],1)],1),t._v(" "),s("Col",{attrs:{span:"12"}},[s("Table",{attrs:{stripe:"",height:"350",columns:t.allPermissionColumns,data:t.allPermissionData},on:{"on-select":t.permissionSelectData}})],1)],1),t._v(" "),s("Modal",{attrs:{title:"用户选择","mask-closable":!1,transfer:!1},on:{"on-ok":t.confirmUser},model:{value:t.showUserModal,callback:function(e){t.showUserModal=e},expression:"showUserModal"}},[s("div",{staticClass:"app-search"},[s("Icon",{staticClass:"app-search-icon",attrs:{type:"search"}}),t._v(" "),s("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"搜索"},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}})],1),t._v(" "),s("Table",{attrs:{height:"400",stripe:"",size:"small",columns:t.userColumns,data:t.userData},on:{"on-select":t.selectUserClick}})],1),t._v(" "),s("Modal",{attrs:{title:"组织选择","mask-closable":!1,transfer:!1},on:{"on-ok":t.confirmOrg},model:{value:t.showOrgModal,callback:function(e){t.showOrgModal=e},expression:"showOrgModal"}},[s("Table",{attrs:{height:"400",stripe:"",size:"small",columns:t.orgColumns,data:t.orgData},on:{"on-select":t.selectOrgClick}})],1),t._v(" "),s("Modal",{attrs:{title:"职位选择","mask-closable":!1,transfer:!1},on:{"on-ok":t.confirmDepartment},model:{value:t.showDepartmentModal,callback:function(e){t.showDepartmentModal=e},expression:"showDepartmentModal"}},[s("Table",{attrs:{height:"400",stripe:"",size:"small",columns:t.departmentColumns,data:t.departmentData},on:{"on-select":t.selectDepartmentClick}})],1)],1)])},staticRenderFns:[]};var n=s("VU/8")(o,i,!1,function(t){s("FPDy")},"data-v-ab7e6468",null).exports,r={name:"WorkflowModal",props:{modalWorkflowStatus:Boolean,listId:String},data:function(){return{showWorkFlow:!1,relativeWorkFlowTotal:0,allWorkFlowTotal:0,allCurrentPage:1,relativeCurrentPage:1,pageSize:10,loading:!0,allWorkFlowColumns:[{type:"selection",width:60,align:"center"},{title:"名称",key:"processName"},{title:"编码",key:"processCode"},{title:"查看流程图",key:"action",align:"center",render:function(t,e){return t("Button",{props:{type:"default",size:"small"}},"查看")}}],relativeWorkFlowColumns:[{title:"名称",key:"processName"},{title:"编码",key:"processCode"},{title:"配置节点",key:"action",align:"center",render:function(t,e){return t("Button",{props:{type:"default",size:"small"}},"配置")}}],allWorkFlowData:[],relativeWorkFlowData:[]}},watch:{modalWorkflowStatus:function(t,e){this.showWorkFlow=t}},methods:{selectWorkFlow:function(){},getAllWorkflowData:function(){var t=this,e={page:this.allCurrentPage,limit:this.pageSize};this.loading=!0,Object(a.g)(e).then(function(e){t.allWorkFlowData=e.tableContent,t.allWorkFlowTotal=e.dataCount,t.loading=!1})},getRelativeWorkflowData:function(){var t=this,e={page:this.relativeCurrentPage,limit:this.pageSize,listId:this.listId};this.loading=!0,Object(a.o)(e).then(function(e){t.relativeWorkFlowData=e,t.relativeWorkFlowTotal=e.length,t.loading=!1})},onPageChange:function(t){var e=this;this.allCurrentPage=t;var s={page:this.allCurrentPage,limit:this.pageSize};this.loading=!0,Object(a.g)(s).then(function(t){e.allWorkFlowData=t.tableContent,e.allWorkFlowTotal=t.dataCount,e.loading=!1})},onRelativePageChange:function(){this.loading=!1},modalVisibleChange:function(t){t||this.$emit("emitWorkFlowModal",{modal:!1})},addWorkflow:function(t,e){var s=this;0===this.relativeWorkFlowData.length?this.relativeWorkFlowData.push(t):this.relativeWorkFlowData.forEach(function(e){t.id===e.id?s.$Message.warning("已有选择的工作流！"):s.relativeWorkFlowData.push(t)});var a={};this.relativeWorkFlowData=this.relativeWorkFlowData.reduce(function(t,e){return!a[e.id]&&(a[e.id]=t.push(e)),t},[])},deleteWorkflow:function(t,e){this.relativeWorkFlowData.splice(e,1)}},mounted:function(){this.getAllWorkflowData(),this.getRelativeWorkflowData()}},l={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Modal",{attrs:{title:"工作流设置",width:"1010","mask-closable":!1},on:{"on-ok":t.selectWorkFlow,"on-visible-change":t.modalVisibleChange},model:{value:t.showWorkFlow,callback:function(e){t.showWorkFlow=e},expression:"showWorkFlow"}},[s("Row",{attrs:{gutter:8}},[s("Col",{attrs:{span:"12"}},[s("h4",{staticClass:"flow-title"},[t._v("所有工作流\n      "),s("Button",{staticClass:"create-button"},[t._v("创建工作流")])],1),t._v(" "),s("Table",{attrs:{loading:t.loading,stripe:"",height:"350",columns:t.allWorkFlowColumns,data:t.allWorkFlowData},on:{"on-row-dblclick":t.addWorkflow}}),t._v(" "),s("div",{staticClass:"workflow-page"},[s("div",{staticStyle:{float:"right"}},[s("Page",{attrs:{total:t.allWorkFlowTotal,current:t.allCurrentPage,"page-size":t.pageSize,size:"small","show-total":""},on:{"on-change":t.onPageChange}})],1)])],1),t._v(" "),s("Col",{attrs:{span:"12"}},[s("h4",{staticClass:"flow-title"},[t._v("已关联的工作流\n      "),s("Button",{staticClass:"create-button"},[t._v("创建工作流")])],1),t._v(" "),s("Table",{attrs:{loading:t.loading,stripe:"",height:"350",columns:t.relativeWorkFlowColumns,data:t.relativeWorkFlowData},on:{"on-row-dblclick":t.deleteWorkflow}}),t._v(" "),s("div",{staticClass:"workflow-page"},[s("div",{staticStyle:{float:"right"}},[s("Page",{attrs:{total:t.relativeWorkFlowTotal,current:t.relativeCurrentPage,"page-size":t.pageSize,size:"small","show-total":""},on:{"on-change":t.onRelativePageChange}})],1)])],1)],1)],1)},staticRenderFns:[]};var c=s("VU/8")(r,l,!1,function(t){s("L3CM")},"data-v-5a307971",null).exports,p={name:"navModal",props:{modalNavStatus:Boolean},data:function(){return{showNav:!1,navData:[]}},watch:{modalNavStatus:function(t,e){this.showNav=t}},methods:{modalVisibleChange:function(t){t||this.$emit("emitNavModal",{modal:!1})},publishApp:function(){},getNavData:function(){var t=this;Object(a.n)({parentId:"root"}).then(function(e){e.forEach(function(e,s){1===e.leaf?t.navData.push({title:e.text,id:e.id,render:function(t,e){e.root,e.node;var s=e.data;return t("span",{style:{display:"inline-block",width:"100%"}},[t("span",[t("Icon",{props:{type:"ios-folder-outline"},style:{marginRight:"8px",color:"#FF8F59",fontSize:"1rem"}}),t("span",s.title)])])}}):t.navData.push({title:e.text,id:e.id,loading:!1,children:[],render:function(t,e){e.root,e.node;var s=e.data;return t("span",{style:{display:"inline-block",width:"100%"}},[t("span",[t("Icon",{props:{type:"folder"},style:{marginRight:"8px",color:"#39f",fontSize:"1.2rem"}}),t("span",s.title)])])}})})})},loadData:function(t,e){var s={parentId:t.id};Object(a.n)(s).then(function(t){var s=[];t.forEach(function(t){1===t.leaf?s.push({title:t.text,id:t.id,render:function(t,e){e.root,e.node;var s=e.data;return t("span",{style:{display:"inline-block",width:"100%"}},[t("span",[t("Icon",{props:{type:"ios-folder-outline"},style:{marginRight:"8px",color:"#FF8F59",fontSize:"1rem"}}),t("span",s.title)])])}}):s.push({title:t.text,id:t.id,loading:!1,children:[],render:function(t,e){e.root,e.node;var s=e.data;return t("span",{style:{display:"inline-block",width:"100%"}},[t("span",[t("Icon",{props:{type:"folder"},style:{marginRight:"8px",color:"#39f",fontSize:"1.2rem"}}),t("span",s.title)])])}})}),e(s)})}},mounted:function(){this.getNavData()}},d={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Modal",{attrs:{title:"导航",width:"300","mask-closable":!1},on:{"on-ok":t.publishApp,"on-visible-change":t.modalVisibleChange},model:{value:t.showNav,callback:function(e){t.showNav=e},expression:"showNav"}},[s("Tree",{staticClass:"nav-tree",attrs:{data:t.navData,"load-data":t.loadData}})],1)},staticRenderFns:[]};var u={name:"appSetting",components:{PermissionModal:n,WorkflowModal:c,NavModal:s("VU/8")(p,d,!1,function(t){s("iE1W")},"data-v-2ad47ec4",null).exports},props:["listId"],data:function(){return{showPermissionModal:!1,showWorkFlow:!1,showNav:!1}},methods:{emitPermissionModal:function(){this.showPermissionModal=!1},emitWorkFlowModal:function(){this.showWorkFlow=!1},emitNavModal:function(){this.showNav=!1},showNavModal:function(){this.showNav=!0},showPermissionApp:function(){this.showPermissionModal=!0},submitPermission:function(){},showWorkFlowModal:function(){this.showWorkFlow=!0},goForm:function(){window.open("/Form/index.html?viewDesign=true&list="+this.listId)}},mounted:function(){}},m={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("Row",[s("Card",{staticClass:"app-card"},[s("div",{staticClass:"app-body"},[s("Col",{attrs:{span:"6"}},[s("Card",{staticClass:"app-body-card"},[s("p",{staticClass:"app-title",attrs:{slot:"title"},slot:"title"},[t._v("表单设置")]),t._v(" "),s("ul",[s("li",[s("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),s("a",[t._v("部件内部数据源过滤")])]),t._v(" "),s("li",[s("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),s("a",[t._v("部件之间数据过滤")])]),t._v(" "),s("li",[s("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),s("a",[t._v("科目分录设置")])]),t._v(" "),s("li",[s("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),s("a",{on:{click:t.goForm}},[t._v("表单设置")])])])])],1),t._v(" "),s("Col",{attrs:{span:"6"}},[s("Card",{staticClass:"app-body-card"},[s("p",{staticClass:"app-title",attrs:{slot:"title"},slot:"title"},[t._v("工作流设置")]),t._v(" "),s("ul",[s("li",[s("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),s("a",[t._v("一般工作流图")])]),t._v(" "),s("li",[s("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),s("a",{on:{click:t.showWorkFlowModal}},[t._v("工作流设置")])])])])],1),t._v(" "),s("Col",{attrs:{span:"6"}},[s("Card",{staticClass:"app-body-card"},[s("p",{staticClass:"app-title",attrs:{slot:"title"},slot:"title"},[t._v("报表设置")]),t._v(" "),s("ul",[s("li",[s("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),s("a",[t._v("对象查阅项")])]),t._v(" "),s("li",[s("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),s("a",[t._v("报表权限")])])])])],1),t._v(" "),s("Col",{attrs:{span:"6"}},[s("Card",{staticClass:"app-body-card"},[s("p",{staticClass:"app-title",attrs:{slot:"title"},slot:"title"},[t._v("相关应用设置")]),t._v(" "),s("ul",[s("li",[s("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),s("a",[t._v("应用信息设置")])]),t._v(" "),s("li",[s("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),s("a",{on:{click:t.showPermissionApp}},[t._v("权限设置")])]),t._v(" "),s("li",[s("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),s("a",{on:{click:t.showNavModal}},[t._v("导航")])])])])],1)],1)])],1),t._v(" "),s("nav-modal",{attrs:{modalNavStatus:t.showNav},on:{emitNavModal:t.emitNavModal}}),t._v(" "),s("workflow-modal",{attrs:{modalWorkflowStatus:t.showWorkFlow,listId:t.listId},on:{emitWorkFlowModal:t.emitWorkFlowModal}}),t._v(" "),s("permission-modal",{attrs:{modalPermissionStatus:t.showPermissionModal,appListId:t.listId},on:{emitPermissionModal:t.emitPermissionModal}})],1)},staticRenderFns:[]};var h=s("VU/8")(u,m,!1,function(t){s("TmqI")},"data-v-543e2f72",null).exports,v={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("Row",[e("Card",{staticClass:"app-card"},[e("p",{staticClass:"app-name",attrs:{slot:"title"},slot:"title"},[this._v("\n              应用视图\n          ")]),this._v(" "),e("a",{attrs:{slot:"extra",href:"#"},slot:"extra"}),this._v(" "),e("Table",{attrs:{columns:this.columns,data:this.tableData}})],1)],1)],1)},staticRenderFns:[]};var f=s("VU/8")({name:"appView",components:{},data:function(){return{columns:[{title:"视图名称",key:"name",render:function(t,e){return t("a",{},e.row.name)}},{title:"创建时间",key:"createTime"},{title:"创建者",key:"creator"},{title:"默认视图",key:"defaultView",width:100,align:"center",render:function(t,e){return t("Radio",{props:{value:!0}})}},{title:"操作",key:"action",width:150,align:"center",render:function(t,e){return t("Button",{props:{type:"error",size:"small"}},"删除")}}],tableData:[{name:"收款明细",createTime:"2018-6-21",creator:"maliya"},{name:"收款主表",createTime:"2018-6-21",creator:"maliya"}]}},methods:{},mounted:function(){}},v,!1,function(t){s("Vv9g")},"data-v-662c2c19",null).exports,g={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("Row",[e("Card",{staticClass:"app-card"},[e("p",{staticClass:"app-name",attrs:{slot:"title"},slot:"title"},[this._v("\n              应用科目\n          ")]),this._v(" "),e("a",{attrs:{slot:"extra",href:"#"},slot:"extra"}),this._v(" "),e("Table",{attrs:{columns:this.columns,data:this.tableData}})],1)],1)],1)},staticRenderFns:[]};var _=s("VU/8")({name:"appSubject",components:{},data:function(){return{columns:[{title:"名称",key:"name"},{title:"分类",key:"type"},{title:"启用",key:"defaultView",width:150,align:"center",render:function(t,e){return t("Checkbox",{props:{value:!0}})}}],tableData:[{name:"存货",type:"计划类"},{name:"费用",type:"会计类"}]}},methods:{},mounted:function(){}},g,!1,function(t){s("VSt5")},"data-v-27283cfe",null).exports,w={name:"appPermission",components:{},props:{listId:String},data:function(){var t=this;return{isUserEdit:!1,isOrgEdit:!1,isDepEdit:!1,spin:!1,userColumns:[{title:"姓名",key:"objName",width:100},{title:"资源",key:"resource",align:"center",render:function(e,s){var a=[];return s.row.resource.forEach(function(o,i){var n=void 0,r=function(a){n=e("Tag",{props:{closable:!0,color:"yellow"},on:{"on-close":function(){t.deleteOnlyPermission(s,a,"sys_user_permission")}}},o[a])};for(var l in o)r(l);a.push(n)}),e("div",a)}},{title:"查看范围",key:"scope",render:function(e,s){var a=[];return s.row.scope.forEach(function(o,i){var n=void 0,r=function(a){n=e("Tag",{props:{closable:!0,color:"green"},on:{"on-close":function(e){t.deleteOnlyPermission(s,a,"sys_user_permission")}}},o[a])};for(var l in o)r(l);a.push(n)}),e("div",a)}},{title:"动作",key:"action",render:function(e,s){var a=[];return s.row.action.forEach(function(o,i){var n=void 0,r=function(a){n=e("Tag",{props:{closable:!0,color:"blue"},on:{"on-close":function(e){t.deleteOnlyPermission(s,a,"sys_user_permission")}}},o[a])};for(var l in o)r(l);a.push(n)}),e("div",a)}}],userData:[],orgColumns:[{title:"名称",key:"objName",width:100},{title:"资源",align:"center",key:"resource",render:function(e,s){var a=[];return s.row.resource.forEach(function(o,i){var n=void 0,r=function(a){n=e("Tag",{props:{closable:!0,color:"yellow"},on:{"on-close":function(e){t.deleteOnlyPermission(s,a,"sys_group_permission")}}},o[a])};for(var l in o)r(l);a.push(n)}),e("div",a)}},{title:"查看范围",key:"scope",render:function(e,s){var a=[];return s.row.scope.forEach(function(o,i){var n=void 0,r=function(a){n=e("Tag",{props:{closable:!0,color:"green"},on:{"on-close":function(e){t.deleteOnlyPermission(s,a,"sys_group_permission")}}},o[a])};for(var l in o)r(l);a.push(n)}),e("div",a)}},{title:"动作",key:"action",render:function(e,s){var a=[];return s.row.action.forEach(function(o,i){var n=void 0,r=function(a){n=e("Tag",{props:{closable:!0,color:"blue"},on:{"on-close":function(e){t.deleteOnlyPermission(s,a,"sys_group_permission")}}},o[a])};for(var l in o)r(l);a.push(n)}),e("div",a)}}],orgData:[],departmentColumns:[{title:"名称",key:"objName",width:170},{title:"资源",align:"center",key:"resource",render:function(e,s){var a=[];return s.row.resource.forEach(function(o,i){var n=void 0,r=function(a){n=e("Tag",{props:{closable:!0,color:"yellow"},on:{"on-close":function(e){t.deleteOnlyPermission(s,a,"sys_role_permission")}}},o[a])};for(var l in o)r(l);a.push(n)}),e("div",a)}},{title:"查看范围",key:"scope",render:function(e,s){var a=[];return s.row.scope.forEach(function(o,i){var n=void 0,r=function(a){n=e("Tag",{props:{closable:!0,color:"green"},on:{"on-close":function(e){t.deleteOnlyPermission(s,a,"sys_role_permission")}}},o[a])};for(var l in o)r(l);a.push(n)}),e("div",a)}},{title:"动作",key:"action",render:function(e,s){var a=[];return s.row.action.forEach(function(o,i){var n=void 0,r=function(a){n=e("Tag",{props:{closable:!0,color:"blue"},on:{"on-close":function(e){t.deleteOnlyPermission(s,a,"sys_role_permission")}}},o[a])};for(var l in o)r(l);a.push(n)}),e("div",a)}}],departmentData:[]}},methods:{showUserAction:function(){var t=this;this.isClose=!this.isClose,this.isUserEdit=!this.isUserEdit,this.isUserEdit?this.userColumns.push({title:"操作",key:"delete",render:function(e,s){return e("a",{on:{click:function(){t.deleteAllPermission(s,"sys_user_permission")}}},"删除")}}):this.userColumns.pop()},showOrgAction:function(){var t=this;this.isOrgEdit=!this.isOrgEdit,this.isOrgEdit?this.orgColumns.push({title:"操作",key:"delete",render:function(e,s){return e("a",{on:{click:function(){t.deleteAllPermission(s,"sys_group_permission")}}},"删除")}}):this.orgColumns.pop()},showDepartmentAction:function(){var t=this;this.isDepEdit=!this.isDepEdit,this.isDepEdit?this.departmentColumns.push({title:"操作",key:"delete",render:function(e,s){return e("a",{on:{click:function(){t.deleteAllPermission(s,"sys_role_permission")}}},"删除")}}):this.departmentColumns.pop()},deleteAllPermission:function(t,e){var s=this;this.$Modal.confirm({title:"确认",content:"确认删除此用户权限？",onOk:function(){s.spin=!0;var o,i=[];t.row.action.forEach(function(t){for(var e in t)i.push(e)}),t.row.resource.forEach(function(t){for(var e in t)i.push(e)}),t.row.scope.forEach(function(t){for(var e in t)i.push(e)}),o={list:e,single:t.row.objId,multi:i.join(",")},Object(a.b)(o).then(function(t){t.success&&(s.spin=!1,s.$Message.success(t.message),"sys_user_permission"===e?s.getUserPermissionData():"sys_group_permission"===e?s.getOrgPermissionData():s.getDepPermissionData())})}})},deleteOnlyPermission:function(t,e,s){var o=this;0===t.row.leaf?this.$Modal.confirm({title:"确认",content:'<b style="color:red;">注意</b>：这个操作会将<b>'+t.row.objName+"</b>从该列表中移除（如果<b>"+t.row.objName+"</b>没有其他权限的话）",onOk:function(){o.spin=!0;var i={list:s,single:t.row.objId,multi:e};i&&Object(a.b)(i).then(function(t){t.success&&(o.spin=!1,o.$Message.success(t.message),"sys_user_permission"===s?o.getUserPermissionData():"sys_group_permission"===s?o.getOrgPermissionData():o.getDepPermissionData())})}}):this.$Modal.confirm({title:"确认",content:"确认删除此权限？",onOk:function(){o.spin=!0;var i={list:s,single:t.row.objId,multi:e};i&&Object(a.b)(i).then(function(t){t.success&&(o.spin=!1,o.$Message.success(t.message),"sys_user_permission"===s?o.getUserPermissionData():"sys_group_permission"===s?o.getOrgPermissionData():o.getDepPermissionData())})}})},getUserPermissionData:function(){var t=this,e={listId:this.listId,objectType:"user"};Object(a.l)(e).then(function(e){var s=[];e.tableContent.forEach(function(e,a){e.action=JSON.parse(e.action),e.resource=JSON.parse(e.resource),e.scope=JSON.parse(e.scope),s.push(e),t.userData=s})})},getOrgPermissionData:function(){var t=this,e={listId:this.listId,objectType:"group"};Object(a.j)(e).then(function(e){var s=[];e.tableContent.forEach(function(e,a){e.action=JSON.parse(e.action),e.resource=JSON.parse(e.resource),e.scope=JSON.parse(e.scope),s.push(e),t.orgData=s})})},getDepPermissionData:function(){var t=this,e={listId:this.listId,objectType:"role"};Object(a.l)(e).then(function(e){var s=[];e.tableContent.forEach(function(e,a){e.action=JSON.parse(e.action),e.resource=JSON.parse(e.resource),e.scope=JSON.parse(e.scope),s.push(e),t.departmentData=s})})}},mounted:function(){this.getUserPermissionData(),this.getOrgPermissionData(),this.getDepPermissionData()}},b={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.spin?s("Spin"):t._e(),t._v(" "),s("Row",[s("Card",{staticClass:"app-card"},[s("p",{staticClass:"app-name",attrs:{slot:"title"},slot:"title"},[t._v("\n        应用权限\n      ")]),t._v(" "),s("Row",[s("Row",{staticStyle:{margin:"20px 0px"}},[s("Col",{attrs:{span:"1"}},[s("b",[t._v("用户")])]),t._v(" "),s("Col",{attrs:{span:"23"}},[s("a",{class:{isRed:t.isUserEdit},on:{click:t.showUserAction}},[t._v("修改")]),t._v(" "),s("span",{staticClass:"user-permission-desc"},[t._v("设置用户相对于当前应用的权限")])])],1),t._v(" "),s("Row",[s("Col",{attrs:{span:"24"}},[s("Table",{staticClass:"user-table",attrs:{stripe:"",height:"200",columns:t.userColumns,data:t.userData}})],1)],1)],1),t._v(" "),s("Row",{staticClass:"permission-line"}),t._v(" "),s("Row",[s("Row",{staticStyle:{margin:"20px 0px"}},[s("Col",{attrs:{span:"1"}},[s("b",[t._v("组织")])]),t._v(" "),s("Col",{attrs:{span:"23"}},[s("a",{class:{isRed:t.isOrgEdit},on:{click:t.showOrgAction}},[t._v("修改")]),t._v(" "),s("span",{staticClass:"user-permission-desc"},[t._v("设置组织相对于当前应用的权限")])])],1),t._v(" "),s("Row",[s("Col",{attrs:{span:"24"}},[s("Table",{staticClass:"org-table",attrs:{stripe:"",height:"200",columns:t.orgColumns,data:t.orgData}})],1)],1)],1),t._v(" "),s("Row",{staticClass:"permission-line"}),t._v(" "),s("Row",[s("Row",{staticStyle:{margin:"20px 0px"}},[s("Col",{attrs:{span:"1"}},[s("b",[t._v("职位")])]),t._v(" "),s("Col",{attrs:{span:"23"}},[s("a",{class:{isRed:t.isDepEdit},on:{click:t.showDepartmentAction}},[t._v("修改")]),t._v(" "),s("span",{staticClass:"user-permission-desc"},[t._v("设置职位相对于当前应用的权限")])])],1),t._v(" "),s("Row",[s("Col",{attrs:{span:"24"}},[s("Table",{staticClass:"dep-table",attrs:{stripe:"",height:"200",columns:t.departmentColumns,data:t.departmentData}})],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var C={name:"detail",components:{AppSetting:h,AppView:f,AppSubject:_,AppPermission:s("VU/8")(w,b,!1,function(t){s("mfvT")},"data-v-88500f04",null).exports},data:function(){return{appData:{},showEditAppInfo:!0,showPermission:!1,selectModel:"",showAdminModal:!1,selector:"",searchValue:"",adminColumns:[{type:"selection",width:60,align:"center"},{title:"工号",key:"userCode"},{title:"姓名",key:"nickname"}],adminData:[],sameAdminData:[],selectAdminData:[]}},watch:{searchValue:function(t){var e=[];t?(this.sameAdminData.forEach(function(s,a){(s.nickname.indexOf(t)>-1||s.userCode.indexOf(t)>-1)&&e.push(s)}),this.adminData=e):this.adminData=this.sameAdminData}},methods:{editAppinfo:function(){this.showEditAppInfo=!this.showEditAppInfo},showPermissionApp:function(){this.showPermission=!0},selectAdminModal:function(){this.showAdminModal=!0},confirmModal:function(){this.appData.modifer=this.selectAdminData[0].nickname},selectAdmin:function(t,e){this.selectAdminData=t}},mounted:function(){var t=this,e={uniqueId:this.$route.params.listId};console.log(this.$route),Object(a.c)({groupId:347}).then(function(e){t.adminData=e.tableContent,t.sameAdminData=e.tableContent}),Object(a.m)(e).then(function(e){t.appData=e[0]})}},k={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app-details"},[s("div",{staticClass:"shadow"},[s("div",{staticStyle:{width:"100%","background-color":"#fff"}},[s("header",{staticClass:"app-header"},[s("Breadcrumb",[s("BreadcrumbItem",{attrs:{to:"/"}},[t._v("首页")]),t._v(" "),s("BreadcrumbItem",{attrs:{to:"/app/list"}},[t._v("应用列表")]),t._v(" "),s("BreadcrumbItem",[t._v(t._s(t.appData.title))])],1)],1),t._v(" "),s("div",{staticClass:"app-main"},[s("img",{attrs:{src:t.appData.icon}}),t._v(" "),s("div",{staticClass:"app-main-content"},[t.showEditAppInfo?s("h3",[t._v(t._s(t.appData.title))]):s("Input",{staticStyle:{width:"200px"},model:{value:t.appData.title,callback:function(e){t.$set(t.appData,"title",e)},expression:"appData.title"}}),t._v(" "),s("b",{on:{click:t.editAppinfo}},[s("Icon",{staticClass:"app-edit-icon",attrs:{type:"edit"}})],1),t._v(" "),s("section",{staticClass:"app-section"},[s("div",{staticClass:"app-content-section"},[s("label",[t._v("管理员：")]),t._v(" "),t.showEditAppInfo?s("span",[t._v(t._s(t.appData.modifer))]):s("Input",{staticStyle:{width:"100px"},attrs:{icon:"arrow-down-b"},on:{"on-click":t.selectAdminModal},model:{value:t.appData.modifer,callback:function(e){t.$set(t.appData,"modifer",e)},expression:"appData.modifer"}})],1),t._v(" "),s("div",{staticClass:"app-content-section"},[s("label",[t._v("状态：")]),t._v(" "),s("Tag",{attrs:{color:"blue"}},[t._v("未发布")])],1),t._v(" "),s("div",{staticClass:"app-content-section"},[s("label",[t._v("创建时间：")]),t._v(" "),s("span",[t._v(t._s(t.appData.modTime))])])]),t._v(" "),s("section",{staticClass:"app-section"},[t._m(0),t._v(" "),s("div",{staticClass:"app-content-section"},[s("label",[t._v("类型：")]),t._v(" "),s("span",[t._v(t._s(t.appData.transType))])]),t._v(" "),s("div",{staticClass:"app-content-section"},[s("label",[t._v("创建者：")]),t._v(" "),s("span",[t._v(t._s(t.appData.modifer))])])]),t._v(" "),s("section",{staticClass:"app-section"},[s("div",{staticClass:"app-content-comment"},[s("label",[t._v("说明：")]),t._v(" "),t.showEditAppInfo?s("span",[t._v(t._s(t.appData.comment))]):s("Input",{staticStyle:{width:"350px"},model:{value:t.appData.comment,callback:function(e){t.$set(t.appData,"comment",e)},expression:"appData.comment"}})],1)])],1)])]),t._v(" "),s("app-setting",{attrs:{listId:this.$route.params.listId},on:{showPermissionApp:t.showPermissionApp}}),t._v(" "),s("app-permission",{attrs:{listId:this.$route.params.listId}}),t._v(" "),s("app-view"),t._v(" "),s("app-subject"),t._v(" "),s("Modal",{attrs:{title:"请选择"},on:{"on-ok":t.confirmModal},model:{value:t.showAdminModal,callback:function(e){t.showAdminModal=e},expression:"showAdminModal"}},[s("div",{staticClass:"app-search"},[s("Icon",{staticClass:"app-search-icon",attrs:{type:"search"}}),t._v(" "),s("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"搜索"},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}})],1),t._v(" "),s("Table",{attrs:{height:"400",stripe:"",columns:t.adminColumns,size:"small",data:t.adminData},on:{"on-select":t.selectAdmin}})],1)],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"app-content-section"},[e("label",[this._v("实例数：")]),this._v(" "),e("span",[this._v("2000")])])}]};var D=s("VU/8")(C,k,!1,function(t){s("O+RC")},"data-v-2d00d281",null);e.default=D.exports},FPDy:function(t,e){},L3CM:function(t,e){},"O+RC":function(t,e){},TmqI:function(t,e){},VSt5:function(t,e){},Vv9g:function(t,e){},iE1W:function(t,e){},mfvT:function(t,e){}});
//# sourceMappingURL=3.e931263a50daad5555f2.js.map
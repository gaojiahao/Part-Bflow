webpackJsonp([3],{"+5sK":function(t,e){},"0rwx":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("GIAq"),i={name:"permissionModal",components:{},props:{appListId:String,modalPermissionStatus:Boolean},data:function(){return{selectUser:"",selectOrg:"",selectPosition:"",searchValue:"",tableSize:"small",emitChange:0,showUserModal:!1,showOrgModal:!1,showDepartmentModal:!1,showPermissionModal:!1,sameUserData:[],userSelectData:[],orgSelectData:[],departmentSelectData:[],userColumns:[],userData:[],orgColumns:[],orgData:[],departmentColumns:[],departmentData:[],allPermissionData:[],permissionSelectDatas:[],allPermissionColumns:[{type:"selection",width:60,align:"center"},{title:"类型",key:"type"},{title:"资源",key:"name"}],userSelection:[],orgSelection:[],departmentSelection:[]}},watch:{modalPermissionStatus:function(t,e){this.showPermissionModal=t,this.getData(),this.userSelectData=[],this.orgSelectData=[],this.departmentSelectData=[],this.userSelection=[],this.orgSelection=[],this.departmentSelection=[]},searchValue:function(t){var e=[];t?(this.sameUserData.forEach(function(a,s){(a.nickname.indexOf(t)>-1||a.userCode.indexOf(t)>-1)&&e.push(a)}),this.userData=e):this.userData=this.sameUserData}},methods:{confirmMember:function(){},selectUserModal:function(){var t=this;this.showUserModal=!0,this.userColumns=[{type:"selection",width:60,align:"center"},{title:"姓名",key:"nickname"},{title:"工号",key:"userCode"}],Object(s.k)().then(function(e){t.userData=e.tableContent,t.sameUserData=e.tableContent})},selectOrgModal:function(){var t=this;this.showOrgModal=!0,this.orgColumns=[{type:"selection",width:60,align:"center"},{title:"名称",key:"name"}],Object(s.h)().then(function(e){t.orgData=e.tableContent})},selectPositionModal:function(){var t=this;this.showDepartmentModal=!0,this.departmentColumns=[{type:"selection",width:60,align:"center"},{title:"名称",key:"name"}],Object(s.g)().then(function(e){t.departmentData=e.tableContent})},selectUserClick:function(t,e){var a=this;this.userSelection.length>0?t.forEach(function(t,e){a.userSelection.push(t)}):this.userSelection=t},selectOrgClick:function(t,e){var a=this;this.orgSelection.length>0?t.forEach(function(t,e){a.orgSelection.push(t)}):this.orgSelection=t},selectDepartmentClick:function(t,e){var a=this;this.departmentSelection.length>0?t.forEach(function(t,e){a.departmentSelection.push(t)}):this.departmentSelection=t},deleteUser:function(t){this.userSelectData.splice(t,1)},deleteOrg:function(t){this.orgSelectData.splice(t,1)},deleteDepartment:function(t){this.departmentSelectData.splice(t,1)},permissionSelectData:function(t,e){this.permissionSelectDatas=t},confirmUser:function(){var t={};this.userSelectData=this.userSelection.reduce(function(e,a){return!t[a.userId]&&(t[a.userId]=e.push(a)),e},[])},confirmOrg:function(){var t={};this.orgSelectData=this.orgSelection.reduce(function(e,a){return!t[a.id]&&(t[a.id]=e.push(a)),e},[])},confirmDepartment:function(){var t={};this.departmentSelectData=this.departmentSelection.reduce(function(e,a){return!t[a.id]&&(t[a.id]=e.push(a)),e},[])},submitPermission:function(){var t=this,e=this.userSelectData.map(function(t){return t.userId}),a=this.orgSelectData.map(function(t){return t.id}),i=this.departmentSelectData.map(function(t){return t.id}),n=this.permissionSelectDatas.map(function(t){return t.id}),o={userId:e.join(","),roleId:i.join(","),groupId:a.join(","),permissionId:n.join(",")};o&&Object(s.a)(o).then(function(e){if(e.success){t.$Message.success(e.message);var a=t.emitChange++;t.$emit("reGetData",a)}})},getData:function(){var t=this,e={listId:this.appListId};Object(s.i)(e).then(function(e){t.allPermissionData=e.tableContent})},modalVisibleChange:function(t){t||this.$emit("emitPermissionModal",{modal:!1})}},mounted:function(){this.getData()}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{attrs:{title:"应用权限",width:"1000","mask-closable":!1},on:{"on-ok":t.submitPermission,"on-visible-change":t.modalVisibleChange},model:{value:t.showPermissionModal,callback:function(e){t.showPermissionModal=e},expression:"showPermissionModal"}},[a("div",[a("Row",{staticStyle:{"margin-bottom":"15px"},attrs:{gutter:8}},[a("Col",{attrs:{span:"8"}},[a("label",[t._v("用户")]),t._v(" "),a("Input",{staticStyle:{width:"200px"},attrs:{icon:"arrow-down-b"},on:{"on-click":t.selectUserModal},model:{value:t.selectUser,callback:function(e){t.selectUser=e},expression:"selectUser"}})],1),t._v(" "),a("Col",{attrs:{span:"8"}},[a("label",[t._v("组织")]),t._v(" "),a("Input",{staticStyle:{width:"200px"},attrs:{icon:"arrow-down-b"},on:{"on-click":t.selectOrgModal},model:{value:t.selectOrg,callback:function(e){t.selectOrg=e},expression:"selectOrg"}})],1),t._v(" "),a("Col",{attrs:{span:"8"}},[a("label",[t._v("职位")]),t._v(" "),a("Input",{staticStyle:{width:"200px"},attrs:{icon:"arrow-down-b"},on:{"on-click":t.selectPositionModal},model:{value:t.selectPosition,callback:function(e){t.selectPosition=e},expression:"selectPosition"}})],1)],1),t._v(" "),a("Row",{attrs:{gutter:8}},[a("Col",{staticClass:"permission-tab",attrs:{span:"12"}},[a("Row",{staticClass:"permission-top-line"}),t._v(" "),a("Row",[a("Col",{attrs:{span:"3"}},[a("b",{staticClass:"permission-title"},[t._v("用户")])]),t._v(" "),a("Col",{staticStyle:{height:"100px"},attrs:{span:"21"}},t._l(t.userSelectData,function(e,s){return a("Tag",{key:s,attrs:{type:"border",closable:"",color:"yellow"},on:{"on-close":function(e){t.deleteUser(s)}}},[t._v(t._s(e.nickname))])}))],1),t._v(" "),a("Row",{staticClass:"permission-line"}),t._v(" "),a("Row",[a("Col",{attrs:{span:"3"}},[a("b",{staticClass:"permission-title"},[t._v("组织")])]),t._v(" "),a("Col",{staticStyle:{height:"100px"},attrs:{span:"21"}},t._l(t.orgSelectData,function(e,s){return a("Tag",{key:s,attrs:{type:"border",closable:"",color:"green"},on:{"on-close":function(e){t.deleteOrg(s)}}},[t._v(t._s(e.name))])}))],1),t._v(" "),a("Row",{staticClass:"permission-line"}),t._v(" "),a("Row",[a("Col",{attrs:{span:"3"}},[a("b",{staticClass:"permission-title"},[t._v("职位")])]),t._v(" "),a("Col",{staticStyle:{height:"100px"},attrs:{span:"21"}},t._l(t.departmentSelectData,function(e,s){return a("Tag",{key:s,attrs:{type:"border",closable:"",color:"blue"},on:{"on-close":function(e){t.deleteDepartment(s)}}},[t._v(t._s(e.name))])}))],1)],1),t._v(" "),a("Col",{attrs:{span:"12"}},[a("Table",{attrs:{stripe:"",height:"350",columns:t.allPermissionColumns,data:t.allPermissionData},on:{"on-select":t.permissionSelectData}})],1)],1),t._v(" "),a("Modal",{attrs:{title:"用户选择","mask-closable":!1,transfer:!1},on:{"on-ok":t.confirmUser},model:{value:t.showUserModal,callback:function(e){t.showUserModal=e},expression:"showUserModal"}},[a("div",{staticClass:"app-search"},[a("Icon",{staticClass:"app-search-icon",attrs:{type:"search"}}),t._v(" "),a("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"搜索"},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}})],1),t._v(" "),a("Table",{attrs:{height:"400",stripe:"",size:"small",columns:t.userColumns,data:t.userData},on:{"on-select":t.selectUserClick}})],1),t._v(" "),a("Modal",{attrs:{title:"组织选择","mask-closable":!1,transfer:!1},on:{"on-ok":t.confirmOrg},model:{value:t.showOrgModal,callback:function(e){t.showOrgModal=e},expression:"showOrgModal"}},[a("Table",{attrs:{height:"400",stripe:"",size:"small",columns:t.orgColumns,data:t.orgData},on:{"on-select":t.selectOrgClick}})],1),t._v(" "),a("Modal",{attrs:{title:"职位选择","mask-closable":!1,transfer:!1},on:{"on-ok":t.confirmDepartment},model:{value:t.showDepartmentModal,callback:function(e){t.showDepartmentModal=e},expression:"showDepartmentModal"}},[a("Table",{attrs:{height:"400",stripe:"",size:t.tableSize,columns:t.departmentColumns,data:t.departmentData},on:{"on-select":t.selectDepartmentClick}})],1)],1)])},staticRenderFns:[]};var o=a("VU/8")(i,n,!1,function(t){a("xsLq")},"data-v-a17a0a08",null).exports,l={name:"WorkflowModal",props:{modalWorkflowStatus:Boolean,listId:String},data:function(){var t=this;return{showWorkFlow:!1,relativeWorkFlowTotal:0,allWorkFlowTotal:0,allCurrentPage:1,relativeCurrentPage:1,pageSize:10,loadingAll:!0,loadingRelative:!0,allWorkFlowColumns:[{type:"selection",width:60,align:"center"},{title:"名称",key:"processName"},{title:"编码",key:"processCode"},{title:"查看流程图",key:"action",align:"center",render:function(t,e){return t("a",{props:{type:"default",size:"small"},on:{click:function(){window.open("/myflow/viewProc.html?processId="+e.row.id)}}},"查看")}}],relativeWorkFlowColumns:[{title:"名称",key:"processName"},{title:"编码",key:"processCode"},{title:"配置节点",key:"action",align:"center",render:function(e,a){return e("a",{props:{type:"default",size:"small"},on:{click:function(){window.open("/myflow/viewFlow.html?processId="+a.row.id+"&listId="+t.listId+"&processCode="+a.row.processCode)}}},"配置")}}],allWorkFlowData:[],relativeWorkFlowData:[]}},watch:{modalWorkflowStatus:function(t,e){this.showWorkFlow=t}},methods:{selectWorkFlow:function(){},getAllWorkflowData:function(){var t=this,e={page:this.allCurrentPage,limit:this.pageSize};this.loadingAll=!0,Object(s.j)(e).then(function(e){t.allWorkFlowData=e.tableContent,t.allWorkFlowTotal=e.dataCount,t.loadingAll=!1})},getRelativeWorkflowData:function(){var t=this,e={page:this.relativeCurrentPage,limit:this.pageSize,listId:this.listId};this.loadingRelative=!0,Object(s.r)(e).then(function(e){t.relativeWorkFlowData=e,t.relativeWorkFlowTotal=e.length,t.loadingRelative=!1})},onPageChange:function(t){this.allCurrentPage=t,this.getAllWorkflowData()},onRelativePageChange:function(t){this.relativeCurrentPage=t,this.getRelativeWorkflowData()},modalVisibleChange:function(t){t||this.$emit("emitWorkFlowModal",{modal:!1})},addWorkflow:function(t,e){if(0===this.relativeWorkFlowData.length)this.saveWorkFlow(t);else for(var a=0;a<this.relativeWorkFlowData.length;a++){if(t.id===this.relativeWorkFlowData[a].id){this.$Message.warning("已有选择的工作流！");break}this.saveWorkFlow(t);break}},saveWorkFlow:function(t){var e=this,a={listId:this.listId,procCode:t.processCode,creator:"",list:"list_process_rel",status:1};Object(s.v)(a).then(function(t){t.success&&(e.$Message.success(t.message),e.getRelativeWorkflowData())})},deleteWorkflow:function(t,e){var a=this,i={ID:t.id,list:"list_process_rel",status:0};Object(s.v)(i).then(function(t){t.success&&(a.$Message.success(t.message),a.relativeWorkFlowData.splice(e,1))})},createWorkflow:function(){window.open("/myflow/createWorkFlow.html?listId="+this.listId)}},mounted:function(){this.getAllWorkflowData(),this.getRelativeWorkflowData()}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{attrs:{title:"工作流设置",width:"1010","mask-closable":!1},on:{"on-ok":t.selectWorkFlow,"on-visible-change":t.modalVisibleChange},model:{value:t.showWorkFlow,callback:function(e){t.showWorkFlow=e},expression:"showWorkFlow"}},[a("Row",{attrs:{gutter:8}},[a("Col",{attrs:{span:"12"}},[a("h4",{staticClass:"flow-title"},[t._v("所有工作流\n      "),a("Button",{staticClass:"create-button",on:{click:t.createWorkflow}},[t._v("创建工作流")])],1),t._v(" "),a("Table",{attrs:{loading:t.loadingAll,stripe:"",height:"350",columns:t.allWorkFlowColumns,data:t.allWorkFlowData},on:{"on-row-dblclick":t.addWorkflow}}),t._v(" "),a("div",{staticClass:"workflow-page"},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:t.allWorkFlowTotal,current:t.allCurrentPage,"page-size":t.pageSize,size:"small","show-total":""},on:{"on-change":t.onPageChange}})],1)])],1),t._v(" "),a("Col",{attrs:{span:"12"}},[a("h4",{staticClass:"flow-title"},[t._v("已关联的工作流\n      "),a("Button",{staticClass:"create-button",on:{click:t.createWorkflow}},[t._v("创建工作流")])],1),t._v(" "),a("Table",{attrs:{loading:t.loadingRelative,stripe:"",height:"350",columns:t.relativeWorkFlowColumns,data:t.relativeWorkFlowData},on:{"on-row-dblclick":t.deleteWorkflow}}),t._v(" "),a("div",{staticClass:"workflow-page"},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:t.relativeWorkFlowTotal,current:t.relativeCurrentPage,"page-size":t.pageSize,size:"small","show-total":""},on:{"on-change":t.onRelativePageChange}})],1)])],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(l,r,!1,function(t){a("k7Qp")},"data-v-5d9b46cc",null).exports,p=a("mvHQ"),d=a.n(p),u={name:"navModal",props:{modalNavStatus:Boolean,listId:String},data:function(){return{showNav:!1,viewId:"",navData:[],selectedNode:{}}},watch:{modalNavStatus:function(t,e){this.showNav=t,t&&(this.navData=[],this.getNavData())}},methods:{modalVisibleChange:function(t){t||this.$emit("emitNavModal",{modal:!1})},publishApp:function(){var t=this;this.selectedNode&&Object(s.s)(this.selectedNode).then(function(e){e.success&&(t.$Message.success(e.message),t.$emit("hasPublished","已发布"))})},getNodeSelectedData:function(t,e){var a=this,i={filter:d()([{operator:"eq",value:this.listId,property:"uniqueId"},{operator:"eq",value:1,property:"listViewStatus"}])},n={};Object(s.o)(i).then(function(s){for(var i=0;i<s.tableContent.length;i++){if(1===s.tableContent[i].isDefault){a.viewId=s.tableContent[i].viewId;break}a.viewId=s.tableContent[0].viewId}n={id:e.id,listId:a.listId,parentId:e.parentId},t.target.style.backgroundColor?(t.target.style.backgroundColor="#fff",t.target.style.padding="0px",t.target.style.color="#333"):(t.target.style.backgroundColor="rgba(242, 157, 30, 0.9)",t.target.style.padding="3px",t.target.style.color="#fff",a.selectedNode=n)})},getNavData:function(){var t=this;Object(s.q)({parentId:"root"}).then(function(e){e.forEach(function(e,a){1===e.leaf?t.navData.push({title:e.text,id:e.id,parentId:e.parentId,url:e.url,icon:e.icon,render:function(e,a){a.root,a.node;var s=a.data;return e("span",{style:{display:"inline-block",width:"100%"}},[e("span",[e("Icon",{props:{type:"ios-folder-outline"},style:{marginRight:"8px",color:"#FF8F59",fontSize:"1rem"}}),e("span",{style:{cursor:"pointer"},on:{click:function(e){t.getNodeSelectedData(e,s)}}},s.title)])])}}):t.navData.push({title:e.text,id:e.id,parentId:e.parentId,url:e.url,icon:e.icon,loading:!1,children:[],render:function(e,a){a.root,a.node;var s=a.data;return e("span",{style:{display:"inline-block",width:"100%"}},[e("span",[e("Icon",{props:{type:"folder"},style:{marginRight:"8px",color:"#39f",fontSize:"1.2rem"}}),e("span",{style:{cursor:"pointer"},on:{click:function(e){t.getNodeSelectedData(e,s)}}},s.title)])])}})})})},loadData:function(t,e){var a=this,i={parentId:t.id};Object(s.q)(i).then(function(t){var s=[];t.forEach(function(t){1===t.leaf?s.push({title:t.text,id:t.id,parentId:t.parentId,url:t.url,icon:t.icon,render:function(t,e){e.root,e.node;var s=e.data;return t("span",{style:{display:"inline-block",width:"100%"}},[t("span",[t("Icon",{props:{type:"ios-folder-outline"},style:{marginRight:"8px",color:"#FF8F59",fontSize:"1rem"}}),t("span",{style:{cursor:"pointer"},on:{click:function(t){a.getNodeSelectedData(t,s)}}},s.title)])])}}):s.push({title:t.text,id:t.id,parentId:t.parentId,url:t.url,icon:t.icon,loading:!1,children:[],render:function(t,e){e.root,e.node;var s=e.data;return t("span",{style:{display:"inline-block",width:"100%"}},[t("span",[t("Icon",{props:{type:"folder"},style:{marginRight:"8px",color:"#39f",fontSize:"1.2rem"}}),t("span",{style:{cursor:"pointer"},on:{click:function(t){a.getNodeSelectedData(t,s)}}},s.title)])])}})}),e(s)})}},mounted:function(){}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{attrs:{title:"导航",width:"300","mask-closable":!1},on:{"on-ok":t.publishApp,"on-visible-change":t.modalVisibleChange},model:{value:t.showNav,callback:function(e){t.showNav=e},expression:"showNav"}},[a("Tree",{staticClass:"nav-tree",attrs:{data:t.navData,"load-data":t.loadData}})],1)},staticRenderFns:[]};var m={name:"appSetting",components:{PermissionModal:o,WorkflowModal:c,NavModal:a("VU/8")(u,h,!1,function(t){a("TVzc")},"data-v-531def5a",null).exports},props:["listId"],data:function(){return{showPermissionModal:!1,showWorkFlow:!1,showNav:!1}},methods:{emitPermissionModal:function(){this.showPermissionModal=!1},emitWorkFlowModal:function(){this.showWorkFlow=!1},emitNavModal:function(){this.showNav=!1},showNavModal:function(){this.showNav=!0},hasPublished:function(t){this.$emit("childHasPublished",t)},showPermissionApp:function(){this.showPermissionModal=!0},submitPermission:function(){},showWorkFlowModal:function(){this.showWorkFlow=!0},goForm:function(){window.open("/Form/index.html?viewDesign=true&list="+this.listId)},reGetData:function(t){this.$emit("getData",t)}},mounted:function(){}},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Row",[a("div",{staticClass:"app-card"},[a("Col",{attrs:{span:"6"}},[a("Row",{staticClass:"app-body-card"},[a("ul",[a("li",[a("b",[t._v("表单设置")])]),t._v(" "),a("li",[a("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),a("a",[t._v("部件内部数据源过滤")])]),t._v(" "),a("li",[a("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),a("a",[t._v("部件之间数据过滤")])]),t._v(" "),a("li",[a("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),a("a",[t._v("科目分录设置")])]),t._v(" "),a("li",[a("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),a("a",{on:{click:t.goForm}},[t._v("表单设置")])])])])],1),t._v(" "),a("Col",{attrs:{span:"6"}},[a("Row",{staticClass:"app-body-card"},[a("ul",[a("li",[a("b",[t._v("工作流设置")])]),t._v(" "),a("li",[a("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),a("a",[t._v("一般工作流图")])]),t._v(" "),a("li",[a("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),a("a",{on:{click:t.showWorkFlowModal}},[t._v("工作流设置")])])])])],1),t._v(" "),a("Col",{attrs:{span:"6"}},[a("Row",{staticClass:"app-body-card"},[a("p",{staticClass:"app-title",attrs:{slot:"title"},slot:"title"},[t._v("报表设置")]),t._v(" "),a("ul",[a("li",[a("b",[t._v("报表设置")])]),t._v(" "),a("li",[a("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),a("a",[t._v("对象查阅项")])]),t._v(" "),a("li",[a("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),a("a",[t._v("报表权限")])])])])],1),t._v(" "),a("Col",{attrs:{span:"6"}},[a("Row",{staticClass:"app-body-card"},[a("ul",[a("li",[a("b",[t._v("相关应用设置")])]),t._v(" "),a("li",[a("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),a("a",[t._v("应用信息设置")])]),t._v(" "),a("li",[a("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),a("a",{on:{click:t.showPermissionApp}},[t._v("权限设置")])]),t._v(" "),a("li",[a("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),a("a",{on:{click:t.showNavModal}},[t._v("导航")])])])])],1)],1)]),t._v(" "),a("nav-modal",{attrs:{listId:t.listId,modalNavStatus:t.showNav},on:{emitNavModal:t.emitNavModal,hasPublished:t.hasPublished}}),t._v(" "),a("workflow-modal",{attrs:{modalWorkflowStatus:t.showWorkFlow,listId:t.listId},on:{emitWorkFlowModal:t.emitWorkFlowModal}}),t._v(" "),a("permission-modal",{attrs:{modalPermissionStatus:t.showPermissionModal,appListId:t.listId},on:{emitPermissionModal:t.emitPermissionModal,reGetData:t.reGetData}})],1)},staticRenderFns:[]};var f=a("VU/8")(m,v,!1,function(t){a("Kpdl")},"data-v-bcb246fa",null).exports,w={name:"appView",components:{},props:{listId:String,appType:String},data:function(){var t=this;return{columns:[{title:"视图名称",key:"title",render:function(e,a){return e("a",{on:{click:function(){window.open("/appSetting/viewConfig/"+t.listId+"/"+a.row.viewId)}}},a.row.title)}},{title:"创建时间",key:"crtTime"},{title:"创建者",key:"creator"},{title:"默认视图",key:"isDefault",width:100,align:"center",render:function(e,a){var s=!1;return 1===a.row.isDefault&&(s=!0),e("Radio",{props:{value:s},on:{"on-change":function(e){t.$Modal.confirm({title:"确认",content:"你确定将此视图设为默认视图？",onOk:function(){t.setDefaultViews(a)}})}}})}},{title:"操作",key:"action",width:150,align:"center",render:function(e,a){return e("Button",{props:{type:"error",size:"small"},on:{click:function(e){t.deleteViews(a,a.index)}}},"删除")}}],tableData:[]}},methods:{getViewsData:function(){var t=this,e={filter:d()([{operator:"eq",value:this.listId,property:"uniqueId"},{operator:"eq",value:1,property:"listViewStatus"}])};Object(s.o)(e).then(function(e){t.tableData=e.tableContent})},setDefaultViews:function(t){var e=this,a={viewId:t.row.viewId,listId:this.listId};Object(s.u)(a).then(function(t){t.success&&e.reloadViewData()})},reloadViewData:function(){var t=this,e={filter:d()([{operator:"eq",value:this.listId,property:"uniqueId"},{operator:"eq",value:1,property:"listViewStatus"}])};Object(s.o)(e).then(function(e){t.tableData=e.tableContent,t.columns[3].render=function(t,e){return 1===e.row.isDefault?t("Radio",{props:{value:!0}}):t("Radio",{props:{value:!1}})},t.$Message.success(e.message)})},deleteViews:function(t,e){var a=this;if(1===this.tableData.length)this.$Message.warning("不可删除唯一视图！");else if(1===t.row.isDefault){var i={viewId:t.row.viewId,listId:this.listId};Object(s.d)(i).then(function(t){if(t.success){a.tableData.splice(e,1);var i={viewId:a.tableData[0].viewId,listId:a.listId};Object(s.u)(i).then(function(t){t.success&&a.reloadViewData()})}})}else{var n={viewId:t.row.viewId,listId:this.listId};Object(s.d)(n).then(function(t){t.success&&(a.tableData.splice(e,1),a.$Message.success(t.message))})}},goCreateView:function(){window.open("/appSetting/"+this.listId+"/"+this.appType+"/viewTypes")}},created:function(){this.getViewsData()},mounted:function(){}},g={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"app-card"},[e("h2",{staticClass:"app-name"},[this._v("\n    应用视图\n  ")]),this._v(" "),e("a",{staticClass:"create-view",on:{click:this.goCreateView}},[this._v("创建视图")]),this._v(" "),e("Table",{attrs:{columns:this.columns,data:this.tableData}})],1)},staticRenderFns:[]};var _=a("VU/8")(w,g,!1,function(t){a("3PLy")},"data-v-07b51168",null).exports,b={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("Row",[e("div",{staticClass:"app-card"},[e("h2",{staticClass:"app-name"},[this._v("\n        应用科目\n      ")]),this._v(" "),e("Table",{attrs:{columns:this.columns,data:this.tableData}})],1)])],1)},staticRenderFns:[]};var k=a("VU/8")({name:"appSubject",components:{},data:function(){return{columns:[{title:"名称",key:"name"},{title:"分类",key:"type"},{title:"启用",key:"defaultView",width:150,align:"center",render:function(t,e){return t("Checkbox",{props:{value:!0}})}}],tableData:[{name:"存货",type:"计划类"},{name:"费用",type:"会计类"}]}},methods:{},mounted:function(){}},b,!1,function(t){a("HDB/")},"data-v-45b31d7d",null).exports,D={name:"appPermission",components:{},props:{listId:String,regetData:Number},data:function(){var t=this;return{isUserEdit:!1,isOrgEdit:!1,isDepEdit:!1,userColumns:[{title:"姓名",key:"objName",width:100,hidden:!0},{title:"资源",key:"resource",align:"center",render:function(e,a){var s=[],i=JSON.parse(a.row.resource);if(i.length>0)return i.forEach(function(i,n){var o=void 0,l=function(s){o=e("Tag",{props:{type:"border",closable:!0,color:"yellow"},on:{"on-close":function(e){t.deleteOnlyPermission(e,a,s,a.row.list)}}},i[s])};for(var r in i)l(r);s.push(o)}),e("div",s)}},{title:"查看范围",key:"scope",render:function(e,a){var s=[],i=JSON.parse(a.row.scope);if(i.length>0)return i.forEach(function(i,n){var o=void 0,l=function(s){o=e("Tag",{props:{closable:!0,color:"green"},on:{"on-close":function(e){t.deleteOnlyPermission(e,a,s,a.row.list)}}},i[s])};for(var r in i)l(r);s.push(o)}),e("div",s)}},{title:"动作",key:"action",render:function(e,a){var s=[],i=JSON.parse(a.row.action);if(i.length>0)return i.forEach(function(i,n){var o=void 0,l=function(s){o=e("Tag",{props:{type:"border",closable:!0,color:"blue"},on:{"on-close":function(e){t.deleteOnlyPermission(e,a,s,a.row.list)}}},i[s])};for(var r in i)l(r);s.push(o)}),e("div",s)}},{title:"操作",key:"delete",render:function(e,a){return e("a",{on:{click:function(e){t.deleteAllPermission(e,a,a.row.list)}}},"删除")}}],userData:[],authorityList:{},appItem:[{title:"用户",type:"sys_user_permission"},{title:"组织",type:"sys_group_permission"},{title:"职位",type:"sys_role_permission"}]}},watch:{regetData:function(t){this.getAllData()}},methods:{deleteAllPermission:function(t,e,a){var i=this;i.$Modal.confirm({title:"确认",content:"确认删除此用户权限？",onOk:function(){var n,o=[];JSON.parse(e.row.action).forEach(function(t){for(var e in t)o.push(e)}),JSON.parse(e.row.resource).forEach(function(t){for(var e in t)o.push(e)}),JSON.parse(e.row.scope).forEach(function(t){for(var e in t)o.push(e)}),n={list:a,single:e.row.objId,multi:o.join(",")},Object(s.e)(n).then(function(e){e.success&&(i.$Message.success(e.message),t.target.parentElement.parentElement.parentElement.style.display="none")})}})},deleteOnlyPermission:function(t,e,a,i){var n=this,o=e.row.leaf?"确认删除此权限？":'<b style="color:red;">注意</b>：这个操作会将<b>'+e.row.objName+"</b>从该列表中移除(如果<b>"+e.row.objName+"</b>没有其他权限的话)";n.$Modal.confirm({title:"确认",content:o,onOk:function(){var o={list:i,single:e.row.objId,multi:a};o&&Object(s.e)(o).then(function(e){e.success&&(n.$Message.success(e.message),t.target.parentElement.style.display="none")})}})},getAllData:function(){var t=this;Object(s.m)(this.listId).then(function(e){e.tableContent[0]&&(t.authorityList=e.tableContent.reduce(function(t,e,a){return t[e.list]=t[e.list]||[],t[e.list].push(e),t},{}))})}},created:function(){this.getAllData()}},C={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-card"},[a("h2",{staticClass:"app-name"},[t._v("\n    应用权限\n  ")]),t._v(" "),t._l(t.appItem,function(e){return a("Row",{key:e.type},[a("Row",{staticStyle:{margin:"10px 15px"}},[a("span",{staticClass:"app-card-item-title"},[t._v(t._s(e.title))]),t._v(" "),a("span",{staticClass:"user-permission-desc",domProps:{innerHTML:t._s("设置"+e.title+"相对于当前应用的权限")}})]),t._v(" "),a("Row",[a("Col",{attrs:{span:"24"}},[a("Table",{staticClass:"user-table",attrs:{height:"200",columns:t.userColumns,data:t.authorityList[e.type]}})],1)],1)],1)})],2)},staticRenderFns:[]};var y={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"timeline-box",attrs:{fix:""}},[a("h2",[t._v("变更日志")]),t._v(" "),a("Timeline",{staticClass:"timeline-list",attrs:{pending:""}},t._l(t.data,function(e){return a("TimelineItem",{key:e.transCode},[a("p",{staticClass:"time"},[t._v(t._s(e.transCode))]),t._v(" "),a("ul",{staticClass:"timeline-item-content-ul"},[a("li",[a("span",[t._v(t._s(e.updateUser))]),t._v(" "),a("span",[t._v(t._s(e.updateTime))]),t._v(" "),a("span",[t._v("耗用时间:"+t._s(e.hour))])]),t._v(" "),a("li",[a("span",[t._v("更新范围:")]),t._v(" "),t._l(e.undateScope,function(e,s){return a("span",{key:s,staticClass:"customs-tag"},[t._v(t._s(e))])})],2),t._v(" "),a("li",[a("span",[t._v("备注:"+t._s(e.content))])])])])}))],1)},staticRenderFns:[]};var I={name:"detail",components:{AppSetting:f,AppView:_,AppSubject:k,AppPermission:a("VU/8")(D,C,!1,function(t){a("LYOW")},"data-v-32a28091",null).exports,TimeLine:a("VU/8")({name:"TimeLine",data:function(){return{data:[{transCode:"0001",objName:"采购入库",appType:"YW1",undateScope:["表单","科目关系","报表","工作流","权限"],updateUser:"管理员",updateTime:"2018-07-10",hour:"1:30",content:"测试"},{transCode:"0002",objName:"采购入库",appType:"YW1",undateScope:["表单","科目关系","报表","工作流","权限"],appBigType:"YW2",updateUser:"管理员",updateTime:"2018-07-10",hour:"1:30",content:"测试"},{transCode:"0003",objName:"采购入库",appType:"YW1",undateScope:["表单","科目关系","报表","工作流","权限"],appBigType:"YW2",updateUser:"管理员",updateTime:"2018-07-10",hour:"1:30",content:"测试"},{transCode:"0004",objName:"采购入库",appType:"YW1",appBigType:"YW2",undateScope:["表单","科目关系","报表","工作流","权限"],updateUser:"管理员",updateTime:"2018-07-10",hour:"1:30",content:"测试"},{transCode:"0005",objName:"采购入库",undateScope:["表单","科目关系","报表","工作流","权限"],appType:"YW1",appBigType:"YW2",updateUser:"管理员",updateTime:"2018-07-10",hour:"1:30",content:"测试"}]}}},y,!1,function(t){a("Y1OT")},null,null).exports},data:function(){return{appData:{},regetData:1e3,showEditAppInfo:!0,showPermission:!1,showSubjectView:!1,selectModel:"",showAdminModal:!1,selector:"",searchValue:"",hasPublishStatus:"已发布",notPublishStatus:"未发布",notAppStatusColor:"blue",hasAppStatusColor:"green",adminColumns:[{title:"工号",key:"userCode"},{title:"姓名",key:"nickname"}],adminData:[],sameAdminData:[],selectAdminData:{}}},watch:{searchValue:function(t){var e=[];t?(this.sameAdminData.forEach(function(a,s){(a.nickname.indexOf(t)>-1||a.userCode.indexOf(t)>-1)&&e.push(a)}),this.adminData=e):this.adminData=this.sameAdminData}},methods:{childHasPublished:function(t){this.appData.publish=1},editAppinfo:function(){var t=this;if(this.showEditAppInfo=!this.showEditAppInfo,this.showEditAppInfo){var e={list:"list",uniqueId:this.appData.uniqueId,title:this.appData.title,administrator:this.appData.userId,comment:this.appData.comment};Object(s.t)(e).then(function(e){e.success&&t.$Message.success(e.message)})}},showPermissionApp:function(){this.showPermission=!0},selectAdminModal:function(){this.showAdminModal=!0},confirmModal:function(){this.appData.administrator=this.selectAdminData.nickname,this.appData.userId=this.selectAdminData.userId},selectAdmin:function(t,e){this.selectAdminData=t},brotherGetData:function(t){this.regetData=t},getAdmintrstorData:function(){var t=this;Object(s.f)({groupId:347}).then(function(e){t.adminData=e.tableContent,t.sameAdminData=e.tableContent})}},mounted:function(){var t=this,e={uniqueId:this.$route.params.listId};this.getAdmintrstorData(),Object(s.p)(e).then(function(e){t.appData=e[0],"business"===t.appData.type&&(t.showSubjectView=!0)})}},S={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-details"},[a("div",[a("header",{staticClass:"app-header"},[a("Breadcrumb",[a("BreadcrumbItem",{attrs:{to:"/"}},[t._v("首页")]),t._v(" "),a("BreadcrumbItem",{attrs:{to:"/app/list"}},[t._v("应用列表")]),t._v(" "),a("BreadcrumbItem",[t._v(t._s(t.appData.title))])],1)],1),t._v(" "),a("div",{staticClass:"app-main"},[a("img",{attrs:{src:t.appData.icon}}),t._v(" "),a("div",{staticClass:"app-main-content"},[t.showEditAppInfo?a("h3",[t._v(t._s(t.appData.title))]):a("Input",{staticStyle:{width:"200px"},model:{value:t.appData.title,callback:function(e){t.$set(t.appData,"title",e)},expression:"appData.title"}}),t._v(" "),a("b",{on:{click:t.editAppinfo}},[a("Tooltip",{attrs:{content:"编辑",placement:"top"}},[a("Icon",{staticClass:"app-edit-icon",attrs:{type:"compose"}})],1)],1),t._v(" "),a("section",{staticClass:"app-section"},[a("div",{staticClass:"app-content-section"},[a("label",[t._v("管理员：")]),t._v(" "),t.showEditAppInfo?a("span",[t._v(t._s(t.appData.administrator))]):a("Input",{staticStyle:{width:"100px"},attrs:{icon:"arrow-down-b"},on:{"on-click":t.selectAdminModal},model:{value:t.appData.administrator,callback:function(e){t.$set(t.appData,"administrator",e)},expression:"appData.administrator"}})],1),t._v(" "),a("div",{staticClass:"app-content-section"},[a("label",[t._v("状态：")]),t._v(" "),a("Tag",{attrs:{color:0===t.appData.publish?t.notAppStatusColor:t.hasAppStatusColor}},[t._v(t._s(0===t.appData.publish?t.notPublishStatus:t.hasPublishStatus))])],1),t._v(" "),a("div",{staticClass:"app-content-section"},[a("label",[t._v("创建时间：")]),t._v(" "),a("span",[t._v(t._s(t.appData.crtTime))])])]),t._v(" "),a("section",{staticClass:"app-section"},[t._m(0),t._v(" "),a("div",{staticClass:"app-content-section"},[a("label",[t._v("类型：")]),t._v(" "),a("span",[t._v(t._s(t.appData.transType))])]),t._v(" "),a("div",{staticClass:"app-content-section"},[a("label",[t._v("创建者：")]),t._v(" "),a("span",[t._v(t._s(t.appData.modifer))])])]),t._v(" "),a("section",{staticClass:"app-section"},[a("div",{staticClass:"app-content-comment"},[a("label",[t._v("说明：")]),t._v(" "),t.showEditAppInfo?a("span",[t._v(t._s(t.appData.comment))]):a("Input",{staticStyle:{width:"350px"},model:{value:t.appData.comment,callback:function(e){t.$set(t.appData,"comment",e)},expression:"appData.comment"}})],1)])],1)])]),t._v(" "),a("app-setting",{attrs:{listId:this.$route.params.listId},on:{showPermissionApp:t.showPermissionApp,childHasPublished:t.childHasPublished,getData:t.brotherGetData}}),t._v(" "),a("app-permission",{attrs:{listId:this.$route.params.listId,regetData:t.regetData}}),t._v(" "),a("app-view",{attrs:{listId:this.$route.params.listId,appType:t.appData.type}}),t._v(" "),a("app-subject"),t._v(" "),a("time-line"),t._v(" "),a("Modal",{attrs:{title:"请选择"},on:{"on-ok":t.confirmModal},model:{value:t.showAdminModal,callback:function(e){t.showAdminModal=e},expression:"showAdminModal"}},[a("div",{staticClass:"app-search"},[a("Icon",{staticClass:"app-search-icon",attrs:{type:"search"}}),t._v(" "),a("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"搜索"},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}})],1),t._v(" "),a("Table",{attrs:{"highlight-row":!0,height:"400",stripe:"",columns:t.adminColumns,size:"small",data:t.adminData},on:{"on-row-click":t.selectAdmin}})],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"app-content-section"},[e("label",[this._v("实例数：")]),this._v(" "),e("span",[this._v("2000")])])}]};var M=a("VU/8")(I,S,!1,function(t){a("+5sK")},"data-v-af5cfa46",null);e.default=M.exports},"3PLy":function(t,e){},"HDB/":function(t,e){},Kpdl:function(t,e){},LYOW:function(t,e){},TVzc:function(t,e){},Y1OT:function(t,e){},k7Qp:function(t,e){},mvHQ:function(t,e,a){t.exports={default:a("qkKv"),__esModule:!0}},qkKv:function(t,e,a){var s=a("FeBl"),i=s.JSON||(s.JSON={stringify:JSON.stringify});t.exports=function(t){return i.stringify.apply(i,arguments)}},xsLq:function(t,e){}});
//# sourceMappingURL=3.a08d9f083e1325f0cb93.js.map
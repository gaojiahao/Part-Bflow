webpackJsonp([3],{"+7eS":function(t,e,a){var s=a("3UZo"),i=a("LiZD");a("MEDl")("keys",function(){return function(t){return i(s(t))}})},"3SZ7":function(t,e,a){t.exports={default:a("dKWS"),__esModule:!0}},"8/7c":function(t,e){},"8CFQ":function(t,e){},CRGP:function(t,e){},CbP3:function(t,e){},Hvsq:function(t,e){},LKjo:function(t,e){},M05C:function(t,e){},MEDl:function(t,e,a){var s=a("dwHk"),i=a("hkgF"),n=a("jg1N");t.exports=function(t,e){var a=(i.Object||{})[t]||Object[t],o={};o[t]=e(a),s(s.S+s.F*n(function(){a(1)}),"Object",o)}},"PiI+":function(t,e){},"V+BI":function(t,e){},YIkB:function(t,e){},cfvZ:function(t,e,a){t.exports={default:a("t5rF"),__esModule:!0}},dKWS:function(t,e,a){var s=a("hkgF"),i=s.JSON||(s.JSON={stringify:JSON.stringify});t.exports=function(t){return i.stringify.apply(i,arguments)}},dikT:function(t,e){},gZT7:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("l/Op"),i={name:"LineChart",props:{title:{type:String},legendName:{type:String},xAxisData:{type:Array},seriesData:{type:Array}},data:function(){return{}},methods:{draw:function(t,e){var a=s.init(document.getElementById("lineChart")),i={title:{text:this.title,textStyle:{fontSize:14}},tooltip:{trigger:"axis"},color:["#26bba0"],legend:{selectedMode:!1,data:[{name:this.legendName}]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},toolbox:{feature:{saveAsImage:{}}},xAxis:{type:"category",boundaryGap:!1,data:e},yAxis:{type:"value"},series:[{name:this.legendName,type:"line",smooth:!0,symbolSize:6,itemStyle:{normal:{color:"#26bba0",borderWidth:2}},lineStyle:{color:"#26bba0"},areaStyle:{normal:{color:"#38cdb27d",show:!0,position:"top"}},data:t}]};a.setOption(i)}},watch:{seriesData:function(t){this.draw(t,this.xAxisData)}}},n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"line-container"},[e("header",[this._t("header")],2),this._v(" "),e("div",{staticClass:"rfd-line-chart",attrs:{id:"lineChart"}})])},staticRenderFns:[]};var o=a("D8HT")(i,n,!1,function(t){a("CRGP")},null,null).exports,r=a("GIAq"),l=a("lZCD"),c={name:"ChangeLog",components:{CustomModal:l.a},props:{listId:{type:String}},data:function(){return{visible:!1,logData:[],modalFormData:{scope:[],spendTime:1,content:""},ruleValidate:{scope:[{type:"array",required:!0,message:"不允许为空"}],spendTime:[{required:!0,message:"不允许为空",type:"number"}],content:[{required:!0,message:"不允许为空",trigger:"blur"}]}}},methods:{showAppLog:function(){this.visible=!0},modalVisibleChange:function(t){t||this.$refs.formValidate.resetFields()},submitLog:function(t){var e=this,a=void 0;if(this.$refs.formValidate.validate(function(t){a=t}),a){var s=this.listId,i=this.modalFormData.scope.join(","),n=this.modalFormData.spendTime,o=this.modalFormData.content;Object(r.v)(s,i,n,o).then(function(t){t.success&&(e.$Message.success(t.message),e.visible=!1,e.getChangeLog())})}},getChangeLog:function(){var t=this,e=this.listId;Object(r.q)(e).then(function(e){e.tableContent&&(e.tableContent.map(function(t){t.CHANGE_RANGE&&(t.CHANGE_RANGE=t.CHANGE_RANGE.split(","))}),t.logData=e.tableContent)})}},created:function(){this.getChangeLog()}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"timeline-box",attrs:{fix:""}},[a("div",{staticClass:"timeline-box-header"},[a("span",[t._v("更新日志:")]),t._v(" "),a("a",{on:{click:t.showAppLog}},[t._v("新增")])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:0!==t.logData.length,expression:"logData.length===0?false:true"}],staticClass:"timeline-box-log"},[a("Timeline",{staticClass:"timeline-list",attrs:{pending:""}},t._l(t.logData,function(e,s){return a("TimelineItem",{key:s},[a("p",{staticClass:"time"},[t._v(t._s(e.VERSION))]),t._v(" "),a("ul",{staticClass:"timeline-item-content-ul"},[a("li",[a("span",[t._v(t._s(e.CREATOR_NAME))]),t._v(" "),a("span",[t._v(t._s(e.CRT_TIME))]),t._v(" "),a("span",[t._v("耗用小时数:"+t._s(e.TIME_CONSUMING))])]),t._v(" "),a("li",[a("span",[t._v("更新范围:")]),t._v(" "),t._l(e.CHANGE_RANGE,function(e,s){return a("span",{key:s,staticClass:"customs-tag"},[t._v(t._s(e))])})],2),t._v(" "),a("li",[a("span",[t._v("备注:"+t._s(e.CONTENT))])])])])}))],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:0===t.logData.length,expression:"logData.length===0?true:false"}],staticClass:"show-no-log"},[t._v("\n    暂无日志...\n  ")]),t._v(" "),a("custom-modal",{attrs:{width:"600",footerBtnAlign:"right",title:"更新日志"},on:{onVisibleChange:t.modalVisibleChange,"on-ok":t.submitLog},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("div",{staticStyle:{margin:"20px auto",width:"85%"}},[a("Form",{ref:"formValidate",attrs:{"label-width":95,model:t.modalFormData,rules:t.ruleValidate}},[a("FormItem",{attrs:{label:"更新范围:",prop:"scope"}},[a("Select",{attrs:{multiple:""},model:{value:t.modalFormData.scope,callback:function(e){t.$set(t.modalFormData,"scope",e)},expression:"modalFormData.scope"}},[a("Option",{attrs:{value:"表单"}},[t._v("表单")]),t._v(" "),a("Option",{attrs:{value:"科目关系"}},[t._v("科目关系")]),t._v(" "),a("Option",{attrs:{value:"报表"}},[t._v("报表")]),t._v(" "),a("Option",{attrs:{value:"工作流"}},[t._v("工作流")]),t._v(" "),a("Option",{attrs:{value:"权限"}},[t._v("权限")])],1)],1),t._v(" "),a("FormItem",{attrs:{label:"耗用小时数:",prop:"spendTime"}},[a("InputNumber",{model:{value:t.modalFormData.spendTime,callback:function(e){t.$set(t.modalFormData,"spendTime",e)},expression:"modalFormData.spendTime"}}),t._v(" "),a("span",{staticStyle:{color:"#ddd","margin-left":"10px"}},[t._v("单位/时")])],1),t._v(" "),a("FormItem",{attrs:{label:"更新内容:",prop:"content"}},[a("Input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:6}},model:{value:t.modalFormData.content,callback:function(e){t.$set(t.modalFormData,"content",e)},expression:"modalFormData.content"}})],1)],1)],1)])],1)},staticRenderFns:[]};var u=a("D8HT")(c,d,!1,function(t){a("CbP3")},null,null).exports,p=a("oAV5"),h={name:"LogInstance",components:{LineChart:o,ChangeLog:u},data:function(){return{listId:this.$route.params.listId,month:new Date,xAxisData:[],seriesData:[],active:!0}},watch:{month:function(t){this.getInstanceData()}},methods:{getInstanceData:function(t){var e=this,a=e.listId,s=e.month,i=t||(this.active?"week":"day");s=Object(p.a)(s,"yyyy/MM/dd"),Object(r.r)(a,i,s).then(function(t){if(t.list[0]){var a=[],s=[];t.list.map(function(t){a.push(t.xAxis),s.push(t.num)}),e.seriesData=s,e.xAxisData=a}})},selectDataRange:function(t){this.active="week"===t,this.getInstanceData(t)},callTimeLineRefesh:function(){this.getChangeLog()}},created:function(){this.getInstanceData()}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"line-chart"},[a("line-chart",{attrs:{title:"数据分析",legendName:"新增实例数",xAxisData:t.xAxisData,seriesData:t.seriesData}},[a("div",{staticClass:"line-chart-header",attrs:{slot:"header"},slot:"header"},[t._v("\n        查看范围:\n        "),a("DatePicker",{staticStyle:{width:"150px","margin-left":"10px"},attrs:{type:"month",placeholder:"选择月份",format:"yyyy-MM",clearable:!1},model:{value:t.month,callback:function(e){t.month=e},expression:"month"}}),t._v(" "),a("div",{staticClass:"select-range"},[a("span",{staticClass:"customs-tag",class:{"customs-tag-active":t.active},on:{click:function(e){t.selectDataRange("week")}}},[t._v("周")]),t._v(" "),a("span",{staticClass:"customs-tag",class:{"customs-tag-active":!t.active},on:{click:function(e){t.selectDataRange("day")}}},[t._v("天")])])],1)])],1),t._v(" "),a("change-log",{attrs:{listId:t.listId}})],1)},staticRenderFns:[]};var f=a("D8HT")(h,m,!1,function(t){a("8CFQ")},"data-v-2b13bdbe",null).exports,v={name:"appInfo",components:{},props:{listId:String},data:function(){return{appData:{},showEditAppInfo:!0,selectModel:"",showAdminModal:!1,selector:"",searchValue:"",hasPublishStatus:"已发布",notPublishStatus:"未发布",notAppStatusColor:"blue",hasAppStatusColor:"green",adminColumns:[{title:"工号",key:"userCode"},{title:"姓名",key:"nickname"}],adminData:[],sameAdminData:[],selectAdminData:{}}},watch:{searchValue:function(t){var e=[];t?(this.sameAdminData.forEach(function(a,s){(a.nickname.indexOf(t)>-1||a.userCode.indexOf(t)>-1)&&e.push(a)}),this.adminData=e):this.adminData=this.sameAdminData}},methods:{childHasPublished:function(t){this.appData.publish=1},editAppinfo:function(){var t=this;if(this.showEditAppInfo=!this.showEditAppInfo,this.showEditAppInfo){var e={uniqueId:this.appData.uniqueId,title:this.appData.title,administrator:this.appData.userId,comment:this.appData.comment};Object(r.u)(e).then(function(e){e.success&&t.$Message.success(e.message)})}},selectAdminModal:function(){console.log(this.showAdminModal),this.showAdminModal=!0},confirmModal:function(){this.appData.administrator=this.selectAdminData.nickname,this.appData.userId=this.selectAdminData.userId},selectAdmin:function(t,e){this.selectAdminData=t},getAdmintrstorData:function(){var t=this;Object(r.g)(347).then(function(e){t.adminData=e.tableContent,t.sameAdminData=e.tableContent})}},created:function(){},mounted:function(){var t=this,e=this.listId;this.getAdmintrstorData(),Object(r.s)(e).then(function(e){t.appData=e[0],t.$emit("changeAppType",t.appData.type)})}},g={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("header",{staticClass:"app-header"},[a("Breadcrumb",[a("BreadcrumbItem",{attrs:{to:"/"}},[t._v("首页")]),t._v(" "),a("BreadcrumbItem",{attrs:{to:"/application/list"}},[t._v("应用列表")]),t._v(" "),a("BreadcrumbItem",[t._v(t._s(t.appData.title))])],1)],1),t._v(" "),a("div",{staticClass:"app-main"},[a("div",{staticClass:"app-img"},[a("img",{attrs:{src:t.appData.icon}})]),t._v(" "),a("div",{staticClass:"app-main-content"},[a("h2",[t._v(t._s(t.appData.title+" - 应用详情"))]),t._v(" "),a("div",{staticClass:"app-function"},[a("Dropdown",{attrs:{placement:"bottom-start"}},[a("a",{attrs:{href:"javascript:void(0)"}},[t._v("\n            操作\n            "),a("Icon",{attrs:{type:"arrow-down-b"}})],1),t._v(" "),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",[t._v("启用")]),t._v(" "),a("DropdownItem",[t._v("停用")]),t._v(" "),a("DropdownItem",[t._v("归档")]),t._v(" "),a("DropdownItem",[t._v("删除")])],1)],1)],1),t._v(" "),a("section",{staticClass:"app-section"},[a("div",{staticClass:"app-content-section"},[a("label",[t._v("应用名称：")]),t._v(" "),t.showEditAppInfo?a("span",[t._v(t._s(t.appData.title))]):a("Input",{staticStyle:{width:"200px"},model:{value:t.appData.title,callback:function(e){t.$set(t.appData,"title",e)},expression:"appData.title"}}),t._v(" "),a("b",{on:{click:t.editAppinfo}},[a("Tooltip",{attrs:{content:"编辑",placement:"top"}},[a("Icon",{staticClass:"app-edit-icon",attrs:{type:"compose"}})],1)],1)],1),t._v(" "),a("div",{staticClass:"app-content-section"},[a("label",[t._v("应用类型：")]),t._v(" "),a("span",[t._v(t._s(t.appData.type))])]),t._v(" "),a("div",{staticClass:"app-content-section"},[a("label",[t._v("应用管理员：")]),t._v(" "),t.showEditAppInfo?a("span",[a("Icon",{attrs:{type:"person"}}),t._v(t._s(t.appData.administrator))],1):a("Input",{staticStyle:{width:"100px"},attrs:{icon:"arrow-down-b"},on:{"on-click":t.selectAdminModal},model:{value:t.appData.administrator,callback:function(e){t.$set(t.appData,"administrator",e)},expression:"appData.administrator"}})],1)]),t._v(" "),a("section",{staticClass:"app-section"},[a("div",{staticClass:"app-content-section-create"},[a("label",[t._v("创建者：")]),t._v(" "),a("span",[t._v(t._s(t.appData.modifer))])]),t._v(" "),a("div",{staticClass:"app-content-section-create"},[a("label",[t._v("创建时间：")]),t._v(" "),a("span",[t._v(t._s(t.appData.crtTime))])]),t._v(" "),a("div",{staticClass:"app-content-section-create"},[a("label",[t._v("修改者：")]),t._v(" "),a("span",[t._v(t._s(t.appData.modifer))])]),t._v(" "),a("div",{staticClass:"app-content-section-create"},[a("label",[t._v("修改时间：")]),t._v(" "),a("span",[t._v(t._s(t.appData.crtTime))])])]),t._v(" "),a("section",{staticClass:"app-section"},[a("div",{staticClass:"app-content-comment"},[a("label",[t._v("说明：")]),t._v(" "),t.showEditAppInfo?a("span",[t._v(t._s(t.appData.comment))]):a("Input",{staticStyle:{width:"432px"},model:{value:t.appData.comment,callback:function(e){t.$set(t.appData,"comment",e)},expression:"appData.comment"}})],1)])])]),t._v(" "),a("Modal",{attrs:{title:"请选择"},on:{"on-ok":t.confirmModal},model:{value:t.showAdminModal,callback:function(e){t.showAdminModal=e},expression:"showAdminModal"}},[a("div",{staticClass:"app-search"},[a("Icon",{staticClass:"app-search-icon",attrs:{type:"search"}}),t._v(" "),a("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"搜索"},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}})],1),t._v(" "),a("Table",{attrs:{"highlight-row":!0,height:"400",stripe:"",columns:t.adminColumns,size:"small",data:t.adminData},on:{"on-row-click":t.selectAdmin}})],1)],1)},staticRenderFns:[]};var D=a("D8HT")(v,g,!1,function(t){a("8/7c")},"data-v-53cf71c6",null).exports,b={name:"appSubject",components:{},props:{listId:{type:String}},data:function(){return{columns:[{title:"科目名称",key:"accountName",align:"center"},{title:"科目类型",key:"classify",align:"center",render:function(t,e){return 1===e.row.classify?t("span",{},"会计类"):t("span",{},"非会计类")}},{title:"数据归集",key:"dataCollection",align:"center",render:function(t,e){var a=[],s=e.row;if(s.calcRels.forEach(function(t){a.push(t.matchDirectionByDebit)}),1===s.classify){if(/1/.test(a)&&/-1/.test(a))return t("span",{},"借方，贷方");if(/1/.test(a))return t("span",{},"借方");if(/-1/.test(a))return t("span",{},"贷方")}else{if(/1/.test(a)&&/-1/.test(a))return t("span",{},"增加，减少");if(/1/.test(a))return t("span",{},"增加");if(/-1/.test(a))return t("span",{},"减少")}}}],subjects:[]}},methods:{},created:function(){var t=this;Object(r.n)(this.listId).then(function(e){200===e.status&&(t.subjects=e.data)})}},C={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h3",[this._v("科目关系：")]),this._v(" "),e("Table",{attrs:{columns:this.columns,data:this.subjects}})],1)},staticRenderFns:[]};var _=a("D8HT")(b,C,!1,function(t){a("dikT")},"data-v-6745e0f8",null).exports,w=a("3SZ7"),y=a.n(w),S={name:"canEditTable",props:{refs:String,columnsList:Array,value:Array,url:String,editIncell:{type:Boolean,default:!1},hoverShow:{type:Boolean,default:!1}},data:function(){return{columns:[],thisTableData:[],edittingStore:[]}},created:function(){this.init()},methods:{init:function(){var t,e=this,a=this,s=this.columnsList.filter(function(t){if(t.editable&&!0===t.editable)return t});t=JSON.parse(y()(this.value)).map(function(t,a){var i=!1;if(e.thisTableData[a])if(e.thisTableData[a].editting)i=!0;else for(var n in e.thisTableData[a].edittingCell)!0===e.thisTableData[a].edittingCell[n]&&(i=!0);if(i)return e.thisTableData[a];e.$set(t,"editting",!1);var o={};return s.forEach(function(t){o[t.key]=!1}),e.$set(t,"edittingCell",o),t}),this.thisTableData=t,this.edittingStore=JSON.parse(y()(this.thisTableData)),this.columnsList.forEach(function(t){t.editable&&(t.render=function(s,i){var n=e.thisTableData[i.index];return n.editting?s("Input",{props:{type:"text",value:n[t.key]},on:{"on-change":function(t){var e=i.column.key;a.edittingStore[i.index][e]=t.target.value}}}):e.editIncell?s("Row",{props:{type:"flex",align:"middle",justify:"center"}},[s("Col",{props:{span:"22"}},[n.edittingCell[i.column.key]?function(t,e,a,s){return e("Input",{props:{type:"text",value:t.edittingStore[a.index][s.key]},on:{"on-change":function(e){var i=s.key;t.edittingStore[a.index][i]=e.target.value}}})}(e,s,i,t):s("span",n[t.key])]),s("Col",{props:{span:"2"}},[n.edittingCell[i.column.key]?function(t,e,a){return e("Button",{props:{type:"text",icon:"checkmark"},on:{click:function(e){t.edittingStore[a.index].edittingCell[a.column.key]=!1,t.thisTableData=JSON.parse(y()(t.edittingStore)),t.$emit("input",t.handleBackdata(t.thisTableData)),t.$emit("on-cell-change",t.handleBackdata(t.thisTableData),a.index,a.column.key)}}})}(e,s,i):function(t,e,a){return t.hoverShow?e("div",{class:{"show-edit-btn":t.hoverShow}},[e("Button",{props:{type:"text",icon:"edit"},on:{click:function(e){t.edittingStore[a.index].edittingCell[a.column.key]=!0,t.thisTableData=JSON.parse(y()(t.edittingStore))}}})]):e("Button",{props:{type:"text",icon:"edit"},on:{click:function(e){t.edittingStore[a.index].edittingCell[a.column.key]=!0,t.thisTableData=JSON.parse(y()(t.edittingStore))}}})}(e,s,i)])]):s("span",n[t.key])}),t.handle&&(t.render=function(a,s){var i=e.thisTableData[s.index],n=[];return t.handle.forEach(function(t){"edit"===t?n.push(function(t,e,a,s){return e("Button",{props:{type:a.editting?"success":"primary",loading:a.saving},style:{margin:"0 5px"},on:{click:function(){if(a.editting){t.edittingStore[s].saving=!0,t.thisTableData=JSON.parse(y()(t.edittingStore));var e=t.edittingStore[s];e.editting=!1,e.saving=!1,t.thisTableData=JSON.parse(y()(t.edittingStore)),t.$emit("input",t.handleBackdata(t.thisTableData)),t.$emit("on-change",t.handleBackdata(t.thisTableData),s)}else{if(a.edittingCell)for(var i in a.edittingCell)a.edittingCell[i]=!1,t.edittingStore[s].edittingCell[i]=!1;t.edittingStore[s].editting=!0,t.thisTableData=JSON.parse(y()(t.edittingStore))}}}},a.editting?"保存":"编辑")}(e,a,i,s.index)):"delete"===t&&n.push(function(t,e,a,s){return e("Poptip",{props:{confirm:!0,title:"您确定要删除这条数据吗?",transfer:!0},on:{"on-ok":function(){t.thisTableData.splice(s,1),t.$emit("input",t.handleBackdata(t.thisTableData)),t.$emit("on-delete",t.handleBackdata(t.thisTableData),s)}}},[e("Button",{style:{margin:"0 5px"},props:{type:"error",placement:"top"}},"删除")])}(e,a,0,s.index))}),a("div",n)})})},handleBackdata:function(t){var e=JSON.parse(y()(t));return e.forEach(function(t){delete t.editting,delete t.edittingCell,delete t.saving}),e}},watch:{value:function(t){this.init()}}},k={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("Table",{ref:this.refs,attrs:{columns:this.columnsList,data:this.thisTableData,border:"","disabled-hover":""}})],1)},staticRenderFns:[]};var I=a("D8HT")(S,k,!1,function(t){a("jfSa")},null,null).exports,M={name:"admintrstorAssessment",components:{AssessModal:l.a,EditTable:I},props:{listId:{type:String}},data:function(){var t=this;return{showAssessModal:!1,isEdit:"",IsEditId:"",changeResult:"",adminAssessData:{duringDate:"",result:"",opportunity:""},ruleValidate:{duringDate:[{type:"date",required:!0,message:"不允许为空"}],result:[{required:!0,message:"不允许为空",type:"string"}],opportunity:[{required:!0,message:"不允许为空",type:"string"}]},columns:[{title:"期间（月份）",key:"crtTime",width:150,render:function(e,a){return e("span",{},t.formatDate(a.row.crtTime))}},{title:"效率与成本改进成果",key:"achievement"},{title:"效率与成本改进机会",key:"chance"},{title:"操作",align:"center",key:"handle",render:function(e,a){return e("a",{on:{click:function(){t.showAssessModal=!0,t.$refs.formValidate.resetFields(),t.isEdit="edit",t.IsEditId=a.row.id,t.adminAssessData.duringDate=a.row.crtTime,t.adminAssessData.result=a.row.achievement,t.adminAssessData.opportunity=a.row.chance}}},"编辑")}}],assessments:[]}},methods:{addAssess:function(){this.showAssessModal=!0,this.$refs.formValidate.resetFields()},submitAdminAssess:function(){var t=this,e={listId:this.listId,opportunity:this.adminAssessData.opportunity,result:this.adminAssessData.result,date:this.formatDate(this.adminAssessData.duringDate)};"edit"===this.isEdit&&(e.id=this.IsEditId),this.$refs.formValidate.validate(function(a){a&&Object(r.w)(e).then(function(e){e.success?(t.$Message.success(e.message),t.getAssessmentData(),t.showAssessModal=!1,t.isEdit=""):t.$Message.error(e.message)})})},getAssessmentData:function(){var t=this;Object(r.p)(this.listId).then(function(e){t.assessments=e.tableContent})},formatDate:function(t){var e=new Date(t),a=e.getFullYear(),s=e.getMonth()+1;return s>=1&&s<=9&&(s="0"+s),a+"-"+s}},created:function(){this.getAssessmentData()}},x={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Row",{staticClass:"app-resource-group-title"},[a("h3",[t._v("管理员自评 "),a("a",{on:{click:t.addAssess}},[t._v("添加自评")])])]),t._v(" "),a("Row",{staticClass:"assessment-content"},[a("Table",{attrs:{columns:t.columns,data:t.assessments}})],1),t._v(" "),a("assess-modal",{attrs:{title:"管理员自评",width:"650"},on:{"on-ok":t.submitAdminAssess},model:{value:t.showAssessModal,callback:function(e){t.showAssessModal=e},expression:"showAssessModal"}},[a("div",{staticStyle:{margin:"20px auto",width:"85%"}},[a("Form",{ref:"formValidate",attrs:{"label-width":150,model:t.adminAssessData,rules:t.ruleValidate}},[a("FormItem",{attrs:{label:"期间（月份）:",prop:"duringDate"}},[a("DatePicker",{staticStyle:{width:"200px"},attrs:{format:"yyyy年MM月",type:"month",placeholder:"选择日期"},model:{value:t.adminAssessData.duringDate,callback:function(e){t.$set(t.adminAssessData,"duringDate",e)},expression:"adminAssessData.duringDate"}})],1),t._v(" "),a("FormItem",{attrs:{label:"效率与成本改进成果:",prop:"result"}},[a("Input",{attrs:{type:"textarea"},model:{value:t.adminAssessData.result,callback:function(e){t.$set(t.adminAssessData,"result",e)},expression:"adminAssessData.result"}})],1),t._v(" "),a("FormItem",{attrs:{label:"效率与成本改进机会:",prop:"opportunity"}},[a("Input",{attrs:{type:"textarea"},model:{value:t.adminAssessData.opportunity,callback:function(e){t.$set(t.adminAssessData,"opportunity",e)},expression:"adminAssessData.opportunity"}})],1)],1)],1)])],1)},staticRenderFns:[]};var A=a("D8HT")(M,x,!1,function(t){a("PiI+")},"data-v-09b414d8",null).exports,T=a("cfvZ"),O=a.n(T),P={name:"permissionModal",components:{},props:{modalStatis:Boolean,editActionData:Object,memberType:String,isEdit:String},data:function(){return{appListId:this.$route.params.listId,selectUser:"",selectOrg:"",selectPosition:"",searchUserValue:"",searchOrgValue:"",searchDepValue:"",tableSize:"small",userTotal:0,orgTotal:0,depTotal:0,userCurrentPage:1,orgCurrentPage:1,depCurrentPage:1,pageSize:10,emitChange:0,userLoading:!0,orgLoading:!0,depLoading:!0,showUserModal:!1,showOrgModal:!1,showDepartmentModal:!1,showPermissionModal:!1,isShowMemberSelect:!0,sameUserData:[],userSelectData:[],orgSelectData:[],departmentSelectData:[],userColumns:[],userData:[],orgColumns:[],orgData:[],departmentColumns:[],departmentData:[],allPermissionData:[],permissionSelectDatas:[],allPermissionColumns:[{type:"selection",width:60,align:"center",render:function(t,e){return t("Checkbox",{props:{value:!0}})}},{title:"类型",key:"type"},{title:"资源",key:"name"}],userSelection:[],orgSelection:[],departmentSelection:[]}},watch:{modalStatis:function(t,e){var a=this;this.showPermissionModal=t;var s=[];if(this.editActionData.action&&(s=JSON.parse(this.editActionData.action)),s.forEach(function(t){for(var e in t)a.permissionSelectDatas.push({name:t[e],id:Number(e)})}),console.log(s),"edit"===this.isEdit){var i={listId:this.appListId,filter:y()([{operator:"eq",value:"操作",property:"type"}])};if(Object(r.j)(i).then(function(t){a.allPermissionData=t.tableContent,console.log(a.allPermissionData,a.permissionSelectDatas),a.allPermissionData.map(function(t){a.permissionSelectDatas.map(function(e){e.id===t.id&&(t._checked=!0)})})}),"user"===this.memberType){if(this.orgSelectData=[],this.departmentSelectData=[],this.orgSelection=[],this.departmentSelection=[],O()(this.editActionData).length>0){var n={nickname:this.editActionData.objName,userId:this.editActionData.objId};this.userData.push(n),this.userSelectData.push(n),this.userSelection.push(n)}}else if("group"===this.memberType){if(this.userSelectData=[],this.orgSelectData=[],this.userSelection=[],this.orgSelection=[],O()(this.editActionData).length>0){var o={name:this.editActionData.objName,id:this.editActionData.objId};this.orgData.push(o),this.orgSelectData.push(o),this.orgSelection.push(o)}}else if(this.userSelectData=[],this.departmentSelectData=[],this.userSelection=[],this.departmentSelection=[],O()(this.editActionData).length>0){var l={name:this.editActionData.objName,id:this.editActionData.objId};this.departmentData.push(l),this.departmentSelectData.push(l),this.departmentSelection.push(l)}}else this.getData(),this.userSelectData=[],this.orgSelectData=[],this.departmentSelectData=[],this.userSelection=[],this.orgSelection=[],this.departmentSelection=[]}},methods:{userFilter:function(){var t=y()([{operator:"like",value:this.searchUserValue,property:"nickname"}]);this.selectUserModal(t)},orgFilter:function(){var t=y()([{operator:"like",value:this.searchOrgValue,property:"name"}]);this.selectOrgModal(t)},depFilter:function(){var t=y()([{operator:"like",value:this.searchDepValue,property:"name"}]);this.selectPositionModal(t)},confirmMember:function(){},selectUserModal:function(t){var e=this,a={page:this.userCurrentPage,limit:this.pageSize,filter:t};this.showUserModal=!0,this.userColumns=[{type:"selection",width:60,align:"center"},{title:"姓名",key:"nickname"},{title:"工号",key:"userCode"}],this.userLoading=!0,Object(r.k)(a).then(function(t){e.userData=t.tableContent,e.sameUserData=t.tableContent,e.userTotal=t.dataCount,e.userLoading=!1})},selectOrgModal:function(t){var e=this,a={page:this.orgCurrentPage,limit:this.pageSize,filter:t};this.showOrgModal=!0,this.orgColumns=[{type:"selection",width:60,align:"center"},{title:"名称",key:"name"}],this.orgLoading=!0,Object(r.i)(a).then(function(t){e.orgData=t.tableContent,e.orgTotal=t.dataCount,e.orgLoading=!1})},selectPositionModal:function(t){var e=this,a={page:this.depCurrentPage,limit:this.pageSize,filter:t};this.showDepartmentModal=!0,this.departmentColumns=[{type:"selection",width:60,align:"center"},{title:"名称",key:"name"}],this.depLoading=!0,Object(r.h)(a).then(function(t){e.departmentData=t.tableContent,e.depTotal=t.dataCount,e.depLoading=!1})},selectUserClick:function(t,e){var a=this;this.userSelection.length>0?t.forEach(function(t,e){a.userSelection.push(t)}):this.userSelection=t},selectOrgClick:function(t,e){var a=this;this.orgSelection.length>0?t.forEach(function(t,e){a.orgSelection.push(t)}):this.orgSelection=t},selectDepartmentClick:function(t,e){var a=this;this.departmentSelection.length>0?t.forEach(function(t,e){a.departmentSelection.push(t)}):this.departmentSelection=t},deleteUser:function(t){this.userSelectData.splice(t,1),this.userSelection.splice(t,1)},deleteOrg:function(t){this.orgSelectData.splice(t,1),this.orgSelection.splice(t,1)},deleteDepartment:function(t){this.departmentSelectData.splice(t,1),this.departmentSelection.splice(t,1)},permissionSelectData:function(t,e){this.permissionSelectDatas=t},confirmUser:function(){var t={};this.userSelectData=this.userSelection.reduce(function(e,a){return!t[a.userId]&&(t[a.userId]=e.push(a)),e},[]),this.userSelection=this.userSelectData},confirmOrg:function(){var t={};this.orgSelectData=this.orgSelection.reduce(function(e,a){return!t[a.id]&&(t[a.id]=e.push(a)),e},[]),this.orgSelection=this.orgSelectData},confirmDepartment:function(){var t={};this.departmentSelectData=this.departmentSelection.reduce(function(e,a){return!t[a.id]&&(t[a.id]=e.push(a)),e},[]),this.departmentSelection=this.departmentSelectData},submitPermission:function(){var t=this,e=this.userSelectData.map(function(t){return t.userId}),a=this.orgSelectData.map(function(t){return t.id}),s=this.departmentSelectData.map(function(t){return t.id}),i=this.permissionSelectDatas.map(function(t){return t.id}),n={userId:e.join(","),roleId:s.join(","),groupId:a.join(","),permissionId:i.join(",")};n&&Object(r.b)(n).then(function(e){if(e.success){t.$Message.success(e.message);var a=t.emitChange++;t.$emit("reGetData",a)}})},getData:function(){var t=this,e={listId:this.appListId,filter:y()([{operator:"eq",value:"操作",property:"type"}])};Object(r.j)(e).then(function(e){t.allPermissionData=e.tableContent})},modalVisibleChange:function(t){t||this.$emit("emitPermissionModal",{modal:!1})},onUserPageChange:function(t){var e=y()([{operator:"like",value:this.searchUserValue,property:"nickname"}]);this.userCurrentPage=t,this.selectUserModal(e)},onOrgPageChange:function(t){var e=y()([{operator:"like",value:this.searchOrgValue,property:"name"}]);this.orgCurrentPage=t,this.selectOrgModal(e)},onDepPageChange:function(t){var e=y()([{operator:"like",value:this.searchDepValue,property:"name"}]);this.depCurrentPage=t,this.selectPositionModal(e)}},mounted:function(){this.getData()}},V={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{attrs:{title:"应用权限",width:"1000","mask-closable":!1},on:{"on-ok":t.submitPermission,"on-visible-change":t.modalVisibleChange},model:{value:t.showPermissionModal,callback:function(e){t.showPermissionModal=e},expression:"showPermissionModal"}},[a("div",[a("Row",{staticStyle:{"margin-bottom":"10px"},attrs:{gutter:8}},[a("Col",{attrs:{span:"4"}},[a("Button",{attrs:{type:"info"},on:{click:t.selectUserModal}},[t._v("用户权限选择")])],1),t._v(" "),a("Col",{attrs:{span:"4"}},[a("Button",{attrs:{type:"info"},on:{click:t.selectOrgModal}},[t._v("组织权限选择")])],1),t._v(" "),a("Col",{attrs:{span:"4"}},[a("Button",{attrs:{type:"info"},on:{click:t.selectPositionModal}},[t._v("职位权限选择")])],1)],1),t._v(" "),a("Row",{attrs:{gutter:8}},[a("Col",{staticClass:"permission-tab",attrs:{span:"12"}},[a("Row",{staticStyle:{"margin-top":"10px"}},[a("Col",{attrs:{span:"3"}},[a("b",{staticClass:"permission-title"},[t._v("用户")])]),t._v(" "),a("Col",{staticClass:"member-body",attrs:{span:"21"}},t._l(t.userSelectData,function(e,s){return a("Tag",{key:s,attrs:{type:"border",closable:"",color:"yellow"},on:{"on-close":function(e){t.deleteUser(s)}}},[t._v("\n          "+t._s(e.nickname)+"\n        ")])}))],1),t._v(" "),a("Row",{staticClass:"permission-line"}),t._v(" "),a("Row",[a("Col",{attrs:{span:"3"}},[a("b",{staticClass:"permission-title"},[t._v("组织")])]),t._v(" "),a("Col",{staticClass:"member-body",attrs:{span:"21"}},t._l(t.orgSelectData,function(e,s){return a("Tag",{key:s,attrs:{type:"border",closable:"",color:"green"},on:{"on-close":function(e){t.deleteOrg(s)}}},[t._v("\n          "+t._s(e.name)+"\n        ")])}))],1),t._v(" "),a("Row",{staticClass:"permission-line"}),t._v(" "),a("Row",[a("Col",{attrs:{span:"3"}},[a("b",{staticClass:"permission-title"},[t._v("职位")])]),t._v(" "),a("Col",{staticClass:"member-body",attrs:{span:"21"}},t._l(t.departmentSelectData,function(e,s){return a("Tag",{key:s,attrs:{type:"border",closable:"",color:"blue"},on:{"on-close":function(e){t.deleteDepartment(s)}}},[t._v("\n          "+t._s(e.name)+"\n        ")])}))],1)],1),t._v(" "),a("Col",{attrs:{span:"12"}},[a("Table",{ref:"actionRef",attrs:{stripe:"",height:"350",columns:t.allPermissionColumns,data:t.allPermissionData},on:{"on-select":t.permissionSelectData}})],1)],1),t._v(" "),a("Modal",{attrs:{title:"用户选择","mask-closable":!1,transfer:!1},on:{"on-ok":t.confirmUser},model:{value:t.showUserModal,callback:function(e){t.showUserModal=e},expression:"showUserModal"}},[a("div",{staticClass:"app-search"},[a("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"名称搜索"},model:{value:t.searchUserValue,callback:function(e){t.searchUserValue=e},expression:"searchUserValue"}}),t._v(" "),a("p",{staticClass:"app-search-icon",on:{click:t.userFilter}},[a("Button",{attrs:{type:"primary",size:"small"}},[t._v("查询")])],1)],1),t._v(" "),a("Table",{attrs:{height:"400",stripe:"",size:"small",loading:t.userLoading,columns:t.userColumns,data:t.userData},on:{"on-select":t.selectUserClick,"on-select-all":t.selectUserClick}}),t._v(" "),a("div",{staticClass:"user-page"},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:t.userTotal,current:t.userCurrentPage,"page-size":t.pageSize,size:"small","show-total":""},on:{"on-change":t.onUserPageChange}})],1)])],1),t._v(" "),a("Modal",{attrs:{title:"组织选择","mask-closable":!1,transfer:!1},on:{"on-ok":t.confirmOrg},model:{value:t.showOrgModal,callback:function(e){t.showOrgModal=e},expression:"showOrgModal"}},[a("div",{staticClass:"app-search"},[a("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"搜索"},model:{value:t.searchOrgValue,callback:function(e){t.searchOrgValue=e},expression:"searchOrgValue"}}),t._v(" "),a("p",{staticClass:"app-search-icon",on:{click:t.orgFilter}},[a("Button",{attrs:{type:"primary",size:"small"}},[t._v("查询")])],1)],1),t._v(" "),a("Table",{attrs:{height:"400",stripe:"",size:"small",loading:t.orgLoading,columns:t.orgColumns,data:t.orgData},on:{"on-select":t.selectOrgClick,"on-select-all":t.selectOrgClick}}),t._v(" "),a("div",{staticClass:"user-page"},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:t.orgTotal,current:t.orgCurrentPage,"page-size":t.pageSize,size:"small","show-total":""},on:{"on-change":t.onOrgPageChange}})],1)])],1),t._v(" "),a("Modal",{attrs:{title:"职位选择","mask-closable":!1,transfer:!1},on:{"on-ok":t.confirmDepartment},model:{value:t.showDepartmentModal,callback:function(e){t.showDepartmentModal=e},expression:"showDepartmentModal"}},[a("div",{staticClass:"app-search"},[a("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"搜索"},model:{value:t.searchDepValue,callback:function(e){t.searchDepValue=e},expression:"searchDepValue"}}),t._v(" "),a("p",{staticClass:"app-search-icon",on:{click:t.depFilter}},[a("Button",{attrs:{type:"primary",size:"small"}},[t._v("查询")])],1)],1),t._v(" "),a("Table",{attrs:{height:"400",stripe:"",size:t.tableSize,loading:t.depLoading,columns:t.departmentColumns,data:t.departmentData},on:{"on-select":t.selectDepartmentClick,"on-select-all":t.selectDepartmentClick}}),t._v(" "),a("div",{staticClass:"user-page"},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:t.depTotal,current:t.depCurrentPage,"page-size":t.pageSize,size:"small","show-total":""},on:{"on-change":t.onDepPageChange}})],1)])],1)],1)])},staticRenderFns:[]};var R={name:"permissionSource",components:{ActionModal:a("D8HT")(P,V,!1,function(t){a("V+BI")},null,null).exports},data:function(){var t=this;return{listId:this.$route.params.listId,showActionModal:!1,isEdit:"",editActionData:{},memberType:"",actionData:[],isModalConfirm:1e3,columns:[{title:"已授权用户",key:"objName"},{title:"动作",key:"source",render:function(t,e){var a=e.row.action?JSON.parse(e.row.action):[],s=[];if(a.length>0)return a.forEach(function(e,a){var i=void 0;for(var n in e)i=t("span",{style:{margin:"0px 5px"}},e[n]);s.push(i)}),t("div",s)}},{title:"操作",key:"list",align:"center",render:function(e,a){return e("div",[e("a",{on:{click:function(){t.deleteAllPermission(a,a.row.list)}}},"删除"),e("span",{style:{height:"20px",borderLeft:"1px solid #39f",margin:"0px 5px"}}),e("a",{on:{click:function(){"sys_user_permission"===a.row.list?t.memberType="user":"sys_role_permission"===a.row.list?t.memberType="role":t.memberType="group",t.isEdit="edit",t.editActionData=a.row,t.showActionModal=!0}}},"修改")])}}],userSources:[{user:"张三",source:"新增、查看、删除、修改"},{user:"采购部",source:"新增、查看、删除"}]}},watch:{isModalConfirm:function(){this.getActionData()}},methods:{reGetData:function(t){this.isModalConfirm=t},showModal:function(){this.editActionData={},this.showActionModal=!0,this.isEdit=""},emitPermissionModal:function(){this.showActionModal=!1},getActionData:function(){var t=this;Object(r.m)(this.listId).then(function(e){t.userSources=e.tableContent})},isForbidden:function(t){var e=this,a=void 0;a=0===t.atype?1:0,Object(r.a)(t.id,a).then(function(t){t.success&&(e.$Message.success(t.message),e.getData())})},deleteAllPermission:function(t,e){var a=this,s=this;s.$Modal.confirm({title:"确认",content:"确认删除此用户权限？",onOk:function(){var i,n=[];JSON.parse(t.row.action).forEach(function(t){for(var e in t)n.push(e)}),i={list:e,single:t.row.objId,multi:n.join(",")},Object(r.f)(i).then(function(t){t.success&&(s.$Message.success(t.message),a.getActionData())})}})},getData:function(){var t=this,e={listId:this.listId,filter:y()([{operator:"eq",value:"操作",property:"type"}])};Object(r.j)(e).then(function(e){t.actionData=e.tableContent})}},created:function(){},mounted:function(){this.getActionData(),this.getData()}},E={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app"},[a("Row",{staticClass:"app-action"},[a("Row",{staticClass:"app-resource-group-title"},[a("h3",[t._v("动作")]),t._v(" "),a("i",{staticClass:"app-action-title-add iconfont",on:{click:t.showModal}},[t._v("")])]),t._v(" "),a("div",{staticClass:"app-action-source"},[a("Row",{staticClass:"app-action-source-list"},t._l(t.actionData,function(e,s){return a("Col",{key:s,staticClass:"app-action-source-item",attrs:{span:"6"}},[a("Col",{staticClass:"app-action-source-item-check",attrs:{span:"2"}},[a("Checkbox",{attrs:{value:0===e.atype},on:{"on-change":function(a){t.isForbidden(e)}}})],1),t._v(" "),a("Col",{staticClass:"app-action-source-item-content",attrs:{span:"21"}},[a("h3",[t._v(t._s(e.name))]),t._v(" "),a("div",{staticClass:"app-action-source-item-desc"},[t._v(t._s(e.desc))])])],1)})),t._v(" "),a("Row",[a("Table",{attrs:{columns:t.columns,data:t.userSources}})],1)],1)],1),t._v(" "),a("action-modal",{attrs:{modalStatis:t.showActionModal,isEdit:t.isEdit,memberType:t.memberType,editActionData:t.editActionData},on:{reGetData:t.reGetData,emitPermissionModal:t.emitPermissionModal}})],1)},staticRenderFns:[]};var F=a("D8HT")(R,E,!1,function(t){a("YIkB")},"data-v-1d2246e3",null).exports,$={name:"permissionModal",components:{},props:{modalStatis:{type:Boolean},permissionId:{type:[String,Number]}},data:function(){return{appListId:this.$route.params.listId,selectUser:"",selectOrg:"",selectPosition:"",searchUserValue:"",searchOrgValue:"",searchDepValue:"",tableSize:"small",userTotal:0,orgTotal:0,depTotal:0,userCurrentPage:1,orgCurrentPage:1,depCurrentPage:1,pageSize:10,emitChange:0,userLoading:!0,orgLoading:!0,depLoading:!0,showUserModal:!1,showOrgModal:!1,showDepartmentModal:!1,showPermissionModal:!1,sameUserData:[],userSelectData:[],orgSelectData:[],departmentSelectData:[],userColumns:[],userData:[],orgColumns:[],orgData:[],departmentColumns:[],departmentData:[],userSelection:[],orgSelection:[],departmentSelection:[]}},watch:{modalStatis:function(t,e){this.showPermissionModal=t,this.userSelectData=[],this.orgSelectData=[],this.departmentSelectData=[],this.userSelection=[],this.orgSelection=[],this.departmentSelection=[]}},methods:{userFilter:function(){var t=y()([{operator:"like",value:this.searchUserValue,property:"nickname"}]);this.selectUserModal(t)},orgFilter:function(){var t=y()([{operator:"like",value:this.searchOrgValue,property:"name"}]);this.selectOrgModal(t)},depFilter:function(){var t=y()([{operator:"like",value:this.searchDepValue,property:"name"}]);this.selectPositionModal(t)},confirmMember:function(){},selectUserModal:function(t){var e=this,a={page:this.userCurrentPage,limit:this.pageSize,filter:t};this.showUserModal=!0,this.userColumns=[{type:"selection",width:60,align:"center"},{title:"姓名",key:"nickname"},{title:"工号",key:"userCode"}],this.userLoading=!0,Object(r.k)(a).then(function(t){e.userData=t.tableContent,e.sameUserData=t.tableContent,e.userTotal=t.dataCount,e.userLoading=!1})},selectOrgModal:function(t){var e=this,a={page:this.orgCurrentPage,limit:this.pageSize,filter:t};this.showOrgModal=!0,this.orgColumns=[{type:"selection",width:60,align:"center"},{title:"名称",key:"name"}],this.orgLoading=!0,Object(r.i)(a).then(function(t){e.orgData=t.tableContent,e.orgTotal=t.dataCount,e.orgLoading=!1})},selectPositionModal:function(t){var e=this,a={page:this.depCurrentPage,limit:this.pageSize,filter:t};this.showDepartmentModal=!0,this.departmentColumns=[{type:"selection",width:60,align:"center"},{title:"名称",key:"name"}],this.depLoading=!0,Object(r.h)(a).then(function(t){e.departmentData=t.tableContent,e.depTotal=t.dataCount,e.depLoading=!1})},selectUserClick:function(t,e){var a=this;this.userSelection.length>0?t.forEach(function(t,e){a.userSelection.push(t)}):this.userSelection=t},selectOrgClick:function(t,e){var a=this;this.orgSelection.length>0?t.forEach(function(t,e){a.orgSelection.push(t)}):this.orgSelection=t},selectDepartmentClick:function(t,e){var a=this;this.departmentSelection.length>0?t.forEach(function(t,e){a.departmentSelection.push(t)}):this.departmentSelection=t},deleteUser:function(t){this.userSelectData.splice(t,1)},deleteOrg:function(t){this.orgSelectData.splice(t,1)},deleteDepartment:function(t){this.departmentSelectData.splice(t,1)},confirmUser:function(){var t={};this.userSelectData=this.userSelection.reduce(function(e,a){return!t[a.userId]&&(t[a.userId]=e.push(a)),e},[])},confirmOrg:function(){var t={};this.orgSelectData=this.orgSelection.reduce(function(e,a){return!t[a.id]&&(t[a.id]=e.push(a)),e},[])},confirmDepartment:function(){var t={};this.departmentSelectData=this.departmentSelection.reduce(function(e,a){return!t[a.id]&&(t[a.id]=e.push(a)),e},[])},submitPermission:function(){var t=this,e=this.userSelectData.map(function(t){return t.userId}).join(","),a=this.orgSelectData.map(function(t){return t.id}).join(","),s=this.departmentSelectData.map(function(t){return t.id}).join(",");Object(r.y)(this.permissionId,e,a,s).then(function(e){if(e.success){t.$Message.success(e.message);var a=t.emitChange++;t.$emit("reGetData",a)}else t.$Message.error(e.message)})},modalVisibleChange:function(t){t||this.$emit("emitPermissionModal",{modal:!1})},onUserPageChange:function(t){var e=y()([{operator:"like",value:this.searchUserValue,property:"nickname"}]);this.userCurrentPage=t,this.selectUserModal(e)},onOrgPageChange:function(t){var e=y()([{operator:"like",value:this.searchOrgValue,property:"name"}]);this.orgCurrentPage=t,this.selectOrgModal(e)},onDepPageChange:function(t){var e=y()([{operator:"like",value:this.searchDepValue,property:"name"}]);this.depCurrentPage=t,this.selectPositionModal(e)}}},j={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{attrs:{title:"视图权限",width:"500","mask-closable":!1},on:{"on-ok":t.submitPermission,"on-visible-change":t.modalVisibleChange},model:{value:t.showPermissionModal,callback:function(e){t.showPermissionModal=e},expression:"showPermissionModal"}},[a("div",[a("Row",{staticStyle:{"margin-bottom":"10px"},attrs:{gutter:8}},[a("Col",{attrs:{span:"8"}},[a("Button",{attrs:{type:"info"},on:{click:t.selectUserModal}},[t._v("用户权限选择")])],1),t._v(" "),a("Col",{attrs:{span:"8"}},[a("Button",{attrs:{type:"info"},on:{click:t.selectOrgModal}},[t._v("组织权限选择")])],1),t._v(" "),a("Col",{attrs:{span:"8"}},[a("Button",{attrs:{type:"info"},on:{click:t.selectPositionModal}},[t._v("职位权限选择")])],1)],1),t._v(" "),a("Row",{attrs:{gutter:8}},[a("Col",{staticClass:"permission-tab",attrs:{span:"24"}},[a("Row",{staticStyle:{"margin-top":"10px"}},[a("Col",{attrs:{span:"3"}},[a("b",{staticClass:"permission-title"},[t._v("用户")])]),t._v(" "),a("Col",{staticClass:"member-body",attrs:{span:"21"}},t._l(t.userSelectData,function(e,s){return a("Tag",{key:s,attrs:{type:"border",closable:"",color:"yellow"},on:{"on-close":function(e){t.deleteUser(s)}}},[t._v("\n          "+t._s(e.nickname)+"\n        ")])}))],1),t._v(" "),a("Row",{staticClass:"permission-line"}),t._v(" "),a("Row",[a("Col",{attrs:{span:"3"}},[a("b",{staticClass:"permission-title"},[t._v("组织")])]),t._v(" "),a("Col",{staticClass:"member-body",attrs:{span:"21"}},t._l(t.orgSelectData,function(e,s){return a("Tag",{key:s,attrs:{type:"border",closable:"",color:"green"},on:{"on-close":function(e){t.deleteOrg(s)}}},[t._v("\n          "+t._s(e.name)+"\n        ")])}))],1),t._v(" "),a("Row",{staticClass:"permission-line"}),t._v(" "),a("Row",[a("Col",{attrs:{span:"3"}},[a("b",{staticClass:"permission-title"},[t._v("职位")])]),t._v(" "),a("Col",{staticClass:"member-body",attrs:{span:"21"}},t._l(t.departmentSelectData,function(e,s){return a("Tag",{key:s,attrs:{type:"border",closable:"",color:"blue"},on:{"on-close":function(e){t.deleteDepartment(s)}}},[t._v("\n          "+t._s(e.name)+"\n        ")])}))],1)],1)],1),t._v(" "),a("Modal",{attrs:{title:"用户选择","mask-closable":!1,transfer:!1},on:{"on-ok":t.confirmUser},model:{value:t.showUserModal,callback:function(e){t.showUserModal=e},expression:"showUserModal"}},[a("div",{staticClass:"app-search"},[a("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"名称搜索"},model:{value:t.searchUserValue,callback:function(e){t.searchUserValue=e},expression:"searchUserValue"}}),t._v(" "),a("p",{staticClass:"app-search-icon",on:{click:t.userFilter}},[a("Button",{attrs:{type:"primary",size:"small"}},[t._v("查询")])],1)],1),t._v(" "),a("Table",{attrs:{height:"310",stripe:"",size:"small",loading:t.userLoading,columns:t.userColumns,data:t.userData},on:{"on-select":t.selectUserClick,"on-select-all":t.selectUserClick}}),t._v(" "),a("div",{staticClass:"user-page"},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:t.userTotal,current:t.userCurrentPage,"page-size":t.pageSize,size:"small","show-total":""},on:{"on-change":t.onUserPageChange}})],1)])],1),t._v(" "),a("Modal",{attrs:{title:"组织选择","mask-closable":!1,transfer:!1},on:{"on-ok":t.confirmOrg},model:{value:t.showOrgModal,callback:function(e){t.showOrgModal=e},expression:"showOrgModal"}},[a("div",{staticClass:"app-search"},[a("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"搜索"},model:{value:t.searchOrgValue,callback:function(e){t.searchOrgValue=e},expression:"searchOrgValue"}}),t._v(" "),a("p",{staticClass:"app-search-icon",on:{click:t.orgFilter}},[a("Button",{attrs:{type:"primary",size:"small"}},[t._v("查询")])],1)],1),t._v(" "),a("Table",{attrs:{height:"310",stripe:"",size:"small",loading:t.orgLoading,columns:t.orgColumns,data:t.orgData},on:{"on-select":t.selectOrgClick,"on-select-all":t.selectOrgClick}}),t._v(" "),a("div",{staticClass:"user-page"},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:t.orgTotal,current:t.orgCurrentPage,"page-size":t.pageSize,size:"small","show-total":""},on:{"on-change":t.onOrgPageChange}})],1)])],1),t._v(" "),a("Modal",{attrs:{title:"职位选择","mask-closable":!1,transfer:!1},on:{"on-ok":t.confirmDepartment},model:{value:t.showDepartmentModal,callback:function(e){t.showDepartmentModal=e},expression:"showDepartmentModal"}},[a("div",{staticClass:"app-search"},[a("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"搜索"},model:{value:t.searchDepValue,callback:function(e){t.searchDepValue=e},expression:"searchDepValue"}}),t._v(" "),a("p",{staticClass:"app-search-icon",on:{click:t.depFilter}},[a("Button",{attrs:{type:"primary",size:"small"}},[t._v("查询")])],1)],1),t._v(" "),a("Table",{attrs:{height:"310",stripe:"",size:t.tableSize,loading:t.depLoading,columns:t.departmentColumns,data:t.departmentData},on:{"on-select":t.selectDepartmentClick,"on-select-all":t.selectDepartmentClick}}),t._v(" "),a("div",{staticClass:"user-page"},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:t.depTotal,current:t.depCurrentPage,"page-size":t.pageSize,size:"small","show-total":""},on:{"on-change":t.onDepPageChange}})],1)])],1)],1)])},staticRenderFns:[]};var N={name:"reportSource",components:{ReportModal:a("D8HT")($,j,!1,function(t){a("stRu")},null,null).exports},props:{appType:String},data:function(){var t=this;return{listId:this.$route.params.listId,showReportModal:!1,permissionId:"",columns:[{title:"报表名称",key:"title"},{title:"视图类型",key:"viewType",render:function(t,e){if("normal"===e.row.type)return t("span",{},"列表")}},{title:"权限清单",key:"user"},{title:"默认视图",key:"isDefault",width:100,align:"center",render:function(e,a){var s=!1;return 1===a.row.isDefault&&(s=!0),e("Radio",{props:{value:s},on:{"on-change":function(e){t.onClickDefaultView(a)}}})}},{title:"操作",key:"list",align:"center",render:function(e,a){return e("div",[e("a",{on:{click:function(){t.deleteViews(a,a.index)}}},"删除报表"),e("span",{style:{height:"20px",borderLeft:"1px solid #39f",margin:"0px 5px"}}),e("a",{on:{click:function(){var e="/Site/index.html#appSetting/viewConfig/"+t.listId+"/"+a.row.viewId;window.top.location.href=e}}},"修改报表"),e("span",{style:{height:"20px",borderLeft:"1px solid #39f",margin:"0px 5px"}}),e("a",{on:{click:function(){t.permissionId=a.row.permissionId,t.showReportModal=!0}}},"授权")])}}],reportSources:[]}},methods:{emitPermissionModal:function(){this.showReportModal=!1},goCreateView:function(){window.top.location.href="/Site/index.html#appSetting/"+this.listId+"/"+this.appType+"/viewTypes"},getViewsData:function(){var t=this;Object(r.t)(this.listId).then(function(e){t.reportSources=e.tableContent})},deleteViews:function(t,e){var a=this;if(1===this.reportSources.length)this.$Message.warning("不可删除唯一视图！");else if(1===t.row.isDefault){var s={viewId:t.row.viewId,listId:this.listId};this.$Modal.confirm({title:"确认",content:"确认删除此视图？",onOk:function(){Object(r.e)(s).then(function(t){if(t.success){a.reportSources.splice(e,1);var s={viewId:a.reportSources[0].viewId,listId:a.listId};Object(r.x)(s).then(function(t){t.success&&a.reloadViewData()})}})}})}else{var i={viewId:t.row.viewId,listId:this.listId};this.$Modal.confirm({title:"确认",content:"确认设置此视图为默认视图？",onOk:function(){Object(r.e)(i).then(function(t){t.success&&(a.reportSources.splice(e,1),a.$Message.success(t.message))})}})}},reloadViewData:function(){var t=this,e={filter:y()([{operator:"eq",value:this.listId,property:"uniqueId"},{operator:"eq",value:1,property:"listViewStatus"}])};getAppviews(e).then(function(e){t.reportSources=e.tableContent,t.reRenderDefaultView()})},onClickDefaultView:function(t){var e=this;this.$Modal.confirm({title:"确认",content:"确认设置此视图为默认视图？",onOk:function(){e.setDefaultViews(t)},onCancel:function(){e.reRenderDefaultView()}})},setDefaultViews:function(t){var e=this,a={viewId:t.row.viewId,listId:this.listId};Object(r.x)(a).then(function(t){t.success&&(e.$Message.success(t.message),e.reloadViewData())})},reRenderDefaultView:function(){var t=this;this.columns[3].render=function(e,a){var s=!1;return 1===a.row.isDefault&&(s=!0),e("Radio",{props:{value:s},on:{"on-change":function(){t.onClickDefaultView(a)}}})}}},created:function(){},mounted:function(){this.getViewsData()}},U={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-report"},[a("Row",{staticClass:"app-report-title"},[a("h3",[t._v("报表")]),t._v(" "),a("Poptip",{attrs:{trigger:"hover",content:"添加动作"}},[a("i",{staticClass:"app-report-title-add iconfont",on:{click:t.goCreateView}},[t._v("")])])],1),t._v(" "),a("Row",{staticClass:"app-report-table"},[a("Table",{attrs:{columns:t.columns,data:t.reportSources}})],1),t._v(" "),a("report-modal",{attrs:{modalStatis:t.showReportModal,permissionId:t.permissionId},on:{emitPermissionModal:t.emitPermissionModal}})],1)},staticRenderFns:[]};var L=a("D8HT")(N,U,!1,function(t){a("l7BF")},"data-v-d97faa7a",null).exports,B={name:"formSource",components:{},data:function(){return{listId:this.$route.params.listId}},methods:{setForm:function(){window.open("/Form/index.html?viewDesign=true&list="+this.listId)}},created:function(){},mounted:function(){}},z={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"app-form"},[e("Row",{staticClass:"app-resource-group-title"},[e("h3",[this._v("表单")]),this._v(" "),e("i",{staticClass:"app-form-title-add iconfont",on:{click:this.setForm}},[this._v("")])])],1)},staticRenderFns:[]};var H=a("D8HT")(B,z,!1,function(t){a("Hvsq")},"data-v-325fb7c8",null).exports,q={name:"workflowSource",components:{},props:{listId:String},data:function(){return{columns:[{title:"工作流名称",key:"workflowName"},{title:"触发动作",key:"action"},{title:"操作",key:"list",align:"center",render:function(t,e){return t("div",[t("a",{},"删除工作流"),t("span",{style:{height:"20px",borderLeft:"1px solid #39f",margin:"0px 5px"}}),t("a",{},"修改工作流")])}}],workflows:[{workflowName:"创建订单",action:"新建实例"},{workflowName:"修改订单",action:"修改实例"}]}},methods:{createWorkflow:function(){window.open("/myflow/createWorkFlow.html?listId="+this.listId)}},created:function(){},mounted:function(){}},G={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"app-workflow"},[e("Row",{staticClass:"app-resource-group-title"},[e("h3",[this._v("工作流")]),this._v(" "),e("i",{staticClass:"app-workflow-title-add iconfont",on:{click:this.createWorkflow}},[this._v("")])]),this._v(" "),e("Row",{staticClass:"app-workflow-table"},[e("Table",{attrs:{columns:this.columns,data:this.workflows}})],1)],1)},staticRenderFns:[]};var J={name:"permissionSource",components:{ActionManage:F,ReportView:L,AppForm:H,WorkFlow:a("D8HT")(q,G,!1,function(t){a("lZNO")},"data-v-6de04088",null).exports},props:{listId:String,appType:String},data:function(){return{}}},Z={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"app-permission"},[e("action-manage"),this._v(" "),e("report-view",{attrs:{appType:this.appType}}),this._v(" "),e("app-form"),this._v(" "),e("work-flow")],1)},staticRenderFns:[]};var W={name:"detail",components:{AppSubject:_,AdmintrstorAssessment:A,PermissionSource:a("D8HT")(J,Z,!1,function(t){a("iVBc")},null,null).exports,AppInfo:D,LogInstance:f},data:function(){return{appType:""}},methods:{changeAppType:function(t){this.appType=t}}},K={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"app-details"},[e("app-info",{attrs:{listId:this.$route.params.listId},on:{changeAppType:this.changeAppType}}),this._v(" "),e("div",{staticClass:"rfd-tab"},[e("Tabs",{attrs:{value:"name1",type:"card"}},[e("TabPane",{attrs:{label:"一般",name:"name1"}},[e("log-instance")],1),this._v(" "),e("TabPane",{attrs:{label:"互动",name:"name2"}},[e("admintrstor-assessment",{attrs:{listId:this.$route.params.listId}})],1),this._v(" "),e("TabPane",{attrs:{label:"资源",name:"name3"}},[e("permission-source",{attrs:{appType:this.appType}})],1),this._v(" "),e("TabPane",{attrs:{label:"连接",name:"name4"}},[e("div",{staticClass:"app-sub"},[e("app-subject",{attrs:{listId:this.$route.params.listId}})],1)])],1)],1)],1)},staticRenderFns:[]};var Y=a("D8HT")(W,K,!1,function(t){a("LKjo")},"data-v-df6deda6",null);e.default=Y.exports},iVBc:function(t,e){},jfSa:function(t,e){},l7BF:function(t,e){},lZCD:function(t,e,a){"use strict";var s=a("Edqs"),i=a.n(s);function n(t){return void 0===t&&(t=document.body),!0===t?document.body:t instanceof window.Node?t:document.querySelector(t)}var o={directives:{TransferDom:{inserted:function(t,e,a){var s=e.value;if("true"!==t.dataset.transfer)return!1;t.className=t.className?t.className+" v-transfer-dom":"v-transfer-dom";var i=t.parentNode;if(i){var o=document.createComment(""),r=!1;!1!==s&&(i.replaceChild(o,t),n(s).appendChild(t),r=!0),t.__transferDomData||(t.__transferDomData={parentNode:i,home:o,target:n(s),hasMovedOut:r})}},componentUpdated:function(t,e){var a=e.value;if("true"!==t.dataset.transfer)return!1;var s=t.__transferDomData;if(s){var o=s.parentNode,r=s.home,l=s.hasMovedOut;!l&&a?(o.replaceChild(r,t),n(a).appendChild(t),t.__transferDomData=i()({},t.__transferDomData,{hasMovedOut:!0,target:n(a)})):l&&!1===a?(o.replaceChild(t,r),t.__transferDomData=i()({},t.__transferDomData,{hasMovedOut:!1,target:n(a)})):a&&n(a).appendChild(t)}},unbind:function(t){if("true"!==t.dataset.transfer)return!1;t.className=t.className.replace("v-transfer-dom",""),t.__transferDomData&&(!0===t.__transferDomData.hasMovedOut&&t.__transferDomData.parentNode&&t.__transferDomData.parentNode.appendChild(t),t.__transferDomData=null)}}},props:{value:{type:Boolean,default:!1},width:{type:[Number,String],default:520},styles:{type:Object},maskClosable:{type:Boolean,default:!0},footerBtnAlign:{type:String,default:"right"},title:{type:String},transfer:{type:Boolean,default:!0}},data:function(){return{visible:this.value}},computed:{mainStyles:function(){var t={},e=parseInt(this.width),a={width:e<=100?e+"%":e+"px"},s=this.styles?this.styles:{};return i()(t,a,s),t},inputAlign:function(){return"input-align-"+this.footerBtnAlign}},methods:{close:function(){this.visible=!1,this.$emit("on-cancel"),this.$emit("input",!1)},mask:function(){this.maskClosable&&this.close()},handleWrapClick:function(t){var e=t.target.getAttribute("class");e&&e.indexOf("rfd-modal-warp")>-1&&this.mask()},cancel:function(){this.close()},ok:function(){this.$emit("on-ok")}},watch:{value:function(t){this.visible=t},visible:function(t){this.$emit("onVisibleChange",t)}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"transfer-dom",rawName:"v-transfer-dom"}],attrs:{"data-transfer":t.transfer}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"rfd-modal-mask",on:{click:t.mask}}),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"rfd-modal-warp",on:{click:t.handleWrapClick}},[a("div",{staticClass:"rfd-modal",style:t.mainStyles},[a("div",{staticClass:"rfd-modal-content"},[a("header",[a("div",{staticClass:"modal-content-header"},[t._t("header",[a("span",{staticClass:"modal-content-header-title"},[t._v(t._s(t.title))]),t._v(" "),a("i",{staticClass:"iconfont modal-content-header-close",on:{click:t.close}},[t._v("")])])],2)]),t._v(" "),a("main",[a("div",{staticClass:"modal-content-body"},[t._t("default")],2)]),t._v(" "),a("footer",{staticClass:"modal-content-footer",class:t.inputAlign},[t._t("footer",[a("input",{staticClass:"input-submit-common",attrs:{type:"submit",value:"取消"},on:{click:function(e){return e.preventDefault(),t.cancel(e)}}}),t._v(" "),a("input",{staticClass:"input-submit-common",attrs:{type:"submit",value:"确定"},on:{click:function(e){return e.preventDefault(),t.ok(e)}}})])],2)])])])])},staticRenderFns:[]};var l=a("D8HT")(o,r,!1,function(t){a("M05C")},"data-v-347e0302",null);e.a=l.exports},lZNO:function(t,e){},stRu:function(t,e){},t5rF:function(t,e,a){a("+7eS"),t.exports=a("hkgF").Object.keys}});
//# sourceMappingURL=3.068cac3f34b7b9654ebf.js.map
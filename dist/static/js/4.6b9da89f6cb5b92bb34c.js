webpackJsonp([4],{A1BP:function(t,e){t.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"menu-section-list-item-container"},["subject"===e.menu.type?n("Badge",{staticClass:"task-badge",attrs:{count:e.taskCount,type:"primary"}}):e._e(),e._v(" "),n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.menu.icon,expression:"menu.icon"}],staticClass:"menu-section-list-item-icon",class:{"obj-icon":"obj"==e.menu.type||"hr"==e.menu.type,"subject-icon":"subject"==e.menu.type},attrs:{onerror:'this.lazy="resources/images/icon/img-loading-error.png"'}}),e._v(" "),n("div",{staticClass:"menu-section-list-item-info"},[n("div",{staticClass:"menu-section-list-item-info-base"},[n("Tooltip",{attrs:{content:e.menu.text,placement:"top-start"}},[n("div",{staticClass:"menu-section-list-item-info-base-name",on:{click:function(t){e.redirectTo(e.menu)}}},[e._v(e._s(e.menu.text)+" \n                    ")])]),e._v(" "),"system"!==e.menu.type?n("a",{staticClass:"menu-section-list-item-info-base-detail",on:{click:function(t){return t.stopPropagation(),e.handlerViewDetail(t)}}},[e._v("详情\n                ")]):e._e()],1),e._v(" "),n("div",{staticClass:"menu-section-list-item-info-other"},[n("div",{staticClass:"menu-section-list-item-info-other-transtype"},[e._v(e._s(e.menu.transName))]),e._v(" "),n("my-pop-tip",{attrs:{userInfo:e.userInfo,trigger:"click"}},[n("a",{staticClass:"menu-section-list-item-info-other-user",attrs:{slot:"userCard"},on:{click:e.handlerShowUserInfo},slot:"userCard"},[e._v(" \n                    "+e._s(e.menu.administrator)+"\n                    ")])]),e._v(" "),"obj"!==e.menu.type&&"business"!==e.menu.type||!e.menu.action.add?e._e():n("Icon",{staticClass:"menu-section-list-item-info-other-addbutton",attrs:{type:"ios-add-circle-outline"},on:{click:e.handlerToAddingPage}})],1)])],1)},staticRenderFns:[]}},AogY:function(t,e){},"HB+p":function(t,e){t.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home-wrap"},[e.spinShow?n("Spin",{attrs:{size:"large",fix:""}}):e._e(),e._v(" "),n("div",{staticClass:"home-wrap-container"},e._l(e.menuTree,function(t){return n("menu-section",{key:t.id,attrs:{section:t,allTaskCount:e.allTaskCount}})}),1)],1)},staticRenderFns:[]}},aJBQ:function(t,e){},f2bX:function(t,e){},iIfN:function(t,e){t.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"menu-section"},[e.section.leaf?e._e():n("div",[n("div",{staticClass:"menu-section-title"},[e._v(e._s(e.section.text))]),e._v(" "),n("div",{staticClass:"menu-section-list"},e._l(e.section.children,function(t){return n("div",{key:t.id,class:[t.leaf?"menu-section-list-item":"menu-section"]},[t.leaf?n("menu-item",{attrs:{menu:t,allTaskCount:e.allTaskCount}}):e._e(),e._v(" "),t.leaf?e._e():n("menu-section",{attrs:{section:t,allTaskCount:e.allTaskCount}})],1)}),0)])])},staticRenderFns:[]}},zKIK:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("K4CD"),a=n("Gu7T"),o=n.n(a),s=n("3ovf"),c=n("GIAq"),r={name:"MenuItem",components:{MyPopTip:s.a},data:function(){return{userInfo:{},taskCount:0,onPageSelection:[],batchComment:"",columns:[{type:"selection",width:60,align:"center",key:"unableEdit"},{title:"交易号",key:"transCode",sortable:!0,width:160,align:"center",render:function(t,e){return t("a",{attrs:{href:"/Form/index.html?data="+e.row.transCode,target:"_blank"}},e.row.transCode)}},{title:"当前节点",key:"nodeName"},{title:"当前用户",key:"assigneeName",width:90},{title:"创建者",key:"creatorName",sortable:!0},{title:"任务创建时间",key:"crtTime",width:160,align:"center",sortable:!0,render:function(t,e){return t("span",function(t){var e=new Date(t),n=e.getFullYear(),i=e.getMonth()+1;i=i<10?"0"+i:i;var a=e.getDate();a=a<10?"0"+a:a;var o=e.getHours();o=o<10?"0"+o:o;var s=e.getMinutes(),c=e.getSeconds();return n+"-"+i+"-"+a+" "+o+":"+(s=s<10?"0"+s:s)+":"+(c=c<10?"0"+c:c)}(e.row.crtTime))}}],columnData:[],loading:!1,pageTotal:0,pageSize:10,currentPage:1}},props:{menu:{type:Object,default:function(){return{}}},allTaskCount:{type:Object,default:function(){return{}}}},watch:{allTaskCount:{handler:function(t,e){this.taskCount=t[this.menu.listId]},deep:!0}},methods:{handlerViewDetail:function(){this.menu.listId&&window.top.postMessage({type:"redirect",url:"appSetting/"+this.menu.listId},"*")},handlerToAddingPage:function(){var e=this,n="";Object(i.e)(this.menu.listId).then(function(t){0<t.length?(n=t.filter(function(t){return"submit"===t.viewType})[0].uniqueId,window.open("/Form/index.html?model=new&view="+n+"&list="+e.menu.listId)):e.$Message.info("抱歉,当前点击的应用,表单模板为空,请联系企业管理员!")})},handlerShowUserInfo:function(){var e=this;Object(c.Z)(this.menu.adminId).then(function(t){t.dataCount&&(e.userInfo=t.tableContent[0])})},redirectTo:function(t){var e=t.url,n=window.top.document.getElementById("frame1").getAttribute("nr");"_blank"===t.target?window.open(e,"_blank"):(n||(e=~e.indexOf("outlink")?e:~t.url.indexOf("app")?"appReport/"+e:"report/"+e),window.top.postMessage({type:"redirect",url:e},"*"))},popperShow:function(t){var e=this,n={type:"myToDo",page:this.currentPage,listId:this.menu.listId,limit:this.pageSize};this.onPageSelection=[],this.loading=!0,Object(i.b)(n).then(function(t){e.pageTotal=t.total,0<t.tableContent.length&&(e.columnData=t.tableContent,e.columnData.forEach(function(t){t.unableEdit||(t._disabled=!0)}),e.loading=!1)})},onSelectAll:function(t){var e,n={};(e=this.onPageSelection).push.apply(e,o()(t)),this.onPageSelection=this.onPageSelection.reduce(function(t,e){return!n[e.taskId]&&(n[e.taskId]=t.push(e)),t},[])},handerSelectionChange:function(t){if(0===t.length){var e=this.$refs.selection.data,n=this.onPageSelection;e.map(function(e){n=n.filter(function(t){return t.taskId!==e.taskId})}),this.onPageSelection=n}else{var i,a={};(i=this.onPageSelection).push.apply(i,o()(t)),this.onPageSelection=this.onPageSelection.reduce(function(t,e){return!a[e.taskId]&&(a[e.taskId]=t.push(e)),t},[])}},onSelectCancel:function(t,e){this.onPageSelection=this.onPageSelection.filter(function(t){return t.taskId!==e.taskId})},changeCurrentPage:function(t){var n=this,e={type:"myToDo",page:t,listId:this.menu.listId,limit:this.pageSize};this.loading=!0,Object(i.b)(e).then(function(t){0<t.tableContent.length&&(n.columnData=t.tableContent,n.columnData.forEach(function(e){0<n.onPageSelection.length&&n.onPageSelection.forEach(function(t){t.taskId===e.taskId&&(e._checked=!0)}),e.unableEdit||(e._disabled=!0)}),n.loading=!1)})},handleBatchApproval:function(){var n=this;this.batchComment="",this.$Modal.confirm({title:"审批",content:"<p>审批意见</p>",closable:!0,okText:"同意",cancelText:"不同意",transfer:!0,render:function(t){return t("div",[t("label","审批意见: "),t("Input",{props:{value:n.batchComment,autofocus:!0},style:{width:"75%",marginLeft:"10px"},on:{input:function(t){n.batchComment=t}}})])},onOk:function(){var t=n.onPageSelection,e=[];t.forEach(function(t){e.push({taskId:t.taskId,transCode:t.transCode,result:1,comment:n.batchComment})}),Object(i.a)(e).then(function(t){n.onPageSelection=[],t.success?n.$Notice.success({title:"提示",desc:t.message}):n.$Notice.error({title:"提示",desc:t.message})})},onCancel:function(){var t=n.onPageSelection,e=[];t.forEach(function(t){e.push({taskId:t.taskId,transCode:t.transCode,result:0,comment:n.batchComment})}),Object(i.a)(e).then(function(t){n.onPageSelection=[],t.success?n.$Notice.success({title:"提示",desc:t.message}):n.$Notice.error({title:"提示",desc:t.message})})}})}},mounted:function(){this.taskCount=this.allTaskCount[this.menu.listId]}},u=n("A1BP"),l=n.n(u);var d=function(t){n("aJBQ")},m={name:"MenuSection",components:{MenuSection:g,MenuItem:n("VU/8")(r,l.a,!1,d,"data-v-ad67ea7e",null).exports},props:{section:{type:Object,default:function(){return{}}},allTaskCount:{type:Object,default:function(){return{}}}}},h=n("iIfN"),f=n.n(h);var p=function(t){n("AogY")},g=n("VU/8")(m,f.a,!1,p,"data-v-46cbf6e8",null).exports,v={name:"Home",components:{MenuSection:g},data:function(){return{menuTree:[],allTaskCount:{},spinShow:!0}},methods:{handlerSubscribeMsg:function(){var e=this,t=this.$deepstream;t.event&&t.event.subscribe("taskChange/"+this.$currentUser.userId,function(t){t.tableContent.map(function(t){e.$set(e.allTaskCount,t.listId,t.total)})})}},created:function(){this.$nextTick(function(t){var e=this,n=window.sessionStorage.getItem("roletask.com.r2.cache");this.spinShow=!0,n?(n=n?JSON.parse(n):{},this.menuTree=n["/ds/getMenu"],this.spinShow=!1):Object(i.h)().then(function(t){e.spinShow=!1,e.menuTree=t||[]})})},mounted:function(){var e=this;this.handlerSubscribeMsg(),Object(i.c)().then(function(t){t.tableContent.map(function(t){e.allTaskCount[t.listId]=t.total})})}},b=n("HB+p"),C=n.n(b);var k=function(t){n("f2bX")},I=n("VU/8")(v,C.a,!1,k,"data-v-f0467800",null);e.default=I.exports}});
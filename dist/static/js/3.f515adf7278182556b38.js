webpackJsonp([3],{"0rwx":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("GIAq"),o={name:"permissionModal",components:{},props:{appListId:String,modalPermissionStatus:Boolean},data:function(){return{selectUser:"",selectOrg:"",selectPosition:"",searchValue:"",showUserModal:!1,showOrgModal:!1,showDepartmentModal:!1,showPermissionModal:!1,sameUserData:[],userSelectData:[],orgSelectData:[],departmentSelectData:[],userColumns:[],userData:[],orgColumns:[],orgData:[],departmentColumns:[],departmentData:[],allPermissionData:[],permissionSelectDatas:[],allPermissionColumns:[{type:"selection",width:60,align:"center"},{title:"类型",key:"type"},{title:"资源",key:"name"}],userSelection:[],orgSelection:[],departmentSelection:[]}},watch:{modalPermissionStatus:function(t,e){this.showPermissionModal=t},searchValue:function(t){var e=[];t?(this.sameUserData.forEach(function(a,s){(a.nickname.indexOf(t)>-1||a.userCode.indexOf(t)>-1)&&e.push(a)}),this.userData=e):this.userData=this.sameUserData}},methods:{confirmMember:function(){},selectUserModal:function(){var t=this;this.showUserModal=!0,this.userColumns=[{type:"selection",width:60,align:"center"},{title:"姓名",key:"nickname"},{title:"工号",key:"userCode"}],Object(s.j)().then(function(e){t.userData=e.tableContent,t.sameUserData=e.tableContent})},selectOrgModal:function(){var t=this;this.showOrgModal=!0,this.orgColumns=[{type:"selection",width:60,align:"center"},{title:"名称",key:"name"}],Object(s.g)().then(function(e){t.orgData=e.tableContent})},selectPositionModal:function(){var t=this;this.showDepartmentModal=!0,this.departmentColumns=[{type:"selection",width:60,align:"center"},{title:"名称",key:"name"}],Object(s.f)().then(function(e){t.departmentData=e.tableContent})},selectUserClick:function(t,e){var a=this;this.userSelection.length>0?t.forEach(function(t,e){a.userSelection.push(t)}):this.userSelection=t},selectOrgClick:function(t,e){var a=this;this.orgSelection.length>0?t.forEach(function(t,e){a.orgSelection.push(t)}):this.orgSelection=t},selectDepartmentClick:function(t,e){var a=this;this.departmentSelection.length>0?t.forEach(function(t,e){a.departmentSelection.push(t)}):this.departmentSelection=t},deleteUser:function(t){this.userSelectData.splice(t,1)},deleteOrg:function(t){this.orgSelectData.splice(t,1)},deleteDepartment:function(t){this.departmentSelectData.splice(t,1)},permissionSelectData:function(t,e){this.permissionSelectDatas=t},confirmUser:function(){var t={};this.userSelectData=this.userSelection.reduce(function(e,a){return!t[a.userId]&&(t[a.userId]=e.push(a)),e},[])},confirmOrg:function(){var t={};this.orgSelectData=this.orgSelection.reduce(function(e,a){return!t[a.id]&&(t[a.id]=e.push(a)),e},[])},confirmDepartment:function(){var t={};this.departmentSelectData=this.departmentSelection.reduce(function(e,a){return!t[a.id]&&(t[a.id]=e.push(a)),e},[])},submitPermission:function(){var t=this,e=this.userSelectData.map(function(t){return t.userId}),a=this.orgSelectData.map(function(t){return t.id}),o=this.departmentSelectData.map(function(t){return t.id}),n=this.permissionSelectDatas.map(function(t){return t.id}),i={userId:e.join(","),roleId:o.join(","),groupId:a.join(","),permissionId:n.join(",")};i&&Object(s.a)(i).then(function(e){e.success&&t.$Message.success(e.message)})},modalVisibleChange:function(t){t||this.$emit("emitPermissionModal",{modal:!1})}},mounted:function(){var t=this,e={listId:this.appListId};Object(s.h)(e).then(function(e){t.allPermissionData=e.tableContent})}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{attrs:{title:"应用权限",width:"1000","mask-closable":!1},on:{"on-ok":t.submitPermission,"on-visible-change":t.modalVisibleChange},model:{value:t.showPermissionModal,callback:function(e){t.showPermissionModal=e},expression:"showPermissionModal"}},[a("div",[a("Row",{staticStyle:{"margin-bottom":"15px"},attrs:{gutter:8}},[a("Col",{attrs:{span:"8"}},[a("label",[t._v("用户")]),t._v(" "),a("Input",{staticStyle:{width:"200px"},attrs:{icon:"arrow-down-b"},on:{"on-click":t.selectUserModal},model:{value:t.selectUser,callback:function(e){t.selectUser=e},expression:"selectUser"}})],1),t._v(" "),a("Col",{attrs:{span:"8"}},[a("label",[t._v("组织")]),t._v(" "),a("Input",{staticStyle:{width:"200px"},attrs:{icon:"arrow-down-b"},on:{"on-click":t.selectOrgModal},model:{value:t.selectOrg,callback:function(e){t.selectOrg=e},expression:"selectOrg"}})],1),t._v(" "),a("Col",{attrs:{span:"8"}},[a("label",[t._v("职位")]),t._v(" "),a("Input",{staticStyle:{width:"200px"},attrs:{icon:"arrow-down-b"},on:{"on-click":t.selectPositionModal},model:{value:t.selectPosition,callback:function(e){t.selectPosition=e},expression:"selectPosition"}})],1)],1),t._v(" "),a("Row",{attrs:{gutter:8}},[a("Col",{staticClass:"permission-tab",attrs:{span:"12"}},[a("Row",{staticClass:"permission-top-line"}),t._v(" "),a("Row",[a("Col",{attrs:{span:"3"}},[a("b",{staticClass:"permission-title"},[t._v("用户")])]),t._v(" "),a("Col",{staticStyle:{height:"100px"},attrs:{span:"21"}},t._l(t.userSelectData,function(e,s){return a("Tag",{key:s,attrs:{type:"border",closable:"",color:"yellow"},on:{"on-close":function(e){t.deleteUser(s)}}},[t._v(t._s(e.nickname))])}))],1),t._v(" "),a("Row",{staticClass:"permission-line"}),t._v(" "),a("Row",[a("Col",{attrs:{span:"3"}},[a("b",{staticClass:"permission-title"},[t._v("组织")])]),t._v(" "),a("Col",{staticStyle:{height:"100px"},attrs:{span:"21"}},t._l(t.orgSelectData,function(e,s){return a("Tag",{key:s,attrs:{type:"border",closable:"",color:"green"},on:{"on-close":function(e){t.deleteOrg(s)}}},[t._v(t._s(e.name))])}))],1),t._v(" "),a("Row",{staticClass:"permission-line"}),t._v(" "),a("Row",[a("Col",{attrs:{span:"3"}},[a("b",{staticClass:"permission-title"},[t._v("职位")])]),t._v(" "),a("Col",{staticStyle:{height:"100px"},attrs:{span:"21"}},t._l(t.departmentSelectData,function(e,s){return a("Tag",{key:s,attrs:{type:"border",closable:"",color:"blue"},on:{"on-close":function(e){t.deleteDepartment(s)}}},[t._v(t._s(e.name))])}))],1)],1),t._v(" "),a("Col",{attrs:{span:"12"}},[a("Table",{attrs:{stripe:"",height:"350",columns:t.allPermissionColumns,data:t.allPermissionData},on:{"on-select":t.permissionSelectData}})],1)],1),t._v(" "),a("Modal",{attrs:{title:"用户选择","mask-closable":!1,transfer:!1},on:{"on-ok":t.confirmUser},model:{value:t.showUserModal,callback:function(e){t.showUserModal=e},expression:"showUserModal"}},[a("div",{staticClass:"app-search"},[a("Icon",{staticClass:"app-search-icon",attrs:{type:"search"}}),t._v(" "),a("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"搜索"},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}})],1),t._v(" "),a("Table",{attrs:{height:"400",stripe:"",size:"small",columns:t.userColumns,data:t.userData},on:{"on-select":t.selectUserClick}})],1),t._v(" "),a("Modal",{attrs:{title:"组织选择","mask-closable":!1,transfer:!1},on:{"on-ok":t.confirmOrg},model:{value:t.showOrgModal,callback:function(e){t.showOrgModal=e},expression:"showOrgModal"}},[a("Table",{attrs:{height:"400",stripe:"",size:"small",columns:t.orgColumns,data:t.orgData},on:{"on-select":t.selectOrgClick}})],1),t._v(" "),a("Modal",{attrs:{title:"职位选择","mask-closable":!1,transfer:!1},on:{"on-ok":t.confirmDepartment},model:{value:t.showDepartmentModal,callback:function(e){t.showDepartmentModal=e},expression:"showDepartmentModal"}},[a("Table",{attrs:{height:"400",stripe:"",size:"small",columns:t.departmentColumns,data:t.departmentData},on:{"on-select":t.selectDepartmentClick}})],1)],1)])},staticRenderFns:[]};var i=a("VU/8")(o,n,!1,function(t){a("FPDy")},"data-v-ab7e6468",null).exports,l={name:"WorkflowModal",props:{modalWorkflowStatus:Boolean,listId:String},data:function(){return{showWorkFlow:!1,relativeWorkFlowTotal:0,allWorkFlowTotal:0,allCurrentPage:1,relativeCurrentPage:1,pageSize:10,loading:!0,allWorkFlowColumns:[{type:"selection",width:60,align:"center"},{title:"名称",key:"processName"},{title:"编码",key:"processCode"},{title:"查看流程图",key:"action",align:"center",render:function(t,e){return t("Button",{props:{type:"default",size:"small"}},"查看")}}],relativeWorkFlowColumns:[{title:"名称",key:"processName"},{title:"编码",key:"processCode"},{title:"配置节点",key:"action",align:"center",render:function(t,e){return t("Button",{props:{type:"default",size:"small"}},"配置")}}],allWorkFlowData:[],relativeWorkFlowData:[]}},watch:{modalWorkflowStatus:function(t,e){this.showWorkFlow=t}},methods:{selectWorkFlow:function(){},getAllWorkflowData:function(){var t=this,e={page:this.allCurrentPage,limit:this.pageSize};this.loading=!0,Object(s.i)(e).then(function(e){t.allWorkFlowData=e.tableContent,t.allWorkFlowTotal=e.dataCount,t.loading=!1})},getRelativeWorkflowData:function(){var t=this,e={page:this.relativeCurrentPage,limit:this.pageSize,listId:this.listId};this.loading=!0,Object(s.p)(e).then(function(e){t.relativeWorkFlowData=e,t.relativeWorkFlowTotal=e.length,t.loading=!1})},onPageChange:function(t){var e=this;this.allCurrentPage=t;var a={page:this.allCurrentPage,limit:this.pageSize};this.loading=!0,Object(s.i)(a).then(function(t){e.allWorkFlowData=t.tableContent,e.allWorkFlowTotal=t.dataCount,e.loading=!1})},onRelativePageChange:function(){this.loading=!1},modalVisibleChange:function(t){t||this.$emit("emitWorkFlowModal",{modal:!1})},addWorkflow:function(t,e){var a=this;0===this.relativeWorkFlowData.length?this.relativeWorkFlowData.push(t):this.relativeWorkFlowData.forEach(function(e){t.id===e.id?a.$Message.warning("已有选择的工作流！"):a.relativeWorkFlowData.push(t)});var s={};this.relativeWorkFlowData=this.relativeWorkFlowData.reduce(function(t,e){return!s[e.id]&&(s[e.id]=t.push(e)),t},[])},deleteWorkflow:function(t,e){this.relativeWorkFlowData.splice(e,1)}},mounted:function(){this.getAllWorkflowData(),this.getRelativeWorkflowData()}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{attrs:{title:"工作流设置",width:"1010","mask-closable":!1},on:{"on-ok":t.selectWorkFlow,"on-visible-change":t.modalVisibleChange},model:{value:t.showWorkFlow,callback:function(e){t.showWorkFlow=e},expression:"showWorkFlow"}},[a("Row",{attrs:{gutter:8}},[a("Col",{attrs:{span:"12"}},[a("h4",{staticClass:"flow-title"},[t._v("所有工作流\n      "),a("Button",{staticClass:"create-button"},[t._v("创建工作流")])],1),t._v(" "),a("Table",{attrs:{loading:t.loading,stripe:"",height:"350",columns:t.allWorkFlowColumns,data:t.allWorkFlowData},on:{"on-row-dblclick":t.addWorkflow}}),t._v(" "),a("div",{staticClass:"workflow-page"},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:t.allWorkFlowTotal,current:t.allCurrentPage,"page-size":t.pageSize,size:"small","show-total":""},on:{"on-change":t.onPageChange}})],1)])],1),t._v(" "),a("Col",{attrs:{span:"12"}},[a("h4",{staticClass:"flow-title"},[t._v("已关联的工作流\n      "),a("Button",{staticClass:"create-button"},[t._v("创建工作流")])],1),t._v(" "),a("Table",{attrs:{loading:t.loading,stripe:"",height:"350",columns:t.relativeWorkFlowColumns,data:t.relativeWorkFlowData},on:{"on-row-dblclick":t.deleteWorkflow}}),t._v(" "),a("div",{staticClass:"workflow-page"},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:t.relativeWorkFlowTotal,current:t.relativeCurrentPage,"page-size":t.pageSize,size:"small","show-total":""},on:{"on-change":t.onRelativePageChange}})],1)])],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(l,r,!1,function(t){a("L3CM")},"data-v-5a307971",null).exports,p={name:"navModal",props:{modalNavStatus:Boolean},data:function(){return{showNav:!1,navData:[],selectedNode:{}}},watch:{modalNavStatus:function(t,e){this.showNav=t}},methods:{modalVisibleChange:function(t){t||this.$emit("emitNavModal",{modal:!1})},publishApp:function(){var t=this;this.selectedNode&&Object(s.q)(this.selectedNode).then(function(e){e.success&&(t.$Message.success(e.message),t.$emit("hasPublished","已发布"))})},getNodeSelectedData:function(t,e){if(t.target.style.backgroundColor)t.target.style.backgroundColor="#fff",t.target.style.padding="0px",t.target.style.color="#333";else{t.target.style.backgroundColor="rgba(242, 157, 30, 0.9)",t.target.style.padding="3px",t.target.style.color="#fff";var a={list:"nav",id:e.id,parentId:e.parentId,url:e.url,text:e.title,icon:e.icon};this.selectedNode=a}},getNavData:function(){var t=this;Object(s.o)({parentId:"root"}).then(function(e){console.log(e),e.forEach(function(e,a){1===e.leaf?t.navData.push({title:e.text,id:e.id,parentId:e.parentId,url:e.url,icon:e.icon,render:function(e,a){a.root,a.node;var s=a.data;return e("span",{style:{display:"inline-block",width:"100%"}},[e("span",[e("Icon",{props:{type:"ios-folder-outline"},style:{marginRight:"8px",color:"#FF8F59",fontSize:"1rem"}}),e("span",{style:{cursor:"pointer"},on:{click:function(e){t.getNodeSelectedData(e,s)}}},s.title)])])}}):t.navData.push({title:e.text,id:e.id,parentId:e.parentId,url:e.url,icon:e.icon,loading:!1,children:[],render:function(e,a){a.root,a.node;var s=a.data;return e("span",{style:{display:"inline-block",width:"100%"}},[e("span",[e("Icon",{props:{type:"folder"},style:{marginRight:"8px",color:"#39f",fontSize:"1.2rem"}}),e("span",{style:{cursor:"pointer"},on:{click:function(e){t.getNodeSelectedData(e,s)}}},s.title)])])}})})})},loadData:function(t,e){var a=this,o={parentId:t.id};Object(s.o)(o).then(function(t){var s=[];t.forEach(function(t){1===t.leaf?s.push({title:t.text,id:t.id,parentId:t.parentId,url:t.url,icon:t.icon,render:function(t,e){e.root,e.node;var s=e.data;return t("span",{style:{display:"inline-block",width:"100%"}},[t("span",[t("Icon",{props:{type:"ios-folder-outline"},style:{marginRight:"8px",color:"#FF8F59",fontSize:"1rem"}}),t("span",{style:{cursor:"pointer"},on:{click:function(t){a.getNodeSelectedData(t,s)}}},s.title)])])}}):s.push({title:t.text,id:t.id,parentId:t.parentId,url:t.url,icon:t.icon,loading:!1,children:[],render:function(t,e){e.root,e.node;var s=e.data;return t("span",{style:{display:"inline-block",width:"100%"}},[t("span",[t("Icon",{props:{type:"folder"},style:{marginRight:"8px",color:"#39f",fontSize:"1.2rem"}}),t("span",{style:{cursor:"pointer"},on:{click:function(t){a.getNodeSelectedData(t,s)}}},s.title)])])}})}),e(s)})}},mounted:function(){this.getNavData()}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{attrs:{title:"导航",width:"300","mask-closable":!1},on:{"on-ok":t.publishApp,"on-visible-change":t.modalVisibleChange},model:{value:t.showNav,callback:function(e){t.showNav=e},expression:"showNav"}},[a("Tree",{staticClass:"nav-tree",attrs:{data:t.navData,"load-data":t.loadData}})],1)},staticRenderFns:[]};var u={name:"appSetting",components:{PermissionModal:i,WorkflowModal:c,NavModal:a("VU/8")(p,d,!1,function(t){a("h0y6")},"data-v-676ff252",null).exports},props:["listId"],data:function(){return{showPermissionModal:!1,showWorkFlow:!1,showNav:!1}},methods:{emitPermissionModal:function(){this.showPermissionModal=!1},emitWorkFlowModal:function(){this.showWorkFlow=!1},emitNavModal:function(){this.showNav=!1},showNavModal:function(){this.showNav=!0},hasPublished:function(t){this.$emit("childHasPublished",t)},showPermissionApp:function(){this.showPermissionModal=!0},submitPermission:function(){},showWorkFlowModal:function(){this.showWorkFlow=!0},goForm:function(){window.open("/Form/index.html?viewDesign=true&list="+this.listId)}},mounted:function(){}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Row",[a("div",{staticClass:"app-card"},[a("Col",{attrs:{span:"6"}},[a("Row",{staticClass:"app-body-card"},[a("ul",[a("li",[a("b",[t._v("表单设置")])]),t._v(" "),a("li",[a("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),a("a",[t._v("部件内部数据源过滤")])]),t._v(" "),a("li",[a("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),a("a",[t._v("部件之间数据过滤")])]),t._v(" "),a("li",[a("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),a("a",[t._v("科目分录设置")])]),t._v(" "),a("li",[a("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),a("a",{on:{click:t.goForm}},[t._v("表单设置")])])])])],1),t._v(" "),a("Col",{attrs:{span:"6"}},[a("Row",{staticClass:"app-body-card"},[a("ul",[a("li",[a("b",[t._v("工作流设置")])]),t._v(" "),a("li",[a("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),a("a",[t._v("一般工作流图")])]),t._v(" "),a("li",[a("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),a("a",{on:{click:t.showWorkFlowModal}},[t._v("工作流设置")])])])])],1),t._v(" "),a("Col",{attrs:{span:"6"}},[a("Row",{staticClass:"app-body-card"},[a("p",{staticClass:"app-title",attrs:{slot:"title"},slot:"title"},[t._v("报表设置")]),t._v(" "),a("ul",[a("li",[a("b",[t._v("报表设置")])]),t._v(" "),a("li",[a("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),a("a",[t._v("对象查阅项")])]),t._v(" "),a("li",[a("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),a("a",[t._v("报表权限")])])])])],1),t._v(" "),a("Col",{attrs:{span:"6"}},[a("Row",{staticClass:"app-body-card"},[a("ul",[a("li",[a("b",[t._v("相关应用设置")])]),t._v(" "),a("li",[a("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),a("a",[t._v("应用信息设置")])]),t._v(" "),a("li",[a("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),a("a",{on:{click:t.showPermissionApp}},[t._v("权限设置")])]),t._v(" "),a("li",[a("b",{staticClass:"app-setting-dot"},[t._v("●")]),t._v(" "),a("a",{on:{click:t.showNavModal}},[t._v("导航")])])])])],1)],1)]),t._v(" "),a("nav-modal",{attrs:{modalNavStatus:t.showNav},on:{emitNavModal:t.emitNavModal,hasPublished:t.hasPublished}}),t._v(" "),a("workflow-modal",{attrs:{modalWorkflowStatus:t.showWorkFlow,listId:t.listId},on:{emitWorkFlowModal:t.emitWorkFlowModal}}),t._v(" "),a("permission-modal",{attrs:{modalPermissionStatus:t.showPermissionModal,appListId:t.listId},on:{emitPermissionModal:t.emitPermissionModal}})],1)},staticRenderFns:[]};var m=a("VU/8")(u,h,!1,function(t){a("Wai/")},"data-v-530d8e02",null).exports,v={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"app-card"},[e("h2",{staticClass:"app-name"},[this._v("\n    应用视图\n  ")]),this._v(" "),e("a",{attrs:{slot:"extra",href:"#"},slot:"extra"}),this._v(" "),e("Table",{attrs:{columns:this.columns,data:this.tableData}})],1)},staticRenderFns:[]};var f=a("VU/8")({name:"appView",components:{},data:function(){return{columns:[{title:"视图名称",key:"name",render:function(t,e){return t("a",{},e.row.name)}},{title:"创建时间",key:"createTime"},{title:"创建者",key:"creator"},{title:"默认视图",key:"defaultView",width:100,align:"center",render:function(t,e){return t("Radio",{props:{value:!0}})}},{title:"操作",key:"action",width:150,align:"center",render:function(t,e){return t("Button",{props:{type:"error",size:"small"}},"删除")}}],tableData:[{name:"收款明细",createTime:"2018-6-21",creator:"maliya"},{name:"收款主表",createTime:"2018-6-21",creator:"maliya"}]}},methods:{},mounted:function(){}},v,!1,function(t){a("8vpb")},"data-v-91a62b3c",null).exports,w={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("Row",[e("div",{staticClass:"app-card"},[e("h2",{staticClass:"app-name"},[this._v("\n        应用科目\n      ")]),this._v(" "),e("Table",{attrs:{columns:this.columns,data:this.tableData}})],1)])],1)},staticRenderFns:[]};var _=a("VU/8")({name:"appSubject",components:{},data:function(){return{columns:[{title:"名称",key:"name"},{title:"分类",key:"type"},{title:"启用",key:"defaultView",width:150,align:"center",render:function(t,e){return t("Checkbox",{props:{value:!0}})}}],tableData:[{name:"存货",type:"计划类"},{name:"费用",type:"会计类"}]}},methods:{},mounted:function(){}},w,!1,function(t){a("HDB/")},"data-v-45b31d7d",null).exports,g={name:"appPermission",components:{},props:{listId:String},data:function(){var t=this;return{isUserEdit:!1,isOrgEdit:!1,isDepEdit:!1,userColumns:[{title:"姓名",key:"objName",width:100,hidden:!0},{title:"资源",key:"resource",align:"center",render:function(e,a){var s=[],o=JSON.parse(a.row.resource);if(o.length>0)return o.forEach(function(o,n){var i=void 0,l=function(s){i=e("Tag",{props:{type:"border",closable:!0,color:"yellow"},on:{"on-close":function(e){t.deleteOnlyPermission(e,a,s,a.row.list)}}},o[s])};for(var r in o)l(r);s.push(i)}),e("div",s)}},{title:"查看范围",key:"scope",render:function(e,a){var s=[],o=JSON.parse(a.row.scope);if(o.length>0)return o.forEach(function(o,n){var i=void 0,l=function(s){i=e("Tag",{props:{closable:!0,color:"green"},on:{"on-close":function(e){t.deleteOnlyPermission(e,a,s,a.row.list)}}},o[s])};for(var r in o)l(r);s.push(i)}),e("div",s)}},{title:"动作",key:"action",render:function(e,a){var s=[],o=JSON.parse(a.row.action);if(o.length>0)return o.forEach(function(o,n){var i=void 0,l=function(s){i=e("Tag",{props:{type:"border",closable:!0,color:"blue"},on:{"on-close":function(e){t.deleteOnlyPermission(e,a,s,a.row.list)}}},o[s])};for(var r in o)l(r);s.push(i)}),e("div",s)}},{title:"操作",key:"delete",render:function(e,a){return e("a",{on:{click:function(e){t.deleteAllPermission(e,a,a.row.list)}}},"删除")}}],userData:[],authorityList:{},appItem:[{title:"用户",type:"sys_user_permission"},{title:"组织",type:"sys_group_permission"},{title:"职位",type:"sys_role_permission"}]}},methods:{deleteAllPermission:function(t,e,a){var o=this;o.$Modal.confirm({title:"确认",content:"确认删除此用户权限？",onOk:function(){var n,i=[];JSON.parse(e.row.action).forEach(function(t){for(var e in t)i.push(e)}),JSON.parse(e.row.resource).forEach(function(t){for(var e in t)i.push(e)}),JSON.parse(e.row.scope).forEach(function(t){for(var e in t)i.push(e)}),n={list:a,single:e.row.objId,multi:i.join(",")},Object(s.d)(n).then(function(e){e.success&&(o.$Message.success(e.message),t.target.parentElement.parentElement.parentElement.style.display="none")})}})},deleteOnlyPermission:function(t,e,a,o){var n=this,i=e.row.leaf?"确认删除此权限？":'<b style="color:red;">注意</b>：这个操作会将<b>'+e.row.objName+"</b>从该列表中移除(如果<b>"+e.row.objName+"</b>没有其他权限的话)";n.$Modal.confirm({title:"确认",content:i,onOk:function(){var i={list:o,single:e.row.objId,multi:a};i&&Object(s.d)(i).then(function(e){e.success&&(n.$Message.success(e.message),t.target.parentElement.style.display="none")})}})}},created:function(){var t=this;Object(s.l)(this.listId).then(function(e){e.tableContent[0]&&(t.authorityList=e.tableContent.reduce(function(t,e,a){return t[e.list]=t[e.list]||[],t[e.list].push(e),t},{}))})}},b={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-card"},[a("h2",{staticClass:"app-name"},[t._v("\n    应用权限\n  ")]),t._v(" "),t._l(t.appItem,function(e){return a("Row",{key:e.type},[a("Row",{staticStyle:{margin:"10px 15px"}},[a("span",{staticClass:"app-card-item-title"},[t._v(t._s(e.title))]),t._v(" "),a("span",{staticClass:"user-permission-desc",domProps:{innerHTML:t._s("设置"+e.title+"相对于当前应用的权限")}})]),t._v(" "),a("Row",[a("Col",{attrs:{span:"24"}},[a("Table",{staticClass:"user-table",attrs:{stripe:"",height:"200",columns:t.userColumns,data:t.authorityList[e.type]}})],1)],1)],1)})],2)},staticRenderFns:[]};var C={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"timeline-box",attrs:{fix:""}},[a("h2",[t._v("变更日志")]),t._v(" "),a("Timeline",{staticClass:"timeline-list",attrs:{pending:""}},t._l(t.data,function(e){return a("TimelineItem",{key:e.transCode},[a("p",{staticClass:"time"},[t._v(t._s(e.transCode))]),t._v(" "),a("ul",{staticClass:"timeline-item-content-ul"},[a("li",[a("span",[t._v(t._s(e.updateUser))]),t._v(" "),a("span",[t._v(t._s(e.updateTime))]),t._v(" "),a("span",[t._v("耗用时间:"+t._s(e.hour))])]),t._v(" "),a("li",[a("span",[t._v("更新范围:")]),t._v(" "),t._l(e.undateScope,function(e,s){return a("span",{key:s,staticClass:"customs-tag"},[t._v(t._s(e))])})],2),t._v(" "),a("li",[a("span",[t._v("备注:"+t._s(e.content))])])])])}))],1)},staticRenderFns:[]};var k={name:"detail",components:{AppSetting:m,AppView:f,AppSubject:_,AppPermission:a("VU/8")(g,b,!1,function(t){a("chxK")},"data-v-72bcfc04",null).exports,TimeLine:a("VU/8")({name:"TimeLine",data:function(){return{data:[{transCode:"0001",objName:"采购入库",appType:"YW1",undateScope:["表单","科目关系","报表","工作流","权限"],updateUser:"管理员",updateTime:"2018-07-10",hour:"1:30",content:"测试"},{transCode:"0002",objName:"采购入库",appType:"YW1",undateScope:["表单","科目关系","报表","工作流","权限"],appBigType:"YW2",updateUser:"管理员",updateTime:"2018-07-10",hour:"1:30",content:"测试"},{transCode:"0003",objName:"采购入库",appType:"YW1",undateScope:["表单","科目关系","报表","工作流","权限"],appBigType:"YW2",updateUser:"管理员",updateTime:"2018-07-10",hour:"1:30",content:"测试"},{transCode:"0004",objName:"采购入库",appType:"YW1",appBigType:"YW2",undateScope:["表单","科目关系","报表","工作流","权限"],updateUser:"管理员",updateTime:"2018-07-10",hour:"1:30",content:"测试"},{transCode:"0005",objName:"采购入库",undateScope:["表单","科目关系","报表","工作流","权限"],appType:"YW1",appBigType:"YW2",updateUser:"管理员",updateTime:"2018-07-10",hour:"1:30",content:"测试"}]}}},C,!1,function(t){a("Y1OT")},null,null).exports},data:function(){return{appData:{},showEditAppInfo:!0,showPermission:!1,showEditClick:!0,selectModel:"",showAdminModal:!1,selector:"",searchValue:"",publishStatus:"未发布",appStatusColor:"blue",adminColumns:[{type:"selection",width:60,align:"center"},{title:"工号",key:"userCode"},{title:"姓名",key:"nickname"}],adminData:[],sameAdminData:[],selectAdminData:[]}},watch:{searchValue:function(t){var e=[];t?(this.sameAdminData.forEach(function(a,s){(a.nickname.indexOf(t)>-1||a.userCode.indexOf(t)>-1)&&e.push(a)}),this.adminData=e):this.adminData=this.sameAdminData}},methods:{childHasPublished:function(t){this.publishStatus=t,this.appStatusColor="success"},editAppinfo:function(){this.showEditAppInfo=!this.showEditAppInfo},saveAppinfo:function(){},showPermissionApp:function(){this.showPermission=!0},selectAdminModal:function(){this.showAdminModal=!0},confirmModal:function(){this.appData.modifer=this.selectAdminData[0].nickname},selectAdmin:function(t,e){this.selectAdminData=t}},mounted:function(){var t=this,e={uniqueId:this.$route.params.listId};Object(s.e)({groupId:347}).then(function(e){t.adminData=e.tableContent,t.sameAdminData=e.tableContent}),Object(s.n)(e).then(function(e){t.appData=e[0]})}},y={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-details"},[a("div",{staticClass:"shadow"},[a("div",{staticStyle:{width:"100%","background-color":"#fff"}},[a("header",{staticClass:"app-header"},[a("Breadcrumb",[a("BreadcrumbItem",{attrs:{to:"/"}},[t._v("首页")]),t._v(" "),a("BreadcrumbItem",{attrs:{to:"/app/list"}},[t._v("应用列表")]),t._v(" "),a("BreadcrumbItem",[t._v(t._s(t.appData.title))])],1)],1),t._v(" "),a("div",{staticClass:"app-main"},[a("img",{attrs:{src:t.appData.icon}}),t._v(" "),a("div",{staticClass:"app-main-content"},[t.showEditAppInfo?a("h3",[t._v(t._s(t.appData.title))]):a("Input",{staticStyle:{width:"200px"},model:{value:t.appData.title,callback:function(e){t.$set(t.appData,"title",e)},expression:"appData.title"}}),t._v(" "),t.showEditClick?a("b",{on:{click:t.editAppinfo}},[a("Tooltip",{attrs:{content:"编辑",placement:"top"}},[a("Icon",{staticClass:"app-edit-icon",attrs:{type:"compose"}})],1)],1):a("b",{on:{click:t.saveAppinfo}},[a("Tooltip",{attrs:{content:"退出编辑并保存",placement:"top"}},[a("Icon",{staticClass:"app-edit-icon",attrs:{type:"edit"}})],1)],1),t._v(" "),a("section",{staticClass:"app-section"},[a("div",{staticClass:"app-content-section"},[a("label",[t._v("管理员：")]),t._v(" "),t.showEditAppInfo?a("span",[t._v(t._s(t.appData.modifer))]):a("Input",{staticStyle:{width:"100px"},attrs:{icon:"arrow-down-b"},on:{"on-click":t.selectAdminModal},model:{value:t.appData.modifer,callback:function(e){t.$set(t.appData,"modifer",e)},expression:"appData.modifer"}})],1),t._v(" "),a("div",{staticClass:"app-content-section"},[a("label",[t._v("状态：")]),t._v(" "),a("Tag",{attrs:{color:t.appStatusColor}},[t._v(t._s(t.publishStatus))])],1),t._v(" "),a("div",{staticClass:"app-content-section"},[a("label",[t._v("创建时间：")]),t._v(" "),a("span",[t._v(t._s(t.appData.modTime))])])]),t._v(" "),a("section",{staticClass:"app-section"},[t._m(0),t._v(" "),a("div",{staticClass:"app-content-section"},[a("label",[t._v("类型：")]),t._v(" "),a("span",[t._v(t._s(t.appData.transType))])]),t._v(" "),a("div",{staticClass:"app-content-section"},[a("label",[t._v("创建者：")]),t._v(" "),a("span",[t._v(t._s(t.appData.modifer))])])]),t._v(" "),a("section",{staticClass:"app-section"},[a("div",{staticClass:"app-content-comment"},[a("label",[t._v("说明：")]),t._v(" "),t.showEditAppInfo?a("span",[t._v(t._s(t.appData.comment))]):a("Input",{staticStyle:{width:"350px"},model:{value:t.appData.comment,callback:function(e){t.$set(t.appData,"comment",e)},expression:"appData.comment"}})],1)])],1)])]),t._v(" "),a("app-setting",{attrs:{listId:this.$route.params.listId},on:{showPermissionApp:t.showPermissionApp,childHasPublished:t.childHasPublished}}),t._v(" "),a("app-permission",{attrs:{listId:this.$route.params.listId}}),t._v(" "),a("app-view"),t._v(" "),a("app-subject"),t._v(" "),a("time-line"),t._v(" "),a("Modal",{attrs:{title:"请选择"},on:{"on-ok":t.confirmModal},model:{value:t.showAdminModal,callback:function(e){t.showAdminModal=e},expression:"showAdminModal"}},[a("div",{staticClass:"app-search"},[a("Icon",{staticClass:"app-search-icon",attrs:{type:"search"}}),t._v(" "),a("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"搜索"},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}})],1),t._v(" "),a("Table",{attrs:{height:"400",stripe:"",columns:t.adminColumns,size:"small",data:t.adminData},on:{"on-select":t.selectAdmin}})],1)],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"app-content-section"},[e("label",[this._v("实例数：")]),this._v(" "),e("span",[this._v("2000")])])}]};var D=a("VU/8")(k,y,!1,function(t){a("XXJ2")},"data-v-04dc6fbe",null);e.default=D.exports},"8vpb":function(t,e){},FPDy:function(t,e){},"HDB/":function(t,e){},L3CM:function(t,e){},"Wai/":function(t,e){},XXJ2:function(t,e){},Y1OT:function(t,e){},chxK:function(t,e){},h0y6:function(t,e){}});
//# sourceMappingURL=3.f515adf7278182556b38.js.map
webpackJsonp([18],{GNus:function(t,i){},ru4w:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e("a8xa"),n={name:"Navigation",data:function(){return{params:{page:1,limit:1e3,filter:""},navs:[]}},methods:{refreshNavListByMessage:function(t){var i=this;Object(s.d)(this.params).then(function(t){i.navs=t.tableContent})},subscribeMessage:function(){var t=this,i=this.$deepstream,e=this.$currentUser.userId;console.log("订阅"),i.event.subscribe("commentMessage/"+e,function(i){t.refreshNavListByMessage(),i.dataCount>0&&t.hanleWindowNotification("您有"+i.dataCount+"未读消息")})},hanleWindowNotification:function(t){var i=function(){var i=new Notification("Roletask【路塔】",{body:t,icon:"static/favicon.ico"});i.onclick=function(){console.log("点击"),window.self.focus(),i.close()}};if(window.Notification){var e=navigator.userAgent.toLowerCase();-1!=e.indexOf("safari")&&(e.indexOf("chrome")>-1?Notification.requestPermission().then(function(t){"granted"==t?i():(Notification.requestPermission(),console.log("没有权限,用户拒绝:Notification"))}):Notification.requestPermission(function(t){"granted"==t||(Notification.requestPermission(),console.log("没有权限,用户拒绝:Notification"))}))}else console.log("不支持Notification")},handleActiveNavigation:function(t){Object(s.e)(t.listId).then(function(i){t.unreadNum=0})}},mounted:function(){this.refreshNavListByMessage(),this.subscribeMessage()}},a={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("ul",{staticClass:"navigation-list messagescrollbar"},t._l(t.navs,function(i,s){return e("router-link",{key:s,attrs:{to:"/social/message/list/"+i.listId}},[e("li",{staticClass:"navigation-list-item",class:{active:t.$route.params.listId==i.listId},on:{click:function(e){t.handleActiveNavigation(i)}}},[e("img",{attrs:{width:"40",src:i.icon}}),t._v(" "),e("div",{staticClass:"navigation-list-item-appinfo"},[e("div",{staticClass:"font14"},[t._v(" "+t._s(i.listName))]),t._v(" "),e("div",{staticStyle:{color:"#5c7893"}},[e("p",{domProps:{innerHTML:t._s(i.comment)}})])]),t._v(" "),i.unreadNum>0?e("div",{staticClass:"navigation-list-item-msgcount"},[t._v(t._s(i.unreadNum))]):t._e()])])}))},staticRenderFns:[]};var o={name:"MessageLayout",components:{Navigation:e("D8HT")(n,a,!1,function(t){e("GNus")},"data-v-9e060680",null).exports},data:function(){return{}},watch:{},mounted:function(){var t=localStorage.getItem("activeNavigatioIdOfNotice");t&&this.$router.push("/social/message/list/"+t)}},c={render:function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"message"},[i("div",{staticClass:"message-sider"},[i("div",{staticClass:"message-sider-header"},[this._v("消息通知")]),this._v(" "),i("div",{staticClass:"message-sider-list "},[i("navigation")],1)]),this._v(" "),i("div",{staticClass:"message-content"},[i("router-view")],1)])},staticRenderFns:[]};var r=e("D8HT")(o,c,!1,function(t){e("xo6Q")},"data-v-039f49e4",null);i.default=r.exports},xo6Q:function(t,i){}});